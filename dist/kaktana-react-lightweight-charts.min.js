module.exports=function(t){var i={};function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var r in t)e.d(n,r,function(i){return t[i]}.bind(null,r));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=2)}([function(t,i){t.exports=require("react")},function(t,i,e){"use strict";t.exports=function t(i,e){if(i===e)return!0;if(i&&e&&"object"==typeof i&&"object"==typeof e){if(i.constructor!==e.constructor)return!1;var n,r,s;if(Array.isArray(i)){if((n=i.length)!=e.length)return!1;for(r=n;0!=r--;)if(!t(i[r],e[r]))return!1;return!0}if(i.constructor===RegExp)return i.source===e.source&&i.flags===e.flags;if(i.valueOf!==Object.prototype.valueOf)return i.valueOf()===e.valueOf();if(i.toString!==Object.prototype.toString)return i.toString()===e.toString();if((n=(s=Object.keys(i)).length)!==Object.keys(e).length)return!1;for(r=n;0!=r--;)if(!Object.prototype.hasOwnProperty.call(e,s[r]))return!1;for(r=n;0!=r--;){var o=s[r];if(!t(i[o],e[o]))return!1}return!0}return i!=i&&e!=e}},function(t,i,e){"use strict";e.r(i),e.d(i,"CrosshairMode",(function(){return K})),e.d(i,"LineStyle",(function(){return o})),e.d(i,"LineType",(function(){return s})),e.d(i,"PriceLineSource",(function(){return Ri})),e.d(i,"PriceScaleMode",(function(){return ki})),e.d(i,"createChart",(function(){return _n})),e.d(i,"isBusinessDay",(function(){return Oi})),e.d(i,"isUTCTimestamp",(function(){return Bi})),e.d(i,"version",(function(){return En}));var n=e(0),r=e.n(n);var s,o,h,a=function(){function t(t){var i=this;this._resolutionMediaQueryList=null,this._resolutionListener=function(t){return i._onResolutionChanged()},this._canvasConfiguredListeners=[],this.canvas=t,this._canvasSize={width:this.canvas.clientWidth,height:this.canvas.clientHeight},this._configureCanvas(),this._installResolutionListener()}return t.prototype.destroy=function(){this._canvasConfiguredListeners.length=0,this._uninstallResolutionListener(),this.canvas=null},Object.defineProperty(t.prototype,"canvasSize",{get:function(){return{width:this._canvasSize.width,height:this._canvasSize.height}},enumerable:!0,configurable:!0}),t.prototype.resizeCanvas=function(t){this._canvasSize={width:t.width,height:t.height},this._configureCanvas()},Object.defineProperty(t.prototype,"pixelRatio",{get:function(){var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");return t.devicePixelRatio},enumerable:!0,configurable:!0}),t.prototype.subscribeCanvasConfigured=function(t){this._canvasConfiguredListeners.push(t)},t.prototype.unsubscribeCanvasConfigured=function(t){this._canvasConfiguredListeners=this._canvasConfiguredListeners.filter((function(i){return i!=t}))},t.prototype._configureCanvas=function(){var t=this.pixelRatio;this.canvas.style.width=this._canvasSize.width+"px",this.canvas.style.height=this._canvasSize.height+"px",this.canvas.width=this._canvasSize.width*t,this.canvas.height=this._canvasSize.height*t,this._emitCanvasConfigured()},t.prototype._emitCanvasConfigured=function(){var t=this;this._canvasConfiguredListeners.forEach((function(i){return i.call(t)}))},t.prototype._installResolutionListener=function(){if(null!==this._resolutionMediaQueryList)throw new Error("Resolution listener is already installed");var t=this.canvas.ownerDocument.defaultView;if(null==t)throw new Error("No window is associated with the canvas");var i=t.devicePixelRatio;this._resolutionMediaQueryList=t.matchMedia("all and (resolution: "+i+"dppx)"),this._resolutionMediaQueryList.addListener(this._resolutionListener)},t.prototype._uninstallResolutionListener=function(){null!==this._resolutionMediaQueryList&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},t.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},t.prototype._onResolutionChanged=function(){this._configureCanvas(),this._reinstallResolutionListener()},t}();
/*!
 * @license
 * TradingView Lightweight Charts v2.0.0
 * Copyright (c) 2019 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */function u(t,i){var e,n=((e={})[0]=[],e[1]=[t.lineWidth,t.lineWidth],e[2]=[2*t.lineWidth,2*t.lineWidth],e[3]=[6*t.lineWidth,6*t.lineWidth],e[4]=[t.lineWidth,4*t.lineWidth],e)[i];t.setLineDash(n)}function l(t,i,e,n){t.beginPath();var r=t.lineWidth%2?.5:0;t.moveTo(e,i+r),t.lineTo(n,i+r),t.stroke()}(h=s||(s={}))[h.Simple=0]="Simple",h[h.WithSteps=1]="WithSteps",function(t){t[t.Solid=0]="Solid",t[t.Dotted=1]="Dotted",t[t.Dashed=2]="Dashed",t[t.LargeDashed=3]="LargeDashed",t[t.SparseDotted=4]="SparseDotted"}(o||(o={}));var c=function(t,i){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};function p(t,i){function e(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}var f=function(){return(f=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++)for(var r in i=arguments[e])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)};function d(){for(var t=0,i=0,e=arguments.length;i<e;i++)t+=arguments[i].length;var n=Array(t),r=0;for(i=0;i<e;i++)for(var s=arguments[i],o=0,h=s.length;o<h;o++,r++)n[r]=s[o];return n}function v(t,i){if(!t)throw new Error("Assertion failed"+(i?": "+i:""))}function m(t){if(void 0===t)throw new Error("Value is undefined");return t}function y(t){if(null===t)throw new Error("Value is null");return t}function g(t){return y(m(t))}function b(t){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];for(var n=0,r=i;n<r.length;n++){var s=r[n];for(var o in s)void 0!==s[o]&&("object"!=typeof s[o]||void 0===t[o]?t[o]=s[o]:b(t[o],s[o]))}return t}function S(t){return"number"==typeof t&&isFinite(t)}function w(t){return"number"==typeof t&&t%1==0}function M(t){return"string"==typeof t}function x(t){return!(t<=0||t>0)}function C(t){return"boolean"==typeof t}function T(t){var i,e,n,r=t;if(!r||"object"!=typeof r)return r;for(e in i=Array.isArray(r)?[]:{},r)r.hasOwnProperty(e)&&(n=r[e],i[e]=n&&"object"==typeof n?T(n):n);return i}function k(t){return null!==t}function P(t){return null===t?void 0:t}var _,E,L,R,V=function(){function t(){this.t=[]}return t.prototype.setRenderers=function(t){this.t=t},t.prototype.draw=function(t,i,e,n){this.t.forEach((function(r){t.save(),r.draw(t,i,e,n),t.restore()}))},t}(),F=function(){function t(){}return t.prototype.draw=function(t,i,e,n){t.save(),t.scale(i,i),this._drawImpl(t,e,n),t.restore()},t.prototype.drawBackground=function(t,i,e,n){t.save(),t.scale(i,i),this._drawBackgroundImpl(t,e,n),t.restore()},t.prototype._drawBackgroundImpl=function(t,i,e){},t}(),D=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i._data=null,i}return p(i,t),i.prototype.setData=function(t){this._data=t},i.prototype._drawImpl=function(t){if(null!==this._data&&null!==this._data.visibleRange){var i=this._data.visibleRange,e=this._data,n=function(n){t.beginPath();for(var r=i.to-1;r>=i.from;--r){var s=e.items[r];t.moveTo(s.x,s.y),t.arc(s.x,s.y,n,0,2*Math.PI)}t.fill()};t.fillStyle=e.backColor,n(e.radius+2),t.fillStyle=e.lineColor,n(e.radius)}},i}(F),z={from:0,to:1},A=function(){function t(t,i){this.i=new V,this.s=[],this.u=[],this.o=!0,this.l=t,this.v=i,this.i.setRenderers(this.s)}return t.prototype.update=function(t){var i=this,e=this.l.serieses();e.length!==this.s.length&&(this.u=e.map((function(){return{items:[{x:0,y:0,time:0,price:0}],lineColor:"",backColor:i.l.options().layout.backgroundColor,radius:0,visibleRange:null}})),this.s=this.u.map((function(t){var i=new D;return i.setData(t),i})),this.i.setRenderers(this.s)),this.o=!0},t.prototype.renderer=function(t,i,e){return this.o&&(this.M(),this.o=!1),this.i},t.prototype.M=function(){var t=this,i=this.l.serieses(),e=this.v.appliedIndex(),n=this.l.timeScale();i.forEach((function(i,r){var s=t.u[r],o=i.markerDataAtIndex(e);if(null!==o){var h=y(i.firstValue());s.lineColor=i.barColorer().barStyle(e).barColor,s.backColor=t.l.options().layout.backgroundColor,s.radius=o.radius,s.items[0].price=o.price,s.items[0].y=i.priceScale().priceToCoordinate(o.price,h.value),s.items[0].time=e,s.items[0].x=n.indexToCoordinate(e),s.visibleRange=z}else s.visibleRange=null}))},t}(),O=function(){function t(t){this.m=t}return t.prototype.draw=function(t,i,e,n){if(null!==this.m){var r=this.m.vertLine.visible,s=this.m.horzLine.visible;if(r||s){t.save();var o=Math.round(this.m.x*i),h=Math.round(this.m.y*i),a=Math.ceil(this.m.w*i),c=Math.ceil(this.m.h*i);t.lineCap="butt",r&&o>=0&&(t.lineWidth=Math.floor(this.m.vertLine.lineWidth*i),t.strokeStyle=this.m.vertLine.color,t.fillStyle=this.m.vertLine.color,u(t,this.m.vertLine.lineStyle),function(t,i,e,n){t.beginPath();var r=t.lineWidth%2?.5:0;t.moveTo(i+r,0),t.lineTo(i+r,n),t.stroke()}(t,o,0,c)),s&&h>=0&&(t.lineWidth=Math.floor(this.m.horzLine.lineWidth*i),t.strokeStyle=this.m.horzLine.color,t.fillStyle=this.m.horzLine.color,u(t,this.m.horzLine.lineStyle),l(t,h,0,a)),t.restore()}}},t}(),B=function(){function t(t){this.o=!0,this.p={vertLine:{lineWidth:1,lineStyle:0,color:"",visible:!1},horzLine:{lineWidth:1,lineStyle:0,color:"",visible:!1},w:0,h:0,x:0,y:0},this.g=new O(this.p),this.k=t}return t.prototype.update=function(){this.o=!0},t.prototype.renderer=function(t,i){return this.o&&this.M(),this.g},t.prototype.M=function(){var t=this.k.visible(),i=y(this.k.pane()),e=i.model().options().crosshair,n=this.p;n.horzLine.visible=t&&this.k.horzLineVisible(i),n.vertLine.visible=t&&this.k.vertLineVisible(),n.horzLine.lineWidth=e.horzLine.width,n.horzLine.lineStyle=e.horzLine.style,n.horzLine.color=e.horzLine.color,n.vertLine.lineWidth=e.vertLine.width,n.vertLine.lineStyle=e.vertLine.style,n.vertLine.color=e.vertLine.color,n.w=i.width(),n.h=i.height(),n.x=this.k.appliedX(),n.y=this.k.appliedY()},t}(),I={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function N(t){return x(i=t)||i<0?0:i>255?255:Math.round(i);var i}function $(t){return x(i=t)||i<0?0:i>1?1:Math.round(1e4*i)/1e4;var i}function W(t){var i=function(t){(t=t.toLowerCase())in I&&(t=I[t]);var i,e,n=(i=t,null!==(e=L.re.exec(i))?L.parse(e):null);if(null!==n)return n;var r=function(t){var i=E.re.exec(t);return null!==i?E.parse(i):null}(t);if(null!==r)return r;var s=function(t){var i=_.re.exec(t);return null!==i?_.parse(i):null}(t);if(null!==s)return s;var o=function(t){var i=R.re.exec(t);return null!==i?R.parse(i):null}(t);return null!==o?[o[0],o[1],o[2]]:null}(t);if(null!==i)return i;throw new Error("Passed color string "+t+" does not match any of the known color representations")}function U(t,i){if(i<0||i>255)throw new Error("invalid threshold value, valid values are [0, 255]");return function(t){return.199*t[0]+.687*t[1]+.114*t[2]}(t)>=i?"white":"black"}function Y(t){return"black"===U(W(t),160)?"white":"black"}function j(t,i,e,n,r,s){t.fillRect(i,e,s,r),t.fillRect(i+s,e,n-2*s,s),t.fillRect(i+s,e+r-s,n-2*s,s),t.fillRect(i+n-s,e,s,r)}function H(t,i,e){t.save(),t.scale(i,i),e(),t.restore()}function q(t,i,e,n,r,s){t.save(),t.globalCompositeOperation="copy",t.fillStyle=s,t.fillRect(i,e,n,r),t.restore()}!function(t){t.re=/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/,t.parse=function(t){return[N(parseInt(t[1]+t[1],16)),N(parseInt(t[2]+t[2],16)),N(parseInt(t[3]+t[3],16))]}}(_||(_={})),function(t){t.re=/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,t.parse=function(t){return[N(parseInt(t[1],16)),N(parseInt(t[2],16)),N(parseInt(t[3],16))]}}(E||(E={})),function(t){t.re=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,t.parse=function(t){return[N(parseInt(t[1],10)),N(parseInt(t[2],10)),N(parseInt(t[3],10))]}}(L||(L={})),function(t){t.re=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/,t.parse=function(t){return[N(parseInt(t[1],10)),N(parseInt(t[2],10)),N(parseInt(t[3],10)),$(parseFloat(t[4]))]}}(R||(R={}));var K,X=function(){function t(t,i){this.setData(t,i)}return t.prototype.setData=function(t,i){this.m=t,this.N=i},t.prototype.draw=function(t,i,e,n,r,s){if(this.m.visible){t.font=i.font;var o=this.m.tickVisible?i.tickLength:0,h=i.borderSize,a=i.paddingTop,u=i.paddingBottom,l=i.paddingInner,c=i.paddingOuter,p=this.m.text,f=Math.ceil(e.measureText(t,p)),d=i.baselineOffset,v=i.fontSize+a+u,m=Math.ceil(.5*v),y=h+f+l+c+o,g=this.N.coordinate;this.N.fixedCoordinate&&(g=this.N.fixedCoordinate);var b,S,w=(g=Math.round(g))-m,M=w+v,x="right"===r,C=x?n:0,T=Math.ceil(n*s),k=C;if(t.fillStyle=function(t){return function(t){return 0===t.indexOf("#")}(t)?t:(1,"rgba("+(i=[(e=W(t))[0],e[1],e[2],$(1)])[0]+", "+i[1]+", "+i[2]+", "+i[3]+")");var i,e}(this.N.background),t.lineWidth=1,t.lineCap="butt",p){x?(b=C-o,S=(k=C-y)+c):(k=C+y,b=C+o,S=C+h+o+l);var P=Math.max(1,Math.floor(s)),_=Math.max(1,Math.floor(h*s)),E=x?T:0,L=Math.round(w*s),R=Math.round(k*s),V=Math.round(g*s)-Math.floor(.5*s),F=V+P+(V-L),D=Math.round(b*s);t.save(),t.beginPath(),t.moveTo(E,L),t.lineTo(R,L),t.lineTo(R,F),t.lineTo(E,F),t.fill(),t.fillStyle=this.m.borderColor,t.fillRect(x?T-_:0,L,_,F-L),this.m.tickVisible&&(t.fillStyle=this.N.color,t.fillRect(E,V,D-E,P)),t.textAlign="left",t.fillStyle=this.N.color,H(t,s,(function(){t.fillText(p,S,M-u-d)})),t.restore()}}},t.prototype.height=function(t,i){return this.m.visible?t.fontSize+t.paddingTop+t.paddingBottom:0},t}(),J=function(){function t(t){this.S={coordinate:0,color:"#FFF",background:"#000"},this.D={text:"",visible:!1,tickVisible:!0,borderColor:""},this.C={text:"",visible:!1,tickVisible:!1,borderColor:""},this.o=!0,this.T=new(t||X)(this.D,this.S),this.L=new(t||X)(this.C,this.S)}return t.prototype.text=function(){return this.D.text},t.prototype.background=function(){return this.S.background},t.prototype.color=function(){return Y(this.background())},t.prototype.coordinate=function(){return this.A(),this.S.coordinate},t.prototype.update=function(){this.o=!0},t.prototype.height=function(t,i){return void 0===i&&(i=!1),Math.max(this.T.height(t,i),this.L.height(t,i))},t.prototype.getFixedCoordinate=function(){return this.S.fixedCoordinate||0},t.prototype.setFixedCoordinate=function(t){this.S.fixedCoordinate=t},t.prototype.isVisible=function(){return this.A(),this.D.visible||this.C.visible},t.prototype.isAxisLabelVisible=function(){return this.A(),this.D.visible},t.prototype.isPaneLabelVisible=function(){return this.A(),this.C.visible},t.prototype.renderer=function(){return this.A(),this.T.setData(this.D,this.S),this.L.setData(this.C,this.S),this.T},t.prototype.paneRenderer=function(){return this.A(),this.T.setData(this.D,this.S),this.L.setData(this.C,this.S),this.L},t.prototype.A=function(){this.o&&(this._updateRendererData(this.D,this.C,this.S),this.o=!1)},t}(),Z=function(t){function i(i,e,n){var r=t.call(this)||this;return r.k=i,r.B=e,r.V=n,r}return p(i,t),i.prototype._updateRendererData=function(t,i,e){t.visible=!1;var n=this.k.options().horzLine;if(n.labelVisible){var r=this.B.firstValue();if(this.k.visible()&&!this.B.isEmpty()&&null!==r){e.background=n.labelBackgroundColor,e.color=Y(n.labelBackgroundColor);var s=this.V(this.B);e.coordinate=s.coordinate,t.text=this.B.formatPrice(s.price,r),t.visible=!0}}},i}(J),Q=/[1-9]/g,G=function(){function t(){this.m=null}return t.prototype.setData=function(t){this.m=t},t.prototype.draw=function(t,i,e){var n=this;if(null!==this.m&&!1!==this.m.visible&&0!==this.m.text.length){t.font=i.font;var r=Math.round(i.widthCache.measureText(t,this.m.text,Q));if(!(r<=0)){t.save();var s=i.paddingHorizontal,o=r+2*s,h=o/2,a=this.m.width,u=this.m.coordinate,l=Math.floor(u-h)+.5;l<0?(u+=Math.abs(0-l),l=Math.floor(u-h)+.5):l+o>a&&(u-=Math.abs(a-(l+o)),l=Math.floor(u-h)+.5);var c=l+o,p=0+i.borderSize+i.paddingTop+i.fontSize+i.paddingBottom;t.fillStyle=this.m.background;var f=Math.round(l*e),d=Math.round(0*e),v=Math.round(c*e),m=Math.round(p*e);t.fillRect(f,d,v-f,m-d);var g=Math.round(this.m.coordinate*e),b=d,S=Math.round((b+i.borderSize+i.tickLength)*e);t.fillStyle=this.m.color;var w=Math.max(1,Math.floor(e)),M=Math.floor(.5*e);t.fillRect(g-M,b,w,S-b);var x=p-i.baselineOffset-i.paddingBottom;t.textAlign="left",t.fillStyle=this.m.color,H(t,e,(function(){t.fillText(y(n.m).text,l+s,x)})),t.restore()}}},t}(),tt=function(t){function i(i,e,n){var r=t.call(this)||this;return r.o=!0,r.g=new G,r.p={visible:!1,background:"#4c525e",color:"white",text:"",width:0,coordinate:NaN},r.v=i,r.F=e,r.V=n,r}return p(i,t),i.prototype.update=function(){this.o=!0},i.prototype.renderer=function(){return this.o&&(this.M(),this.o=!1),this.g.setData(this.p),this.g},i.prototype.M=function(){var t=this.p;t.visible=!1;var i=this.v.options().vertLine;if(i.labelVisible){var e=this.F.timeScale();if(!e.isEmpty()){var n=e.indexToUserTime(this.v.appliedIndex());t.width=e.width();var r=this.V();r.time&&(t.coordinate=r.coordinate,t.text=e.formatDateTime(y(n)),t.visible=!0,t.background=i.labelBackgroundColor,t.color=Y(i.labelBackgroundColor))}}},i}(function(){function t(){this._text="",this._background="#585858",this._coordinate=0}return t.prototype.text=function(){return this._text},t.prototype.background=function(){return this._background},t.prototype.color=function(){return"black"===U(W(this._background),150)?"white":"black"},t.prototype.coordinate=function(){return this._coordinate},t}()),it=function(){function t(){this._priceScale=null,this.P=0}return t.prototype.zorder=function(){return this.P},t.prototype.setZorder=function(t){this.P=t},t.prototype.priceScale=function(){return this._priceScale},t.prototype.setPriceScale=function(t){this._priceScale=t},t.prototype.priceAxisViews=function(t,i){return[]},t.prototype.paneViews=function(t){return[]},t.prototype.timeAxisViews=function(){return[]},t}();!function(t){t[t.Normal=0]="Normal",t[t.Magnet=1]="Magnet"}(K||(K={}));var et=function(t){function i(i,e){var n,r,s=t.call(this)||this;s.I=null,s.O=NaN,s.R=0,s.W=!0,s.U=new Map,s.q=!1,s.j=NaN,s.H=NaN,s.Y=NaN,s.K=NaN,s.F=i,s.$=e,s._=new A(i,s),s.X=(n=function(){return s.O},r=function(){return s.H},function(t){var i=r(),e=n();if(t===y(s.I).defaultPriceScale())return{price:e,coordinate:i};var o=y(t.firstValue());return{price:t.coordinateToPrice(i,o),coordinate:i}});var o=function(){return{time:s.F.timeScale().indexToUserTime(s.R),coordinate:s.appliedX()}};return s.Z=new tt(s,i,o),s.J=new B(s),s}return p(i,t),i.prototype.index=function(){return this.R},i.prototype.options=function(){return this.$},i.prototype.saveOriginCoord=function(t,i){this.Y=t,this.K=i},i.prototype.clearOriginCoord=function(){this.Y=NaN,this.K=NaN},i.prototype.originCoordX=function(){return this.Y},i.prototype.originCoordY=function(){return this.K},i.prototype.setPosition=function(t,i,e){this.q||(this.q=!0),this.W=!0,this.G(t,i,e)},i.prototype.appliedIndex=function(){return this.R},i.prototype.appliedX=function(){return this.j},i.prototype.appliedY=function(){return this.H},i.prototype.visible=function(){return this.W},i.prototype.clearPosition=function(){this.W=!1,this.tt(),this.O=NaN,this.j=NaN,this.H=NaN,this.I=null,this.clearOriginCoord()},i.prototype.paneViews=function(t){return null!==this.I?[this.J,this._]:[]},i.prototype.horzLineVisible=function(t){return t===this.I&&this.$.horzLine.visible},i.prototype.vertLineVisible=function(){return this.$.vertLine.visible},i.prototype.priceAxisViews=function(t,i){this.W&&this.I===t||this.U.clear();var e=[];return this.I===t&&e.push(this.it(this.U,i,this.X)),e},i.prototype.timeAxisViews=function(){return this.W?[this.Z]:[]},i.prototype.pane=function(){return this.I},i.prototype.updateAllViews=function(){this.U.forEach((function(t){return t.update()})),this.Z.update(),this._.update()},i.prototype.nt=function(t){return t&&!t.defaultPriceScale().isEmpty()?t.defaultPriceScale():null},i.prototype.G=function(t,i,e){this.st(t,i,e)&&this.updateAllViews()},i.prototype.st=function(t,i,e){var n=this.j,r=this.H,s=this.O,o=this.R,h=this.I,a=this.nt(e);this.R=t,this.j=isNaN(t)?NaN:this.F.timeScale().indexToCoordinate(t),this.I=e;var u=null!==a?a.firstValue():null;return null!==a&&null!==u?(this.O=i,this.H=a.priceToCoordinate(i,u)):(this.O=NaN,this.H=NaN),n!==this.j||r!==this.H||o!==this.R||s!==this.O||h!==this.I},i.prototype.tt=function(){var t=this.F.serieses().map((function(t){return t.bars().lastIndex()})).filter(k),i=0===t.length?null:Math.max.apply(Math,t);this.R=null!==i?i:NaN},i.prototype.it=function(t,i,e){var n=t.get(i);return void 0===n&&(n=new Z(this,i,e),t.set(i,n)),n},i}(it);function nt(t,i){if(!S(t))return"n/a";if(!w(i))throw new TypeError("invalid length");if(i<0||i>16)throw new TypeError("invalid length");return 0===i?t.toString():("0000000000000000"+t.toString()).slice(-i)}var rt,st=function(){function t(t,i,e,n){if(i||(i=1),S(t)&&w(t)||(t=100),t<0)throw new TypeError("invalid base");this.B=t,this.ht=i,this.rt=n,e&&void 0!==n&&n>0&&2!==n&&4!==n&&8!==n||(this.ut=e,this.et())}return t.prototype.format=function(t){var i=t<0?"âˆ’":"";return t=Math.abs(t),this.ut?i+this.ot(t):i+this.ft(t)},t.prototype.et=function(){if(this._fractionalLength=0,this.B>0&&this.ht>0){var t=this.B;for(this.ut&&this.rt&&(t/=this.rt);t>1;)t/=10,this._fractionalLength++}},t.prototype.ft=function(t){var i;i=this.ut?Math.pow(10,this._fractionalLength||0):this.B/this.ht;var e=Math.floor(t),n="",r=void 0!==this._fractionalLength?this._fractionalLength:NaN;if(i>1){var s=+(Math.round(t*i)-e*i).toFixed(this._fractionalLength);s>=i&&(s-=i,e+=1),n="."+nt(+s.toFixed(this._fractionalLength)*this.ht,r)}else e=Math.round(e*i)/i,r>0&&(n="."+nt(0,r));return e.toFixed(0)+n},t.prototype.ot=function(t){var i=this.B/this.ht,e=Math.floor(t),n=Math.round(t*i)-e*i;if(n===i&&(n=0,e+=1),!this._fractionalLength)throw new Error("_fractionalLength is not calculated");var r="";if(this.rt){var s=n%this.rt;r=nt(n=(n-s)/this.rt,this._fractionalLength)+"'"+(2===this.rt?["0","5"][s]:8===this.rt?["0","1","2","3","4","5","6","7"][s]:["0","2","5","7"][s])}else r=nt(n*this.ht,this._fractionalLength);return e.toString()+"'"+r},t}(),ot=function(t){function i(i){return void 0===i&&(i=100),t.call(this,i)||this}return p(i,t),i.prototype.format=function(i){return t.prototype.format.call(this,i)+"%"},i}(st),ht=function(){function t(){this.at=[]}return t.prototype.subscribe=function(t,i,e){var n={callback:t,linkedObject:i,singleshot:!0===e};this.at.push(n)},t.prototype.unsubscribe=function(t){var i=this.at.findIndex((function(i){return t===i.callback}));i>-1&&this.at.splice(i,1)},t.prototype.unsubscribeAll=function(t){this.at=this.at.filter((function(i){return i.linkedObject===t}))},t.prototype.fire=function(t,i){var e=d(this.at);this.at=this.at.filter((function(t){return!t.singleshot})),e.forEach((function(e){return e.callback(t,i)}))},t.prototype.hasListeners=function(){return this.at.length>0},t.prototype.destroy=function(){this.at=[]},t}(),at=function(t){function i(i){var e=t.call(this)||this;return e.F=i,e}return p(i,t),i.prototype.model=function(){return this.F},i.prototype.minMove=function(){return 0},i.prototype.autoscaleInfo=function(t,i){return null},i}(it),ut=function(){function t(t,i){this.ct=t,this.lt=i}return t.prototype.equals=function(t){return null!==t&&this.ct===t.ct&&this.lt===t.lt},t.prototype.clone=function(){return new t(this.ct,this.lt)},t.prototype.minValue=function(){return this.ct},t.prototype.setMinValue=function(t){this.ct=t},t.prototype.maxValue=function(){return this.lt},t.prototype.setMaxValue=function(t){this.lt=t},t.prototype.length=function(){return this.lt-this.ct},t.prototype.isEmpty=function(){return this.lt===this.ct||Number.isNaN(this.lt)||Number.isNaN(this.ct)},t.prototype.merge=function(i){return null===i?this:new t(Math.min(this.minValue(),i.minValue()),Math.max(this.maxValue(),i.maxValue()))},t.prototype.apply=function(t,i){this.ct=Math.min(this.ct,t),this.lt=Math.max(this.lt,i)},t.prototype.set=function(t,i){this.ct=t,this.lt=i},t.prototype.scaleAroundCenter=function(t){if(S(t)&&0!=this.lt-this.ct){var i=.5*(this.lt+this.ct),e=this.lt-i,n=this.ct-i;e*=t,n*=t,this.lt=i+e,this.ct=i+n}},t.prototype.shift=function(t){S(t)&&(this.lt+=t,this.ct+=t)},t.prototype.containsStrictly=function(t){return t.minValue()>this.ct&&t.maxValue()<this.lt},t}();function lt(t,i,e){return Math.min(Math.max(t,i),e)}function ct(t,i,e){return i-t<=e}function pt(t){return t<=0?NaN:Math.log(t)/Math.log(10)}function ft(t){var i=Math.ceil(t);return i%2!=0?i-1:i}function dt(t){var i=Math.ceil(t);return i%2==0?i-1:i}function vt(t,i){var e=100*(t-i)/i;return i<0?-e:e}function mt(t,i){var e=vt(t.minValue(),i),n=vt(t.maxValue(),i);return new ut(e,n)}function yt(t,i){var e=100*(t-i)/i+100;return i<0?-e:e}function gt(t,i){var e=yt(t.minValue(),i),n=yt(t.maxValue(),i);return new ut(e,n)}function bt(t){var i=Math.abs(t);if(i<1e-8)return 0;var e=pt(i+1e-4)+4;return t<0?-e:e}function St(t){var i=Math.abs(t);if(i<1e-8)return 0;var e=Math.pow(10,i-4)-1e-4;return t<0?-e:e}function wt(t){if(null===t)return null;var i=bt(t.minValue()),e=bt(t.maxValue());return new ut(i,e)}!function(t){t[t.LogicalOffset=4]="LogicalOffset",t[t.CoordOffset=1e-4]="CoordOffset"}(rt||(rt={}));var Mt=function(){function t(t,i){if(this.vt=t,this.dt=i,function(t){if(t<0)return!1;for(var i=t;i>1;i/=10)if(i%10!=0)return!1;return!0}(this.vt))this.Mt=[2,2.5,2];else{this.Mt=[];for(var e=this.vt;1!==e;){if(e%2==0)this.Mt.push(2),e/=2;else{if(e%5!=0)throw new Error("unexpected base");this.Mt.push(2),this.Mt.push(2.5),e/=5}if(this.Mt.length>100)throw new Error("something wrong with base")}}}return t.prototype.tickSpan=function(t,i,e){for(var n,r=0===this.vt?0:1/this.vt,s=Math.pow(10,Math.max(0,Math.ceil(pt(t-i)))),o=0,h=this.dt[0];;){var a=ct(s,r,1e-9)&&s>r+1e-9,u=ct(s,e*h,1e-9),l=ct(s,1,1e-9);if(!(a&&u&&l))break;s/=h,h=this.dt[++o%this.dt.length]}if(s<=r+1e-9&&(s=r),s=Math.max(1,s),this.Mt.length>0&&(n=s,1,1e-9,Math.abs(n-1)<1e-9))for(o=0,h=this.Mt[0];ct(s,e*h,1e-9)&&s>r+1e-9;)s/=h,h=this.Mt[++o%this.Mt.length];return s},t}(),xt=function(){function t(t,i,e,n){this.wt=[],this.B=t,this.vt=i,this.bt=e,this.pt=n}return t.prototype.setBase=function(t){if(t<0)throw new Error("base < 0");this.vt=t},t.prototype.tickSpan=function(t,i){if(t<i)throw new Error("high < low");var e=this.B.height(),n=(t-i)*this.gt()/e,r=new Mt(this.vt,[2,2.5,2]),s=new Mt(this.vt,[2,2,2.5]),o=new Mt(this.vt,[2.5,2,2]),h=[];return h.push(r.tickSpan(t,i,n)),h.push(s.tickSpan(t,i,n)),h.push(o.tickSpan(t,i,n)),function(t){if(t.length<1)throw Error("array is empty");for(var i=t[0],e=1;e<t.length;++e)t[e]<i&&(i=t[e]);return i}(h)},t.prototype.rebuildTickMarks=function(){var t=this.B,i=t.firstValue();if(null!==i){var e=t.height(),n=this.bt(e-1,i),r=this.bt(0,i),s=this.B.options().entireTextOnly?this.yt()/2:0,o=s,h=e-1-s,a=Math.max(n,r),u=Math.min(n,r);if(a!==u){for(var l=this.tickSpan(a,u),c=a%l,p=a>=u?1:-1,f=null,d=0,v=a-(c+=c<0?l:0);v>u;v-=l){var m=this.pt(v,i,!0);null!==f&&Math.abs(m-f)<this.gt()||m<o||m>h||(d<this.wt.length?(this.wt[d].coord=m,this.wt[d].label=t.formatLogical(v)):this.wt.push({coord:m,label:t.formatLogical(v)}),d++,f=m,t.isLog()&&(l=this.tickSpan(v*p,u)))}this.wt.length=d}else this.wt=[]}else this.wt=[]},t.prototype.marks=function(){return this.wt},t.prototype.yt=function(){return this.B.fontSize()},t.prototype.gt=function(){return Math.ceil(2.5*this.yt())},t}(),Ct=function(){function t(t){this.kt=t}return t.prototype.format=function(t){var i="";return t<0&&(i="-",t=-t),t<995?i+this.Nt(t):t<999995?i+this.Nt(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),i+this.Nt(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),i+this.Nt(t/1e9)+"B")},t.prototype.Nt=function(t){var i=Math.pow(10,this.kt);return((t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.kt).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,(function(t,i){return i}))},t}();function Tt(t,i,e,n){if(0!==i.length){var r=i[n.from].x,s=i[n.from].y;t.moveTo(r,s);for(var o=n.from+1;o<n.to;++o){var h=i[o];if(1===e){var a=i[o-1].y,u=h.x;t.lineTo(u,a)}t.lineTo(h.x,h.y)}}}var kt=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i._data=null,i}return p(i,t),i.prototype.setData=function(t){this._data=t},i.prototype._drawImpl=function(t){if(null!==this._data&&0!==this._data.items.length&&null!==this._data.visibleRange){t.lineCap="butt",t.strokeStyle=this._data.lineColor,t.lineWidth=this._data.lineWidth,u(t,this._data.lineStyle),t.lineWidth=1,t.beginPath(),t.moveTo(this._data.items[this._data.visibleRange.from].x,this._data.bottom),t.lineTo(this._data.items[this._data.visibleRange.from].x,this._data.items[this._data.visibleRange.from].y),Tt(t,this._data.items,this._data.lineType,this._data.visibleRange),t.lineTo(this._data.items[this._data.visibleRange.to-1].x,this._data.bottom),t.lineTo(this._data.items[this._data.visibleRange.from].x,this._data.bottom),t.closePath();var i=t.createLinearGradient(0,0,0,this._data.bottom);i.addColorStop(0,this._data.topColor),i.addColorStop(1,this._data.bottomColor),t.fillStyle=i,t.fill()}},i}(F),Pt=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i._data=null,i}return p(i,t),i.prototype.setData=function(t){this._data=t},i.prototype._drawImpl=function(t){null!==this._data&&0!==this._data.items.length&&null!==this._data.visibleRange&&(t.lineCap="square",t.lineWidth=this._data.lineWidth,u(t,this._data.lineStyle),t.strokeStyle=this._data.lineColor,t.lineJoin="miter",t.beginPath(),Tt(t,this._data.items,this._data.lineType,this._data.visibleRange),t.stroke())},i}(F);function _t(t,i,e,n,r){void 0===n&&(n=0),void 0===r&&(r=t.length);for(var s=r-n;0<s;){var o=s>>1,h=n+o;e(t[h],i)?(n=h+1,s-=o+1):s=o}return n}function Et(t,i,e,n,r){void 0===n&&(n=0),void 0===r&&(r=t.length);for(var s=r-n;0<s;){var o=s>>1,h=n+o;e(i,t[h])?s=o:(n=h+1,s-=o+1)}return n}function Lt(t,i){return t.time<i}function Rt(t,i){return t<i.time}function Vt(t,i,e){var n=i.firstBar(),r=i.lastBar(),s=_t(t,n,Lt),o=Et(t,r,Rt);if(!e)return{from:s,to:o};var h=s,a=o;return s>0&&s<t.length&&t[s].time>=n&&(h=s-1),o>0&&o<t.length&&t[o-1].time<=r&&(a=o+1),{from:h,to:a}}var Ft,Dt=function(){function t(t,i,e){this._invalidated=!0,this._dataInvalidated=!0,this._items=[],this._itemsVisibleRange=null,this._series=t,this._model=i,this.St=e}return t.prototype.update=function(t){this._invalidated=!0,"data"===t&&(this._dataInvalidated=!0)},t.prototype._makeValid=function(){this._dataInvalidated&&(this._fillRawPoints(),this._dataInvalidated=!1),this._invalidated&&(this._updatePoints(),this._invalidated=!1)},t.prototype._clearVisibleRange=function(){this._itemsVisibleRange=null},t.prototype._updatePoints=function(){var t=this._series.priceScale(),i=this._model.timeScale();if(this._clearVisibleRange(),!i.isEmpty()&&!t.isEmpty()){var e=i.visibleBars();if(null!==e&&0!==this._series.data().bars().size()){var n=this._series.firstValue();null!==n&&(this._itemsVisibleRange=Vt(this._items,e,this.St),this._convertToCoordinates(t,i,n.value))}}},t}(),zt=function(t){function i(i,e){return t.call(this,i,e,!0)||this}return p(i,t),i.prototype._convertToCoordinates=function(t,i,e){i.indexesToCoordinates(this._items,P(this._itemsVisibleRange)),t.pointsArrayToCoordinates(this._items,e,P(this._itemsVisibleRange))},i.prototype._createRawItemBase=function(t,i){return{time:t,price:i,x:NaN,y:NaN}},i.prototype._fillRawPoints=function(){var t=this,i=this._series.barFunction(),e=[],n=this._series.barColorer();this._series.bars().each((function(r,s){var o=i(s.value),h=t._createRawItem(r,o,n);return e.push(h),!1})),this._items=e},i}(Dt),At=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.g=new V,n.xt=new kt,n.Dt=new Pt,n.g.setRenderers([n.xt,n.Dt]),n}return p(i,t),i.prototype.renderer=function(t,i){this._makeValid();var e=this._series.options(),n={lineType:e.lineType,items:this._items,lineColor:e.lineColor,lineStyle:e.lineStyle,lineWidth:e.lineWidth,topColor:e.topColor,bottomColor:e.bottomColor,bottom:t,visibleRange:this._itemsVisibleRange};return this.xt.setData(n),this.Dt.setData(n),this.g},i.prototype._createRawItem=function(t,i){return this._createRawItemBase(t,i)},i}(zt),Ot=function(){function t(){this.m=null,this.Ct=0,this.Tt=0}return t.prototype.setData=function(t){this.m=t},t.prototype.draw=function(t,i,e,n){if(null!==this.m&&0!==this.m.bars.length&&null!==this.m.visibleRange){this.Ct=Math.max(1,Math.floor(function(t,i){return Math.floor(.3*t*i)}(this.m.barSpacing,i))),this.Ct>=2&&Math.floor(i)%2!=this.Ct%2&&this.Ct--,this.Tt=this.m.thinBars?Math.min(this.Ct,Math.floor(i)):this.Ct;for(var r=null,s=this.m.visibleRange.from;s<this.m.visibleRange.to;++s){var o=this.m.bars[s];r!==o.color&&(t.fillStyle=o.color,r=o.color);var h=Math.floor(.5*this.Tt),a=Math.round(o.x*i),u=a-h,l=this.Tt,c=u+l-1,p=Math.round(o.highY*i)-h,f=Math.round(o.lowY*i)+h,d=Math.max(f-p,this.Tt);t.fillRect(u,p,l,d);var v=Math.ceil(1.5*this.Ct);if(this.Tt<=this.Ct){if(this.m.openVisible){var m=a-v,y=Math.max(p,Math.round(o.openY*i)-h),g=y+l-1;g>p+d-1&&(y=(g=p+d-1)-l+1),t.fillRect(m,y,u-m,g-y+1)}var b=a+v,S=Math.max(p,Math.round(o.closeY*i)-h),w=S+l-1;w>p+d-1&&(S=(w=p+d-1)-l+1),t.fillRect(c+1,S,b-c,w-S+1)}}}},t}(),Bt=function(t){function i(i,e){return t.call(this,i,e,!1)||this}return p(i,t),i.prototype._convertToCoordinates=function(t,i,e){i.indexesToCoordinates(this._items,P(this._itemsVisibleRange)),t.barPricesToCoordinates(this._items,e,P(this._itemsVisibleRange))},i.prototype._createDefaultItem=function(t,i,e){return{time:t,open:i.value[0],high:i.value[1],low:i.value[2],close:i.value[3],x:NaN,openY:NaN,highY:NaN,lowY:NaN,closeY:NaN}},i.prototype._fillRawPoints=function(){var t=this,i=[],e=this._series.barColorer();this._series.bars().each((function(n,r){var s=t._createRawItem(n,r,e);return i.push(s),!1})),this._items=i},i}(Dt),It=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.g=new Ot,n}return p(i,t),i.prototype.renderer=function(t,i){this._makeValid();var e=this._series.options(),n={bars:this._items,barSpacing:this._model.timeScale().barSpacing(),openVisible:e.openVisible,thinBars:e.thinBars,visibleRange:this._itemsVisibleRange};return this.g.setData(n),this.g},i.prototype._createRawItem=function(t,i,e){return f(f({},this._createDefaultItem(t,i,e)),{color:e.barStyle(t).barColor})},i}(Bt);!function(t){t[t.BarBorderWidth=1]="BarBorderWidth"}(Ft||(Ft={}));var Nt=function(){function t(){this.m=null,this.Ct=0}return t.prototype.setData=function(t){this.m=t},t.prototype.draw=function(t,i,e,n){if(null!==this.m&&0!==this.m.bars.length&&null!==this.m.visibleRange){this.Ct=function(t,i){var e=Math.floor(.8*t*i),n=Math.floor(t*i),r=Math.min(e,n-1);return Math.max(1,r)}(this.m.barSpacing,i),this.Ct>=2&&Math.floor(i)%2!=this.Ct%2&&this.Ct--;var r=this.m.bars;this.m.wickVisible&&this.Et(t,r,this.m.visibleRange,i),this.m.borderVisible&&this.Lt(t,r,this.m.visibleRange,this.m.barSpacing,i);var s=this.At(i);(!this.m.borderVisible||this.Ct>2*s)&&this.Bt(t,r,this.m.visibleRange,i)}},t.prototype.Et=function(t,i,e,n){if(null!==this.m){var r="",s=Math.min(Math.floor(n),Math.floor(this.m.barSpacing*n));s=Math.min(s,this.Ct);for(var o=Math.floor(.5*s),h=e.from;h<e.to;h++){var a=i[h];a.wickColor!==r&&(t.fillStyle=a.wickColor,r=a.wickColor);var u=Math.round(Math.min(a.openY,a.closeY)*n),l=Math.round(Math.max(a.openY,a.closeY)*n),c=Math.round(a.highY*n),p=Math.round(a.lowY*n),f=Math.round(n*a.x);t.fillRect(f-o,c,s,u-c),t.fillRect(f-o,l+1,s,p-l)}}},t.prototype.At=function(t){var i=Math.floor(1*t);this.Ct<=2*i&&(i=Math.floor(.5*(this.Ct-1)));var e=Math.max(1,i);return this.Ct<=2*e?Math.floor(1*t):e},t.prototype.Lt=function(t,i,e,n,r){for(var s="",o=this.At(r),h=e.from;h<e.to;h++){var a=i[h];a.borderColor!==s&&(t.fillStyle=a.borderColor,s=a.borderColor);var u=Math.round(a.x*r)-Math.floor(.5*this.Ct),l=u+this.Ct-1,c=Math.round(Math.min(a.openY,a.closeY)*r),p=Math.round(Math.max(a.openY,a.closeY)*r);n>2*o?j(t,u,c,l-u+1,p-c+1,o):t.fillRect(u,c,l-u+1,p-c+1)}},t.prototype.Bt=function(t,i,e,n){if(null!==this.m)for(var r="",s=this.At(n),o=e.from;o<e.to;o++){var h=i[o],a=Math.round(Math.min(h.openY,h.closeY)*n),u=Math.round(Math.max(h.openY,h.closeY)*n),l=Math.round(h.x*n)-Math.floor(.5*this.Ct),c=l+this.Ct-1;if(this.m.borderVisible&&(l+=s,a+=s,c-=s,u-=s),!(a>u)){if(h.color!==r){var p=h.color;t.fillStyle=p,r=p}t.fillRect(l,a,c-l+1,u-a+1)}}},t}(),$t=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.g=new Nt,n}return p(i,t),i.prototype.renderer=function(t,i){this._makeValid();var e=this._series.options(),n={bars:this._items,barSpacing:this._model.timeScale().barSpacing(),wickVisible:e.wickVisible,borderVisible:e.borderVisible,visibleRange:this._itemsVisibleRange};return this.g.setData(n),this.g},i.prototype._createRawItem=function(t,i,e){var n=e.barStyle(t);return f(f({},this._createDefaultItem(t,i,e)),{color:n.barColor,wickColor:n.barWickColor,borderColor:n.barBorderColor})},i}(Bt),Wt=function(){function t(){this.m=null,this.zt=[]}return t.prototype.setData=function(t){this.m=t,this.zt=[]},t.prototype.draw=function(t,i,e,n){if(null!==this.m&&0!==this.m.items.length&&null!==this.m.visibleRange){this.zt.length||this.Vt(i);for(var r=Math.round(this.m.histogramBase*i),s=Math.max(1,Math.floor(i)),o=this.m.visibleRange.from;o<this.m.visibleRange.to;o++){var h=this.m.items[o],a=this.zt[o-this.m.visibleRange.from],u=Math.round(h.y*i);t.fillStyle=h.color,t.fillRect(a.left,u,a.right-a.left+1,r-u+s)}}},t.prototype.Vt=function(t){if(null!==this.m&&0!==this.m.items.length&&null!==this.m.visibleRange){var i=Math.ceil(this.m.barSpacing*t)<=3?0:Math.max(1,Math.floor(t)),e=Math.round(this.m.barSpacing*t)-i;this.zt=new Array(this.m.visibleRange.to-this.m.visibleRange.from);for(var n=this.m.visibleRange.from;n<this.m.visibleRange.to;n++){var r,s=this.m.items[n],o=Math.round(s.x*t),h=void 0,a=void 0;e%2?(h=o-(r=(e-1)/2),a=o+r):(h=o-(r=e/2),a=o+r-1),this.zt[n-this.m.visibleRange.from]={left:h,right:a,roundedCenter:o,center:s.x*t,time:s.time}}for(n=this.m.visibleRange.from+1;n<this.m.visibleRange.to;n++){var u=this.zt[n-this.m.visibleRange.from],l=this.zt[n-this.m.visibleRange.from-1];u.time===l.time+1&&u.left-l.right!==i+1&&(l.roundedCenter>l.center?l.right=u.left-i-1:u.left=l.right+i+1)}var c=Math.ceil(this.m.barSpacing*t);for(n=this.m.visibleRange.from;n<this.m.visibleRange.to;n++){(u=this.zt[n-this.m.visibleRange.from]).right<u.left&&(u.right=u.left);var p=u.right-u.left+1;c=Math.min(p,c)}if(i>0&&c<4)for(n=this.m.visibleRange.from;n<this.m.visibleRange.to;n++)(p=(u=this.zt[n-this.m.visibleRange.from]).right-u.left+1)>c&&(u.roundedCenter>u.center?u.right-=1:u.left+=1)}else this.zt=[]},t}();function Ut(t){return{items:[],barSpacing:t,histogramBase:NaN,visibleRange:null}}var Yt,jt=function(t){function i(i,e){var n=t.call(this,i,e,!1)||this;return n.i=new V,n.Ft=Ut(0),n.Pt=new Int32Array(0),n.g=new Wt,n}return p(i,t),i.prototype.renderer=function(t,i){return this._makeValid(),this.i},i.prototype._fillRawPoints=function(){var t=this,i=this._model.timeScale().barSpacing(),e=this._series.palette();this.Ft=Ut(i);var n=this._series.barFunction();this.Pt=new Int32Array(this._series.bars().size());var r=0,s=0,o=0,h=this._series.options().color;this._series.bars().each((function(i,a){var u=n(a.value),l=a.value[4],c=function(t,i,e){return{time:t,price:i,x:NaN,y:NaN,color:e}}(i,u,null!=l?e.colorByIndex(l):h),p=null==l?0:l+1;return++s<t.Ft.items.length?t.Ft.items[s]=c:t.Ft.items.push(c),t._items[o++]={time:i,x:0},t.Pt[r++]=p,!1})),this.g.setData(this.Ft),this.i.setRenderers([this.g])},i.prototype._clearVisibleRange=function(){t.prototype._clearVisibleRange.call(this),this.Ft.visibleRange=null},i.prototype._convertToCoordinates=function(t,i,e){if(null!==this._itemsVisibleRange){var n=i.barSpacing(),r=y(i.visibleBars()),s=t.priceToCoordinate(this._series.options().base,e);i.indexesToCoordinates(this.Ft.items),t.pointsArrayToCoordinates(this.Ft.items,e),this.Ft.histogramBase=s,this.Ft.visibleRange=Vt(this.Ft.items,r,!1),this.Ft.barSpacing=n,this.g.setData(this.Ft)}},i}(Dt),Ht=function(t){function i(i,e){var n=t.call(this,i,e)||this;return n.Dt=new Pt,n}return p(i,t),i.prototype.renderer=function(t,i){this._makeValid();var e=this._series.options(),n={items:this._items,lineColor:e.color,lineStyle:e.lineStyle,lineType:e.lineType,lineWidth:e.lineWidth,visibleRange:this._itemsVisibleRange};return this.Dt.setData(n),this.Dt},i.prototype._createRawItem=function(t,i){return this._createRawItemBase(t,i)},i}(zt),qt=/[2-9]/g,Kt=function(){function t(t){void 0===t&&(t=50),this.It=0,this.Ot=1,this.Rt=1,this.Wt={},this.Ut={},this.qt=t}return t.prototype.reset=function(){this.It=0,this.Ut={},this.Ot=1,this.Rt=1,this.Wt={}},t.prototype.measureText=function(t,i,e){var n=e||qt,r=String(i).replace(n,"0");if(this.Ut[r])return this.Ut[r].width;if(this.It===this.qt){var s=this.Wt[this.Rt];delete this.Wt[this.Rt],delete this.Ut[s],this.Rt++,this.It--}var o=t.measureText(r).width;return 0===o&&i.length?0:(this.Ut[r]={width:o,tick:this.Ot},this.Wt[this.Ot]=r,this.It++,this.Ot++,o)},t}(),Xt=function(){function t(t){this.jt=null,this.Ht=null,this.Yt="right",this.Kt=0,this.$t=t}return t.prototype.setParams=function(t,i,e,n){this.jt=t,this.Ht=i,this.Kt=e,this.Yt=n},t.prototype.draw=function(t,i){null!==this.Ht&&null!==this.jt&&this.jt.draw(t,this.Ht,this.$t,this.Kt,this.Yt,i)},t}(),Jt=function(){function t(t,i,e){this._t=t,this.$t=new Kt(50),this.Xt=i,this.l=e,this.Zt=-1,this.g=new Xt(this.$t)}return t.prototype.update=function(){this._t.update()},t.prototype.renderer=function(t,i){var e=this.l.paneForSource(this.Xt);if(null===e)return null;if(null===this.Xt.priceScale())return null;var n=e.priceScalePosition();if("overlay"===n)return null;var r=this.l.priceAxisRendererOptions();return r.fontSize!==this.Zt&&(this.Zt=r.fontSize,this.$t.reset()),this.g.setParams(this._t.paneRenderer(),r,i,n),this.g},t}(),Zt=function(){function t(){this.m=null}return t.prototype.setData=function(t){this.m=t},t.prototype.draw=function(t,i,e,n){if(null!==this.m&&!1!==this.m.visible){var r=Math.round(this.m.y*i);if(!(r<0||r>Math.ceil(this.m.height*i))){var s=Math.ceil(this.m.width*i);t.lineCap="butt",t.strokeStyle=this.m.color,t.lineWidth=Math.floor(this.m.lineWidth*i),u(t,this.m.lineStyle),l(t,r,0,s)}}},t}(),Qt=function(){function t(t){this._lineRendererData={width:0,height:0,y:0,color:"rgba(0, 0, 0, 0)",lineWidth:1,lineStyle:0,visible:!1},this._lineRenderer=new Zt,this.o=!0,this._series=t,this._model=t.model(),this._lineRenderer.setData(this._lineRendererData)}return t.prototype.update=function(){this.o=!0},t.prototype.renderer=function(t,i){return this.o&&(this._updateImpl(t,i),this.o=!1),this._lineRenderer},t}(),Gt=function(t){function i(i){return t.call(this,i)||this}return p(i,t),i.prototype._updateImpl=function(t,i){this._lineRendererData.visible=!1;var e=this._series.priceScale(),n=e.mode().mode;if(2===n||3===n){var r=this._series.options();if(r.baseLineVisible){var s=this._series.firstValue();null!==s&&(this._lineRendererData.visible=!0,this._lineRendererData.y=e.priceToCoordinate(s.value,s.value),this._lineRendererData.width=i,this._lineRendererData.height=t,this._lineRendererData.color=r.baseLineColor,this._lineRendererData.lineWidth=r.baseLineWidth,this._lineRendererData.lineStyle=r.baseLineStyle)}}},i}(Qt);function ti(t,i){return dt(Math.min(Math.max(t,12),30)*i)}function ii(t,i){switch(t){case"arrowDown":case"arrowUp":return ti(i,1);case"circle":return ti(i,.8);case"square":return ti(i,.7)}}function ei(t){return ft(ti(t,1))}function ni(t){return Math.max(ti(t,.1),3)}function ri(t,i,e,n,r){var s=ii("square",e),o=(s-1)/2,h=t-o,a=i-o;return n>=h&&n<=h+s&&r>=a&&r<=a+s}function si(t,i,e,n,r,s){var o=(ii("arrowUp",s)-1)/2,h=(dt(s/2)-1)/2;i.fillStyle=r,i.beginPath(),t?(i.moveTo(e-o,n),i.lineTo(e,n-o),i.lineTo(e+o,n),i.lineTo(e+h,n),i.lineTo(e+h,n+o),i.lineTo(e-h,n+o),i.lineTo(e-h,n)):(i.moveTo(e-o,n),i.lineTo(e,n+o),i.lineTo(e+o,n),i.lineTo(e+h,n),i.lineTo(e+h,n-o),i.lineTo(e-h,n-o),i.lineTo(e-h,n)),i.fill()}!function(t){t[t.MinShapeSize=12]="MinShapeSize",t[t.MaxShapeSize=30]="MaxShapeSize",t[t.MinShapeMargin=3]="MinShapeMargin"}(Yt||(Yt={}));var oi=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.m=null,i}return p(i,t),i.prototype.setData=function(t){this.m=t},i.prototype.hitTest=function(t,i){if(null===this.m||null===this.m.visibleRange)return null;for(var e=this.m.visibleRange.from;e<this.m.visibleRange.to;e++){var n=this.m.items[e];if(ai(n,t,i))return{hitTestData:n.internalId,externalId:n.externalId}}return null},i.prototype._drawImpl=function(t,i,e){if(null!==this.m&&null!==this.m.visibleRange)for(var n=this.m.visibleRange.from;n<this.m.visibleRange.to;n++)hi(this.m.items[n],t)},i}(F);function hi(t,i){switch(t.shape){case"arrowDown":return void si(!1,i,t.x,t.y,t.color,t.size);case"arrowUp":return void si(!0,i,t.x,t.y,t.color,t.size);case"circle":return void function(t,i,e,n,r){var s=(ii("circle",r)-1)/2;t.fillStyle=n,t.beginPath(),t.arc(i,e,s,0,2*Math.PI,!1),t.fill()}(i,t.x,t.y,t.color,t.size);case"square":return void function(t,i,e,n,r){var s=ii("square",r),o=(s-1)/2,h=i-o,a=e-o;t.fillStyle=n,t.fillRect(h,a,s,s)}(i,t.x,t.y,t.color,t.size)}t.shape}function ai(t,i,e){switch(t.shape){case"arrowDown":case"arrowUp":return function(t,i,e,n,r,s){return ri(i,e,n,r,s)}(0,t.x,t.y,t.size,i,e);case"circle":return function(t,i,e,n,r){var s=2+ii("circle",e)/2,o=t-n,h=i-r;return Math.sqrt(o*o+h*h)<=s}(t.x,t.y,t.size,i,e);case"square":return ri(t.x,t.y,t.size,i,e)}t.shape}function ui(t,i,e,n,r,s,o,h){var a=S(e)?e:e.close,u=S(e)?e:e.high,l=S(e)?e:e.low,c=ei(o.barSpacing());switch(t.size=c,i.position){case"inBar":return void(t.y=s.priceToCoordinate(a,h));case"aboveBar":return t.y=s.priceToCoordinate(u,h)-c/2-n.aboveBar,void(n.aboveBar+=c+r);case"belowBar":return t.y=s.priceToCoordinate(l,h)+c/2+n.belowBar,void(n.belowBar+=c+r)}i.position}var li,ci=function(){function t(t,i){this.o=!0,this.Jt=!0,this.Gt=!0,this.Qt=null,this.g=new oi,this.ti=t,this.F=i,this.m={items:[],visibleRange:null}}return t.prototype.update=function(t){this.o=!0,this.Gt=!0,"data"===t&&(this.Jt=!0)},t.prototype.renderer=function(t,i,e){return this.o&&this._makeValid(),this.g.setData(this.m),this.g},t.prototype.autoScaleMargins=function(){if(this.Gt){if(this.ti.indexedMarkers().length>0){var t=this.F.timeScale().barSpacing(),i=ni(t),e=1.5*ei(t)+2*i;this.Qt={above:e,below:e}}else this.Qt=null;this.Gt=!1}return this.Qt},t.prototype._makeValid=function(){var t=this.ti.priceScale(),i=this.F.timeScale(),e=this.ti.indexedMarkers();this.Jt&&(this.m.items=e.map((function(t){return{time:t.time,x:0,y:0,size:0,shape:t.shape,color:t.color,internalId:t.internalId,externalId:t.id}})),this.Jt=!1),this.m.visibleRange=null;var n=i.visibleBars();if(null!==n){var r=this.ti.firstValue();if(null!==r&&0!==this.m.items.length){var s=NaN,o=ni(i.barSpacing()),h={aboveBar:o,belowBar:o};this.m.visibleRange=Vt(this.m.items,n,!0);for(var a=this.m.visibleRange.from;a<this.m.visibleRange.to;a++){var u=e[a];u.time!==s&&(h.aboveBar=o,h.belowBar=o,s=u.time);var l=this.m.items[a];l.x=i.indexToCoordinate(u.time);var c=this.ti.dataAt(u.time);null!==c&&ui(l,u,c,h,o,t,i,r.value)}this.o=!1}}},t}(),pi=function(t){function i(i){return t.call(this,i)||this}return p(i,t),i.prototype._updateImpl=function(t,i){var e=this._lineRendererData;e.visible=!1;var n=this._series.options();if(n.priceLineVisible){var r=this._series.lastValueData(void 0,0===n.priceLineSource);r.noData||(e.visible=!0,e.y=r.coordinate,e.color=this._series.priceLineColor(r.color),e.width=i,e.height=t,e.lineWidth=n.priceLineWidth,e.lineStyle=n.priceLineStyle)}},i}(Qt),fi=function(t){function i(i,e){var n=t.call(this)||this;return n.k=i,n.m=e,n}return p(i,t),i.prototype._getSource=function(){return this.k},i.prototype._getData=function(){return this.m},i.prototype._updateRendererData=function(t,i,e){t.visible=!1,i.visible=!1;var n=this.k.options(),r=n.lastValueVisible,s=""!==this.k.title(),o=0===n.seriesLastValueMode,h=this.k.lastValueData(void 0,!1);h.noData||(r&&(t.text=this._axisText(h,r,o),t.visible=0!==t.text.length),(s||o)&&(i.text=this._paneText(h,r,s,o),i.visible=i.text.length>0),e.background=this.k.priceLineColor(h.color),e.color=Y(e.background),e.coordinate=h.coordinate,i.borderColor=this.k.model().options().layout.backgroundColor,t.borderColor=e.background)},i.prototype._paneText=function(t,i,e,n){var r="",s=this.k.title();return e&&0!==s.length&&(r+=s+" "),i&&n&&(r+=this.k.priceScale().isPercentage()?t.formattedPriceAbsolute:t.formattedPricePercentage),r.trim()},i.prototype._axisText=function(t,i,e){return i?e?this.k.priceScale().isPercentage()?t.formattedPricePercentage:t.formattedPriceAbsolute:t.text:""},i}(J),di=function(t){function i(i,e){var n=t.call(this,i)||this;return n.ii=e,n}return p(i,t),i.prototype._updateImpl=function(t,i){var e=this._lineRendererData;e.visible=!1;var n=this.ii.yCoord();if(null!==n){var r=this.ii.options();e.visible=!0,e.y=n,e.color=r.color,e.width=i,e.height=t,e.lineWidth=r.lineWidth,e.lineStyle=r.lineStyle}},i}(Qt),vi=function(t){function i(i,e){var n=t.call(this)||this;return n.ti=i,n.ii=e,n}return p(i,t),i.prototype._updateRendererData=function(t,i,e){t.visible=!1,i.visible=!1;var n=this.ii.options();if(n.axisLabelVisible){var r=this.ii.yCoord();null!==r&&(t.text=this.ti.priceScale().formatPriceAbsolute(n.price),t.visible=!0,e.background=n.color,e.color=Y(n.color),e.coordinate=r)}},i}(J),mi=function(){function t(t,i){this.ti=t,this.$=i,this.ni=new di(t,this),this._t=new vi(t,this)}return t.prototype.applyOptions=function(t){b(this.$,t),this.update(),this.ti.model().lightUpdate()},t.prototype.options=function(){return this.$},t.prototype.paneView=function(){return this.ni},t.prototype.priceAxisView=function(){return this._t},t.prototype.update=function(){this.ni.update(),this._t.update()},t.prototype.yCoord=function(){var t=this.ti,i=t.priceScale();if(t.model().timeScale().isEmpty()||i.isEmpty())return null;var e=t.firstValue();return null===e?null:i.priceToCoordinate(this.$.price,e.value)},t}(),yi=function(){function t(){this.si=0,this.hi=new Map,this.ri=new Map}return t.prototype.colorByIndex=function(t){return m(this.ri.get(t))},t.prototype.addColor=function(t){var i=this.hi.get(t);return void 0===i&&(i=this.si++,this.hi.set(t,i),this.ri.set(i,t)),i},t.prototype.clear=function(){this.si=0,this.hi.clear(),this.ri.clear()},t.prototype.size=function(){return this.ri.size},t}(),gi={barColor:"",barBorderColor:"",barWickColor:""},bi=function(){function t(t){this.ti=t}return t.prototype.barStyle=function(t,i){var e=this.ti.seriesType(),n=this.ti.options();switch(e){case"Line":return this.ui(n);case"Area":return this.ei(n);case"Bar":return this.oi(n,t,i);case"Candlestick":return this.fi(n,t,i);case"Histogram":return this.ai(n,t,i)}throw new Error("Unknown chart style")},t.prototype.oi=function(t,i,e){var n=f({},gi),r=t.upColor,s=t.downColor,o=r,h=s,a=y(this.ci(i,e)),u=g(a.value[0])<=g(a.value[3]);return n.barColor=u?r:s,n.barBorderColor=u?o:h,n},t.prototype.fi=function(t,i,e){var n=f({},gi),r=t.upColor,s=t.downColor,o=t.borderUpColor,h=t.borderDownColor,a=t.wickUpColor,u=t.wickDownColor,l=y(this.ci(i,e)),c=g(l.value[0])<=g(l.value[3]);return n.barColor=c?r:s,n.barBorderColor=c?o:h,n.barWickColor=c?a:u,n},t.prototype.ei=function(t){return f(f({},gi),{barColor:t.lineColor})},t.prototype.ui=function(t){return f(f({},gi),{barColor:t.color})},t.prototype.ai=function(t,i,e){var n=f({},gi),r=y(this.ci(i,e)).value[4];if(null!=r){var s=y(this.ti.palette());n.barColor=s.colorByIndex(r)}else n.barColor=t.color;return n},t.prototype.li=function(){return this.ti.bars()},t.prototype.ci=function(t,i){return void 0!==i?i.value:this.li().valueAt(t)},t}();!function(t){t[t.NearestLeft=-1]="NearestLeft",t[t.Exact=0]="Exact",t[t.NearestRight=1]="NearestRight"}(li||(li={}));var Si,wi=function(){function t(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.vi=[],this.di=0,this.Mi=0,this.wi=!1,this.bi=new Map,this.mi=new Map,this.pi=new Map,this.gi=t||new Map,this.yi=i}return t.prototype.clear=function(){this.vi=[],this.di=0,this.Mi=0,this.wi=!1,this.bi.clear(),this.mi.clear(),this.pi.clear()},t.prototype.first=function(){return this.size()>0?this.vi[this.di]:null},t.prototype.last=function(){return this.size()>0?this.vi[this.Mi-1]:null},t.prototype.firstIndex=function(){return this.size()>0?this.ki(this.di):null},t.prototype.lastIndex=function(){return this.size()>0?this.ki(this.Mi-1):null},t.prototype.size=function(){return this.Mi-this.di},t.prototype.isEmpty=function(){return 0===this.size()},t.prototype.contains=function(t){return null!==this.Ni(t,0)},t.prototype.valueAt=function(t){return this.search(t)},t.prototype.add=function(t,i,e){if(this.wi)return!1;var n={index:t,value:e,time:i},r=this.Ni(t,0);return this.mi.clear(),this.pi.clear(),null===r?(this.vi.splice(this.Si(t),0,n),this.di=0,this.Mi=this.vi.length,!0):(this.vi[r]=n,!1)},t.prototype.search=function(t,i,e){void 0===i&&(i=0);var n=this.Ni(t,i,e);if(null===n)return null;var r=this.xi(n);return{index:this.ki(n),time:r.time,value:r.value}},t.prototype.each=function(t){for(var i=this.di;i<this.Mi&&!t(this.ki(i),this.xi(i));++i);},t.prototype.range=function(i,e){var n=new t(this.gi,this.yi);return n.vi=this.vi,n.di=this.Si(i),n.Mi=this.Di(e),n.wi=!0,n},t.prototype.minMaxOnRangeCached=function(t,i,e){if(this.isEmpty())return null;for(var n=null,r=0,s=e;r<s.length;r++){var o=s[r];n=Mi(n,this.Ci(t,i,o))}return n},t.prototype.merge=function(t){return this.wi||0===t.length?null:this.isEmpty()||t[t.length-1].index<this.vi[0].index?this.Ti(t):t[0].index>this.vi[this.vi.length-1].index?this.Ei(t):1===t.length&&t[0].index===this.vi[this.vi.length-1].index?(this.Li(t[0]),t[0]):this.Ai(t)},t.prototype.remove=function(t){if(this.wi)return null;var i=this.Ni(t,1);if(null===i)return null;var e=this.vi.splice(i);return this.Mi=this.vi.length,this.bi.clear(),this.mi.clear(),this.pi.clear(),e.length>0?e[0]:null},t.prototype.ki=function(t){return this.vi[t].index},t.prototype.xi=function(t){return this.vi[t]},t.prototype.Ni=function(t,i,e){var n=this.Bi(t);if(null===n&&0!==i)switch(i){case-1:return this.zi(t,e);case 1:return this.Vi(t,e);default:throw new TypeError("Unknown search mode")}if(!e||null===n||0===i)return n;switch(i){case-1:return this.Fi(n);case 1:return this.Pi(n);default:throw new TypeError("Unknown search mode")}},t.prototype.Pi=function(t){for(var i=y(this.yi);t<this.Mi&&i(this.xi(t).value);)t+=1;return t===this.Mi?null:t},t.prototype.Fi=function(t){for(var i=y(this.yi);t>=this.di&&i(this.xi(t).value);)t-=1;return t<this.di?null:t},t.prototype.zi=function(t,i){var e=this.Si(t);e>this.di&&(e-=1);var n=e!==this.Mi&&this.ki(e)<t?e:null;return i&&null!==n?this.Fi(n):n},t.prototype.Vi=function(t,i){var e=this.Di(t),n=e!==this.Mi&&t<this.ki(e)?e:null;return i&&null!==n?this.Pi(n):n},t.prototype.Bi=function(t){var i=this.Si(t);return i===this.Mi||t<this.vi[i].index?null:i},t.prototype.Si=function(t){return _t(this.vi,t,(function(t,i){return t.index<i}),this.di,this.Mi)},t.prototype.Di=function(t){return Et(this.vi,t,(function(t,i){return i.index>t}),this.di,this.Mi)},t.prototype.Ii=function(t,i,e){var n=null,r=this.gi.get(e.name);if(void 0===r)throw new Error('Plot "'+e.name+'" is not registered');for(var s=t;s<i;s++){var o=r(this.vi[s].value);null==o||Number.isNaN(o)||(null===n?n={min:o,max:o}:(o<n.min&&(n.min=o),o>n.max&&(n.max=o)))}return n},t.prototype.Oi=function(t){var i=Math.floor(t.index/30);this.bi.forEach((function(t){return t.delete(i)}))},t.prototype.Ti=function(t){return v(!this.wi,"collection should not be readonly"),v(0!==t.length,"plotRows should not be empty"),this.mi.clear(),this.pi.clear(),this.bi.clear(),this.vi=t.concat(this.vi),this.di=0,this.Mi=this.vi.length,t[0]},t.prototype.Ei=function(t){return v(!this.wi,"collection should not be readonly"),v(0!==t.length,"plotRows should not be empty"),this.mi.clear(),this.pi.clear(),this.bi.clear(),this.vi=this.vi.concat(t),this.di=0,this.Mi=this.vi.length,t[0]},t.prototype.Li=function(t){v(!this.isEmpty(),"plot list should not be empty"),v(this.vi[this.Mi-1].index===t.index,"last row index should match new row index"),this.Oi(t),this.mi.delete(t.index),this.pi.delete(t.index),this.vi[this.Mi-1]=t},t.prototype.Ai=function(t){return v(0!==t.length,"plot rows should not be empty"),this.mi.clear(),this.pi.clear(),this.bi.clear(),this.vi=function(t,i){for(var e=function(t,i){for(var e=t.length,n=i.length,r=e+n,s=0,o=0;s<e&&o<n;)t[s].index<i[o].index?s++:t[s].index>i[o].index?o++:(s++,o++,r--);return r}(t,i),n=new Array(e),r=0,s=0,o=t.length,h=i.length,a=0;r<o&&s<h;)t[r].index<i[s].index?(n[a]=t[r],r++):t[r].index>i[s].index?(n[a]=i[s],s++):(n[a]=i[s],r++,s++),a++;for(;r<o;)n[a]=t[r],r++,a++;for(;s<h;)n[a]=i[s],s++,a++;return n}(this.vi,t),this.di=0,this.Mi=this.vi.length,t[0]},t.prototype.Ci=function(t,i,e){if(this.isEmpty())return null;var n=null,r=y(this.firstIndex()),s=y(this.lastIndex()),o=t-e.offset,h=i-e.offset;o=Math.max(o,r),h=Math.min(h,s);var a=30*Math.ceil(o/30),u=Math.max(a,30*Math.floor(h/30)),l=this.Si(o),c=this.Di(Math.min(h,a,i));n=Mi(n,this.Ii(l,c,e));var p=this.bi.get(e.name);void 0===p&&(p=new Map,this.bi.set(e.name,p));for(var f=Math.max(a+1,o);f<u;f+=30){var d=Math.floor(f/30),v=p.get(d);if(void 0===v){var m=this.Si(30*d),g=this.Di(30*(d+1)-1);v=this.Ii(m,g,e),p.set(d,v)}n=Mi(n,v)}return l=this.Si(u),c=this.Di(h),Mi(n,this.Ii(l,c,e))},t}();function Mi(t,i){return null===t?i:null===i?t:{min:Math.min(t.min,i.min),max:Math.max(t.max,i.max)}}!function(t){t[t.Open=0]="Open",t[t.High=1]="High",t[t.Low=2]="Low",t[t.Close=3]="Close",t[t.Color=4]="Color"}(Si||(Si={}));var xi={open:function(t){return t[0]},high:function(t){return t[1]},low:function(t){return t[2]},close:function(t){return t[3]},hl2:function(t){return(t[1]+t[2])/2},hlc3:function(t){return(t[1]+t[2]+t[3])/3},ohlc4:function(t){return(t[0]+t[1]+t[2]+t[3])/4}},Ci=["open","high","low","close","hl2","hlc3","ohlc4"];function Ti(t){return xi[t]}var ki,Pi=function(){function t(){var t;this.Ri=new wi((t=new Map,Ci.forEach((function(i,e){t.set(i,Ti(i))})),t))}return t.prototype.bars=function(){return this.Ri},t.prototype.size=function(){return this.Ri.size()},t.prototype.each=function(t){this.Ri.each(t)},t.prototype.clear=function(){this.Ri.clear()},t.prototype.isEmpty=function(){return this.Ri.isEmpty()},t.prototype.first=function(){return this.Ri.first()},t.prototype.last=function(){return this.Ri.last()},t.prototype.search=function(t,i){return this.bars().search(t,i)},t.prototype.valueAt=function(t){return this.search(t)},t}(),_i=function(t){function i(i,e,n){var r=t.call(this,i)||this;r.m=new Pi,r.ni=new pi(r),r.Wi=[],r.Ui=new Gt(r),r.qi=!1,r.ji=null,r.Hi=new yi,r.Yi=[],r.Ki=[],r.$=e,r.$i=n;var s=new fi(r,{model:i});return r.U=[s],r._i=new Jt(s,r,i),r.Xi(),r.Zi(),r.Ji=r.barFunction(),r.Gi(),r}return p(i,t),i.prototype.destroy=function(){},i.prototype.endOfData=function(){return this.qi},i.prototype.priceLineColor=function(t){return this.$.priceLineColor||t},i.prototype.lastValueData=function(t,i,e){var n={noData:!0},r=this.priceScale();if(this.model().timeScale().isEmpty()||r.isEmpty()||this.data().isEmpty())return n;var s,o,h=this.model().timeScale().visibleBars(),a=this.firstValue();if(null===h||null===a)return n;if(i){var u=this.data().bars().last();if(null===u)return n;s=u,o=u.index}else{var l=this.data().bars().search(h.lastBar(),-1);if(null===l)return n;if(null===(s=this.data().bars().valueAt(l.index)))return n;o=l.index}var c=void 0!==t?s.value[t]:this.Ji(s.value),p=this.barColorer().barStyle(o,{value:s}),f=r.priceToCoordinate(c,a.value);return{noData:!1,price:e?c:void 0,text:r.formatPrice(c,a.value),formattedPriceAbsolute:r.formatPriceAbsolute(c),formattedPricePercentage:r.formatPricePercentage(c,a.value),color:p.barColor,coordinate:f,index:o}},i.prototype.data=function(){return this.m},i.prototype.barColorer=function(){return null!==this.ji||(this.ji=new bi(this)),this.ji},i.prototype.options=function(){return this.$},i.prototype.applyOptions=function(t){var i=this.$.overlay;b(this.$,t),this.$.overlay=i,i&&null!==this._priceScale&&void 0!==t.scaleMargins&&this._priceScale.applyOptions({scaleMargins:this.$.scaleMargins}),void 0!==t.priceFormat&&this.Xi(),this.model().updateSource(this)},i.prototype.clearData=function(){this.m.clear(),this.Hi.clear(),this.Gi()},i.prototype.updateData=function(t,i){void 0===i&&(i=!1),i&&this.m.clear(),this.m.bars().merge(t),this.Qi(),this.J.update("data"),this._.update("data");var e=this.model().paneForSource(this);this.model().recalculatePane(e),this.model().updateSource(this),this.model().updateCrosshair(),this.model().lightUpdate()},i.prototype.setMarkers=function(t){this.Yi=t.map((function(t){return f({},t)})),this.Qi();var i=this.model().paneForSource(this);this._.update("data"),this.model().recalculatePane(i),this.model().updateSource(this),this.model().updateCrosshair(),this.model().lightUpdate()},i.prototype.markers=function(){return this.Yi},i.prototype.indexedMarkers=function(){return this.Ki},i.prototype.createPriceLine=function(t){var i=new mi(this,t);return this.Wi.push(i),this.model().updateSource(this),i},i.prototype.removePriceLine=function(t){var i=this.Wi.indexOf(t);-1!==i&&this.Wi.splice(i,1),this.model().updateSource(this)},i.prototype.palette=function(){return this.Hi},i.prototype.seriesType=function(){return this.$i},i.prototype.firstValue=function(){var t=this.firstBar();return null===t?null:{value:this.Ji(t.value),timePoint:t.time}},i.prototype.firstBar=function(){var t=this.model().timeScale().visibleBars();if(null===t)return null;var i=t.firstBar();return this.data().search(i,1)},i.prototype.bars=function(){return this.m.bars()},i.prototype.nearestIndex=function(t,i){var e=this.nearestData(t,i);return e?e.index:null},i.prototype.nearestData=function(t,i){return w(t)?this.data().search(t,i):null},i.prototype.dataAt=function(t){var i=this.data().valueAt(t);return null===i?null:"Bar"===this.$i||"Candlestick"===this.$i?{open:i.value[0],high:i.value[1],low:i.value[2],close:i.value[3]}:this.barFunction()(i.value)},i.prototype.paneViews=function(){var t=[];this.priceScale()===this.model().mainPriceScale()&&t.push(this.Ui);for(var i=0,e=this.Wi;i<e.length;i++){var n=e[i];t.push(n.paneView())}return t.push(this.J),t.push(this.ni),t.push(this._i),t.push(this._),t},i.prototype.priceAxisViews=function(t,i){for(var e=d(this.U),n=0,r=this.Wi;n<r.length;n++){var s=r[n];e.push(s.priceAxisView())}return e},i.prototype.autoscaleInfo=function(t,i){if(!w(t)||!w(i)||this.data().isEmpty())return null;var e,n="Line"===this.$i||"Area"===this.$i||"Histogram"===this.$i?"close":null,r=null!==(e=null!==n?this.data().bars().minMaxOnRangeCached(t,i,[{name:n,offset:0}]):this.data().bars().minMaxOnRangeCached(t,i,[{name:"low",offset:0},{name:"high",offset:0}]))?new ut(e.min,e.max):null;if("Histogram"===this.seriesType()){var s=this.$.base,o=new ut(s,s);r=null!==r?r.merge(o):o}return{priceRange:r,margins:this._.autoScaleMargins()}},i.prototype.minMove=function(){return this.$.priceFormat.minMove},i.prototype.formatter=function(){return this.tn},i.prototype.barFunction=function(){return this.Ji},i.prototype.updateAllViews=function(){this.J.update(),this._.update();for(var t=0,i=this.U;t<i.length;t++)i[t].update();for(var e=0,n=this.Wi;e<n.length;e++)n[e].update();this.ni.update(),this.Ui.update()},i.prototype.setPriceScale=function(t){this._priceScale!==t&&(this._priceScale=t)},i.prototype.priceScale=function(){return y(this._priceScale)},i.prototype.markerDataAtIndex=function(t){if("Line"!==this.$i&&"Area"!==this.$i||!this.$.crosshairMarkerVisible)return null;var i=this.m.valueAt(t);return null===i?null:{price:this.Ji(i.value),radius:this.in()}},i.prototype.title=function(){return this.$.title},i.prototype.in=function(){switch(this.$i){case"Line":case"Area":return this.$.crosshairMarkerRadius}return 0},i.prototype.Xi=function(){switch(this.$.priceFormat.type){case"custom":this.tn={format:this.$.priceFormat.formatter};break;case"volume":this.tn=new Ct(this.$.priceFormat.precision);break;case"percent":this.tn=new ot(this.$.priceFormat.precision);break;default:var t=Math.pow(10,this.$.priceFormat.precision);this.tn=new st(t,this.$.priceFormat.minMove*t,!1,void 0)}null!==this._priceScale&&this._priceScale.updateFormatter()},i.prototype.Zi=function(){this.Ji=Ti("close")},i.prototype.Qi=function(){var t=this.model().timeScale().points();this.Ki=this.Yi.map((function(i,e){return{time:y(t.indexOf(i.time.timestamp,!0)),position:i.position,shape:i.shape,color:i.color,id:i.id,internalId:e}}))},i.prototype.Gi=function(){switch(this._=new ci(this,this.model()),this.$i){case"Bar":this.J=new It(this,this.model());break;case"Candlestick":this.J=new $t(this,this.model());break;case"Line":this.J=new Ht(this,this.model());break;case"Area":this.J=new At(this,this.model());break;case"Histogram":this.J=new jt(this,this.model());break;default:throw Error("Unknown chart style assigned: "+this.$i)}},i}(at);function Ei(t){return t.slice().sort((function(t,i){return y(t.zorder())-y(i.zorder())}))}!function(t){t[t.Normal=0]="Normal",t[t.Logarithmic=1]="Logarithmic",t[t.Percentage=2]="Percentage",t[t.IndexedTo100=3]="IndexedTo100"}(ki||(ki={}));var Li,Ri,Vi,Fi=new ot,Di=new st(100,1),zi=function(){function t(t,i,e){this.nn=0,this.sn=null,this.hn=new ht,this.rn=null,this.un=null,this.en=new ht,this.on={isValid:!1,visibleBars:null},this.fn=0,this.an=0,this.cn=new ht,this.ln=new ht,this.vn=[],this.dn=null,this.Mn=!1,this.wn=null,this.bn=null,this.mn=null,this.pn=null,this.tn=Di,this.gn=new ht,this.$=t,this.yn=i,this.kn=e,this.Nn=new xt(this,100,this.Sn.bind(this),this.xn.bind(this))}return t.prototype.options=function(){return this.$},t.prototype.applyOptions=function(t){if(b(this.$,t),this.updateFormatter(),void 0!==t.mode&&this.setMode({mode:t.mode}),this.gn.fire(),void 0!==t.scaleMargins){var i=m(t.scaleMargins.top),e=m(t.scaleMargins.bottom);if(i<0||i>1)throw new Error("Invalid top margin - expect value between 0 and 1, given="+i);if(e<0||e>1||i+e>1)throw new Error("Invalid bottom margin - expect value between 0 and 1, given="+e);if(i+e>1)throw new Error("Invalid margins - sum of margins must be less than 1, given="+(i+e));this.Dn(),this.bn=null}},t.prototype.optionsChanged=function(){return this.gn},t.prototype.isAutoScale=function(){return this.$.autoScale},t.prototype.isLog=function(){return 1===this.$.mode},t.prototype.isPercentage=function(){return 2===this.$.mode},t.prototype.isIndexedTo100=function(){return 3===this.$.mode},t.prototype.mode=function(){return{autoScale:this.$.autoScale,isInverted:this.$.invertScale,mode:this.$.mode}},t.prototype.setMode=function(t){var i=this.mode(),e=null;void 0!==t.autoScale&&(this.$.autoScale=t.autoScale),void 0!==t.mode&&(this.$.mode=t.mode,2!==t.mode&&3!==t.mode||(this.$.autoScale=!0),this.on.isValid=!1),1===i.mode&&t.mode!==i.mode&&(function(t){if(null===t)return!1;var i=St(t.minValue()),e=St(t.maxValue());return isFinite(i)&&isFinite(e)}(this.rn)?null!==(e=function(t){if(null===t)return null;var i=St(t.minValue()),e=St(t.maxValue());return new ut(i,e)}(this.rn))&&this.setPriceRange(e):this.$.autoScale=!0),1===t.mode&&t.mode!==i.mode&&null!==(e=wt(this.rn))&&this.setPriceRange(e);var n=i.mode!==this.$.mode;n&&(2===i.mode||this.isPercentage())&&this.updateFormatter(),n&&(3===i.mode||this.isIndexedTo100())&&this.updateFormatter(),void 0!==t.isInverted&&i.isInverted!==t.isInverted&&(this.$.invertScale=t.isInverted,this.Cn()),this.ln.fire(i,this.mode())},t.prototype.modeChanged=function(){return this.ln},t.prototype.fontSize=function(){return this.yn.fontSize},t.prototype.height=function(){return this.nn},t.prototype.setHeight=function(t){this.nn!==t&&(this.nn=t,this.Dn(),this.bn=null)},t.prototype.internalHeight=function(){if(this.sn)return this.sn;var t=this.height()-this.Tn()-this.En();return this.sn=t,t},t.prototype.internalHeightChanged=function(){return this.hn},t.prototype.priceRange=function(){return this.Ln(),this.rn},t.prototype.priceRangeChanged=function(){return this.en},t.prototype.setPriceRange=function(t,i,e){var n=this.rn;(i||null===n&&null!==t||null!==n&&!n.equals(t))&&(this.bn=null,this.rn=t,e||this.en.fire(n,t))},t.prototype.isEmpty=function(){return this.Ln(),0===this.nn||!this.rn||this.rn.isEmpty()},t.prototype.invertedCoordinate=function(t){return this.isInverted()?t:this.height()-1-t},t.prototype.priceToCoordinate=function(t,i){return this.isPercentage()?t=vt(t,i):this.isIndexedTo100()&&(t=yt(t,i)),this.xn(t,i)},t.prototype.pointsArrayToCoordinates=function(t,i,e){this.Ln();for(var n=this.En(),r=y(this.priceRange()),s=r.minValue(),o=r.maxValue(),h=this.internalHeight()-1,a=this.isInverted(),u=h/(o-s),l=void 0===e?0:e.from,c=void 0===e?t.length:e.to,p=this.An(),f=l;f<c;f++){var d=t[f],v=d.price;if(!isNaN(v)){var m=v;null!==p&&(m=p(d.price,i));var g=n+u*(m-s),b=a?g:this.nn-1-g;d.y=b}}},t.prototype.barPricesToCoordinates=function(t,i,e){this.Ln();for(var n=this.En(),r=y(this.priceRange()),s=r.minValue(),o=r.maxValue(),h=this.internalHeight()-1,a=this.isInverted(),u=h/(o-s),l=void 0===e?0:e.from,c=void 0===e?t.length:e.to,p=this.An(),f=l;f<c;f++){var d=t[f],v=d.open,m=d.high,g=d.low,b=d.close;null!==p&&(v=p(d.open,i),m=p(d.high,i),g=p(d.low,i),b=p(d.close,i));var S=n+u*(v-s),w=a?S:this.nn-1-S;d.openY=w,S=n+u*(m-s),w=a?S:this.nn-1-S,d.highY=w,S=n+u*(g-s),w=a?S:this.nn-1-S,d.lowY=w,S=n+u*(b-s),w=a?S:this.nn-1-S,d.closeY=w}},t.prototype.coordinateToPrice=function(t,i){var e=this.Sn(t,i);return this.logicalToPrice(e,i)},t.prototype.logicalToPrice=function(t,i){var e=t;return this.isPercentage()?e=function(t,i){return i<0&&(t=-t),t/100*i+i}(e,i):this.isIndexedTo100()&&(e=function(t,i){return t-=100,i<0&&(t=-t),t/100*i+i}(e,i)),e},t.prototype.dataSources=function(){return this.vn},t.prototype.orderedSources=function(){if(this.dn)return this.dn;for(var t=[],i=0;i<this.vn.length;i++){var e=this.vn[i];null===e.zorder()&&e.setZorder(i+1),t.push(e)}return t=Ei(t),this.dn=t,this.dn},t.prototype.hasSeries=function(){return this.Mn},t.prototype.addDataSource=function(t){-1===this.vn.indexOf(t)&&(t instanceof _i&&(this.Mn=!0),this.vn.push(t),this.wn=null,this.updateFormatter(),this.invalidateSourcesCache())},t.prototype.removeDataSource=function(t){var i=this.vn.indexOf(t);if(-1===i)throw new Error("source is not attached to scale");this.vn.splice(i,1),t instanceof _i&&(this.Mn=!1),this.mainSource()||this.setMode({autoScale:!0}),this.wn=null,this.updateFormatter(),this.invalidateSourcesCache()},t.prototype.mainSource=function(){if(null!==this.wn)return this.wn;for(var t=null,i=0;i<this.vn.length;i++){var e=this.vn[i];if(e instanceof _i){t=e;break}null===t&&e instanceof at&&(t=e)}return this.wn=t,this.wn},t.prototype.firstValue=function(){for(var t=null,i=0,e=this.vn;i<e.length;i++){var n=e[i];if(n instanceof at){var r=n.firstValue();if(null===r)continue;(null===t||r.timePoint<t.timePoint)&&(t=r)}}return null===t?null:t.value},t.prototype.isInverted=function(){return this.$.invertScale},t.prototype.marks=function(){return this.bn||(this.Nn.rebuildTickMarks(),this.bn=this.Nn.marks(),this.cn.fire()),this.bn},t.prototype.onMarksChanged=function(){return this.cn},t.prototype.startScale=function(t){this.isPercentage()||this.isIndexedTo100()||null===this.mn&&null===this.un&&(this.isEmpty()||(this.mn=this.nn-t,this.un=y(this.priceRange()).clone()))},t.prototype.scaleTo=function(t){if(!this.isPercentage()&&!this.isIndexedTo100()&&null!==this.mn){this.setMode({autoScale:!1}),(t=this.nn-t)<0&&(t=0);var i=(this.mn+.2*(this.nn-1))/(t+.2*(this.nn-1)),e=y(this.un).clone();i=Math.max(i,.1),e.scaleAroundCenter(i),this.setPriceRange(e)}},t.prototype.endScale=function(){this.isPercentage()||this.isIndexedTo100()||(this.mn=null,this.un=null)},t.prototype.startScroll=function(t){this.isAutoScale()||null===this.pn&&null===this.un&&(this.isEmpty()||(this.pn=t,this.un=y(this.priceRange()).clone()))},t.prototype.scrollTo=function(t){if(!this.isAutoScale()&&null!==this.pn){var i=y(this.priceRange()).length()/(this.internalHeight()-1),e=t-this.pn;this.isInverted()&&(e*=-1);var n=e*i,r=y(this.un).clone();r.shift(n),this.setPriceRange(r,!0),this.bn=null}},t.prototype.endScroll=function(){this.isAutoScale()||null!==this.pn&&(this.pn=null,this.un=null)},t.prototype.formatter=function(){return this.tn||this.updateFormatter(),this.tn},t.prototype.formatPrice=function(t,i){switch(this.$.mode){case 2:return this.formatter().format(vt(t,i));case 3:return this.formatter().format(yt(t,i));default:return this.Bn(t)}},t.prototype.formatLogical=function(t){switch(this.$.mode){case 2:case 3:return this.formatter().format(t);default:return this.Bn(t)}},t.prototype.formatPriceAbsolute=function(t){return this.Bn(t,this.zn())},t.prototype.formatPricePercentage=function(t,i){return t=vt(t,i),Fi.format(t)},t.prototype.sourcesForAutoScale=function(){return this.vn.filter((function(t){return t instanceof at}))},t.prototype.recalculatePriceRange=function(t){this.on={visibleBars:t,isValid:!1}},t.prototype.updateAllViews=function(){this.vn.forEach((function(t){return t.updateAllViews()}))},t.prototype.updateFormatter=function(){this.bn=null;var t=this.mainSource(),i=100;null!==t&&(i=Math.round(1/t.minMove())),this.tn=Di,this.isPercentage()?(this.tn=Fi,i=100):this.isIndexedTo100()?(this.tn=new st(100,1),i=100):null!==t&&(this.tn=t.formatter()),this.Nn=new xt(this,i,this.Sn.bind(this),this.xn.bind(this)),this.Nn.rebuildTickMarks()},t.prototype.invalidateSourcesCache=function(){this.dn=null},t.prototype.Tn=function(){return this.isInverted()?this.$.scaleMargins.bottom*this.height()+this.an:this.$.scaleMargins.top*this.height()+this.fn},t.prototype.En=function(){return this.isInverted()?this.$.scaleMargins.top*this.height()+this.fn:this.$.scaleMargins.bottom*this.height()+this.an},t.prototype.Ln=function(){this.on.isValid||(this.on.isValid=!0,this.Vn())},t.prototype.Dn=function(){this.sn=null,this.hn.fire()},t.prototype.xn=function(t,i){if(this.Ln(),this.isEmpty())return 0;t=this.isLog()&&t?bt(t):t;var e=y(this.priceRange()),n=this.En()+(this.internalHeight()-1)*(t-e.minValue())/e.length();return this.invertedCoordinate(n)},t.prototype.Sn=function(t,i){if(this.Ln(),this.isEmpty())return 0;var e=this.invertedCoordinate(t),n=y(this.priceRange()),r=n.minValue()+n.length()*((e-this.En())/(this.internalHeight()-1));return this.isLog()?St(r):r},t.prototype.Cn=function(){this.bn=null,this.Nn.rebuildTickMarks()},t.prototype.zn=function(){return y(this.mainSource()).formatter()},t.prototype.Vn=function(){var t=this.on.visibleBars;if(null!==t){for(var i=null,e=0,n=0,r=0,s=this.sourcesForAutoScale();r<s.length;r++){var o=s[r],h=o.firstValue();if(null!==h){var a=o.autoscaleInfo(t.firstBar(),t.lastBar()),u=a&&a.priceRange;if(null!==u){switch(this.$.mode){case 1:u=wt(u);break;case 2:u=mt(u,h.value);break;case 3:u=gt(u,h.value)}i=null===i?u:i.merge(y(u)),null!==a&&null!==a.margins&&(e=Math.max(e,a.margins.above),n=Math.max(e,a.margins.below))}}}if(e===this.fn&&n===this.an||(this.fn=e,this.an=n,this.bn=null,this.Dn()),null!==i){if(i.minValue()===i.maxValue()){var l=this.mainSource(),c=5*(null===l||this.isPercentage()||this.isIndexedTo100()?1:l.minMove());i=new ut(i.minValue()-c,i.maxValue()+c)}this.setPriceRange(i)}else null===this.rn&&this.setPriceRange(new ut(-.5,.5));this.on.isValid=!0}},t.prototype.An=function(){return this.isPercentage()?vt:this.isIndexedTo100()?yt:this.isLog()?bt:null},t.prototype.Bn=function(t,i){return void 0===this.kn.priceFormatter?(void 0===i&&(i=this.formatter()),i.format(t)):this.kn.priceFormatter(t)},t}();function Ai(t){void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor)}function Oi(t){return!S(t)&&!M(t)}function Bi(t){return S(t)}function Ii(t,i,e){return void 0!==e?e+=" ":e="",void 0===i&&(i="'Trebuchet MS', Roboto, Ubuntu, sans-serif"),""+e+t+"px "+i}!function(t){t[t.LastPriceAndPercentageValue=0]="LastPriceAndPercentageValue",t[t.LastValueAccordingToScale=1]="LastValueAccordingToScale"}(Li||(Li={})),function(t){t[t.LastBar=0]="LastBar",t[t.LastVisible=1]="LastVisible"}(Ri||(Ri={})),function(t){t[t.BorderSize=1]="BorderSize",t[t.TickLength=4]="TickLength"}(Vi||(Vi={}));var Ni,$i=function(){function t(t){this.Ht={borderSize:1,tickLength:4,fontSize:NaN,font:"",fontFamily:"",color:"",paddingBottom:0,paddingInner:0,paddingOuter:0,paddingTop:0,baselineOffset:0},this.l=t}return t.prototype.options=function(){var t=this.Ht,i=this.Zt(),e=this.Fn();return t.fontSize===i&&t.fontFamily===e||(t.fontSize=i,t.fontFamily=e,t.font=Ii(i,e),t.paddingTop=Math.floor(i/3.5),t.paddingBottom=t.paddingTop,t.paddingInner=Math.max(Math.ceil(i/2-t.tickLength/2),0),t.paddingOuter=Math.ceil(i/2+t.tickLength/2),t.baselineOffset=Math.round(i/10)),t.color=this.Pn(),this.Ht},t.prototype.Pn=function(){return this.l.options().layout.textColor},t.prototype.Zt=function(){return this.l.options().layout.fontSize},t.prototype.Fn=function(){return this.l.options().layout.fontFamily},t}(),Wi=function(){function t(){this.m=null}return t.prototype.setData=function(t){this.m=t},t.prototype.draw=function(t,i,e,n){var r=this;if(null!==this.m){var s=Math.floor(i);t.lineWidth=s;var o=Math.ceil(this.m.h*i),h=Math.ceil(this.m.w*i);!function(t,i){t.save(),t.lineWidth%2&&t.translate(.5,.5),i(),t.restore()}(t,(function(){var e=y(r.m);if(e.vertLinesVisible){t.strokeStyle=e.vertLinesColor,u(t,e.vertLineStyle),t.beginPath();for(var n=0,a=e.timeMarks;n<a.length;n++){var l=a[n],c=Math.round(l.coord*i);t.moveTo(c,-s),t.lineTo(c,o+s)}t.stroke()}if(e.horzLinesVisible){t.strokeStyle=e.horzLinesColor,u(t,e.horzLineStyle),t.beginPath();for(var p=0,f=e.priceMarks;p<f.length;p++){var d=f[p],v=Math.round(d.coord*i);t.moveTo(-s,v),t.lineTo(h+s,v)}t.stroke()}}))}},t}(),Ui=function(){function t(t){this.g=new Wi,this.o=!0,this.I=t}return t.prototype.update=function(){this.o=!0},t.prototype.renderer=function(t,i){if(this.o){var e=this.I.model().options().grid,n={h:t,w:i,horzLinesVisible:e.horzLines.visible,vertLinesVisible:e.vertLines.visible,horzLinesColor:e.horzLines.color,vertLinesColor:e.vertLines.color,horzLineStyle:e.horzLines.style,vertLineStyle:e.vertLines.style,priceMarks:this.I.defaultPriceScale().marks(),timeMarks:this.I.model().timeScale().marks()||[]};this.g.setData(n),this.o=!1}return this.g},t}(),Yi=function(){function t(){this.In=new WeakMap,this.o=!0}return t.prototype.paneViews=function(t){var i=this.In.get(t);return void 0===i&&(i=[new Ui(t)],this.In.set(t,i)),this.o&&(i.forEach((function(t){return t.update()})),this.o=!1),i},t.prototype.invalidate=function(){this.o=!0},t}();!function(t){t[t.None=0]="None",t[t.Cursor=1]="Cursor",t[t.Light=2]="Light",t[t.Full=3]="Full"}(Ni||(Ni={}));var ji=function(){function t(t){this.On=new Map,this.Rn=!1,this.Wn=!1,this.Un=null,this.qn=t}return t.prototype.invalidatePane=function(t,i){var e=function(t,i){return void 0===t?i:{level:Math.max(t.level,i.level),autoScale:t.autoScale||i.autoScale}}(this.On.get(t),i);this.On.set(t,e)},t.prototype.invalidateAll=function(t){this.qn=Math.max(this.qn,t)},t.prototype.fullInvalidation=function(){return this.qn},t.prototype.invalidateForPane=function(t){var i=this.On.get(t);return void 0===i?{level:this.qn}:{level:Math.max(this.qn,i.level),autoScale:i.autoScale}},t.prototype.setFitContent=function(){this.Wn=!0,this.Un=null},t.prototype.getFitContent=function(){return this.Wn},t.prototype.setTargetTimeRange=function(t){this.Un=t,this.Wn=!1},t.prototype.getTargetTimeRange=function(){return this.Un},t.prototype.merge=function(t){var i=this;this.Rn=this.Rn||t.Rn,t.Wn&&this.setFitContent(),t.Un&&this.setTargetTimeRange(t.Un),this.qn=Math.max(this.qn,t.qn),t.On.forEach((function(t,e){i.invalidatePane(e,t)}))},t}(),Hi=function(){function t(t){this.$=t}return t.prototype.align=function(t,i,e){var n=t;if(0===this.$.mode)return n;var r=e.defaultPriceScale(),s=r.firstValue();if(null===s)return n;var o=r.priceToCoordinate(t,s),h=e.dataSources().filter((function(t){return t instanceof _i})).reduce((function(t,n){if(e.isOverlay(n))return t;var r=n.priceScale(),s=n.bars();if(r.isEmpty()||!s.contains(i))return t;var o=s.valueAt(i);if(null===o)return t;var h=[o.value[3]],a=g(n.firstValue());return t.concat(h.map((function(t){return r.priceToCoordinate(t,a.value)})))}),[]);if(0===h.length)return n;h.sort((function(t,i){return Math.abs(t-o)-Math.abs(i-o)}));var a=h[0];return r.coordinateToPrice(a,s)},t}(),qi=function(){function t(t,i){this.vn=[],this.jn=[],this.nn=0,this.Kt=0,this.Hn=1e3,this.Yn=null,this.dn=null,this.Kn=new ht,this.$n=t,this.F=i,this.model().mainPriceScaleOptionsChanged().subscribe(this.onPriceScaleOptionsChanged.bind(this),this),this._n=this.Xn()}return t.prototype.onPriceScaleOptionsChanged=function(){this._n.applyOptions(this.F.options().priceScale)},t.prototype.destroy=function(){this.model().mainPriceScaleOptionsChanged().unsubscribeAll(this),this._n.modeChanged().unsubscribeAll(this),this.vn.forEach((function(t){t.destroy&&t.destroy()})),this.Kn.fire()},t.prototype.stretchFactor=function(){return this.Hn},t.prototype.setStretchFactor=function(t){this.Hn=t},t.prototype.model=function(){return this.F},t.prototype.width=function(){return this.Kt},t.prototype.height=function(){return this.nn},t.prototype.setWidth=function(t){this.Kt=t,this.updateAllViews()},t.prototype.setHeight=function(t){var i=this;this.nn=t,this._n.setHeight(t),this.vn.forEach((function(e){if(i.isOverlay(e)){var n=e.priceScale();null!==n&&n.setHeight(t)}})),this.updateAllViews()},t.prototype.dataSources=function(){return this.vn},t.prototype.isOverlay=function(t){var i=t.priceScale();return null===i||this._n!==i},t.prototype.addDataSource=function(t,i,e){var n=this.Zn().minZOrder-1;this.Jn(t,i,n)},t.prototype.removeDataSource=function(t){var i=this.vn.indexOf(t);v(-1!==i,"removeDataSource: invalid data source"),this.vn.splice(i,1),t===this.Yn&&(this.Yn=null);var e=this.jn.indexOf(t);-1!==e&&this.jn.splice(e,1);var n=t.priceScale();if(n&&n.dataSources().indexOf(t)>=0&&n.removeDataSource(t),n&&null===n.mainSource()){var r=n.dataSources().length;v(0===r,"Invalid priceScale state: empty mainSource but non-empty data sources="+r),n!==this._n&&n.modeChanged().unsubscribeAll(this)}t instanceof at&&this.Gn(),n&&t instanceof at&&(n.invalidateSourcesCache(),this.recalculatePriceScale(n)),this.dn=null},t.prototype.priceScalePosition=function(){var t=this.F.options().priceScale.position;return"none"===t?"overlay":t},t.prototype.startScalePrice=function(t,i){t.startScale(i)},t.prototype.scalePriceTo=function(t,i){t.scaleTo(i),this.updateAllViews()},t.prototype.endScalePrice=function(t){t.endScale()},t.prototype.startScrollPrice=function(t,i){t.startScroll(i)},t.prototype.scrollPriceTo=function(t,i){t.scrollTo(i),this.updateAllViews()},t.prototype.endScrollPrice=function(t){t.endScroll()},t.prototype.setPriceAutoScale=function(t,i){t.setMode({autoScale:i}),this.$n.isEmpty()?t.setPriceRange(null):this.recalculatePriceScale(t)},t.prototype.updateAllViews=function(){this.vn.forEach((function(t){t.updateAllViews()}))},t.prototype.defaultPriceScale=function(){var t=this.mainDataSource(),i=null!==t?t.priceScale():null;return null===i&&(i=this._n),i},t.prototype.mainDataSource=function(){return this.Yn},t.prototype.recalculatePriceScale=function(t){null!==t&&t.isAutoScale()&&this.Qn(t)},t.prototype.resetPriceScale=function(t){var i=this.$n.visibleBars();t.setMode({autoScale:!0}),null!==i&&t.recalculatePriceRange(i),this.updateAllViews()},t.prototype.momentaryAutoScale=function(){this.Qn(this._n)},t.prototype.recalculate=function(){var t=this;this.recalculatePriceScale(this._n),this.vn.forEach((function(i){t.isOverlay(i)&&t.recalculatePriceScale(i.priceScale())})),this.updateAllViews(),this.F.lightUpdate()},t.prototype.isEmpty=function(){return null===this.Yn},t.prototype.containsSeries=function(){return this.vn.some((function(t){return t instanceof _i}))},t.prototype.orderedSources=function(){return null===this.dn&&(this.dn=Ei(this.vn)),this.dn},t.prototype.onDestroyed=function(){return this.Kn},t.prototype.ts=function(t,i){return"overlay"!==i?this._n:this.Xn(!0)},t.prototype.Qn=function(t){var i=t.sourcesForAutoScale();if(i&&i.length>0&&!this.$n.isEmpty()){var e=this.$n.visibleBars();null!==e&&t.recalculatePriceRange(e)}t.updateAllViews()},t.prototype.Zn=function(){var t=this.orderedSources();if(0===t.length)return{minZOrder:0,maxZOrder:0};for(var i=0,e=0,n=0;n<t.length;n++){var r=t[n].zorder();null!==r&&(r<i&&(i=r),r>e&&(e=r))}return{minZOrder:i,maxZOrder:e}},t.prototype.Jn=function(t,i,e){var n="overlay",r=null;if(!i){var s=this.model().options().priceScale.position;n="none"===s?"overlay":s}t instanceof at&&(r=this.ts(t,n)),this.vn.push(t),i&&this.jn.push(t),null!==r&&(r.addDataSource(t),t.setPriceScale(r)),t.setZorder(e),this.Gn(),t instanceof at&&this.recalculatePriceScale(r),this.dn=null},t.prototype.ns=function(t,i,e){i.mode!==e.mode&&this.Qn(t)},t.prototype.Gn=function(){if(null===this.Yn||-1!==this.jn.indexOf(this.Yn)){for(var t=0,i=this.vn;t<i.length;t++)if((r=i[t])instanceof at&&!this.isOverlay(r))return void this.ss(r);for(var e=0,n=this.jn;e<n.length;e++){var r;if((r=n[e])instanceof at)return void this.ss(r)}}},t.prototype.ss=function(t){var i=y(t.priceScale());this.defaultPriceScale().modeChanged().unsubscribeAll(this),i.modeChanged().subscribe(this.ns.bind(this,i),this),this.Yn=t},t.prototype.Xn=function(t){var i=T(this.F.options().priceScale);t&&(i.autoScale=!0,i.mode=0);var e=new zi(i,this.F.options().layout,this.F.options().localization);return e.setHeight(this.height()),e},t}(),Ki=function(t){return t.getUTCFullYear()},Xi=function(t){return nt(function(t){return t.getUTCDate()}(t),2)},Ji=function(t,i){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"long"})},Zi=function(t,i){return new Date(t.getUTCFullYear(),t.getUTCMonth(),1).toLocaleString(i,{month:"short"})},Qi=function(t){return nt(function(t){return t.getUTCMonth()+1}(t),2)},Gi=function(t){return nt(Ki(t)%100,2)},te=function(t){return nt(Ki(t),4)},ie={"'yy MMM dd":function(t,i){return"'"+Gi(t)+" "+Zi(t,i)+" "+Xi(t)},"'yy MMMM dd":function(t,i){return"'"+Gi(t)+" "+Ji(t,i)+" "+Xi(t)},"yyyy MMM dd":function(t,i){return te(t)+" "+Zi(t,i)+" "+Xi(t)},"yyyy MMMM dd":function(t,i){return te(t)+" "+Ji(t,i)+" "+Xi(t)},"dd MMM 'yy":function(t,i){return Xi(t)+" "+Zi(t,i)+" '"+Gi(t)},"dd MMMM 'yy":function(t,i){return Xi(t)+" "+Ji(t,i)+" '"+Gi(t)},"dd MMM yyyy":function(t,i){return Xi(t)+" "+Zi(t,i)+" "+te(t)},"dd MMMM yyyy":function(t,i){return Xi(t)+" "+Ji(t,i)+" "+te(t)},"MMM dd, 'yy":function(t,i){return Zi(t,i)+" "+Xi(t)+", '"+Gi(t)},"MMMM dd, 'yy":function(t,i){return Ji(t,i)+" "+Xi(t)+", '"+Gi(t)},"MMM dd, yyyy":function(t,i){return Zi(t,i)+" "+Xi(t)+", "+te(t)},"MMMM dd, yyyy":function(t,i){return Ji(t,i)+" "+Xi(t)+", "+te(t)},"yyyy-MM-dd":function(t,i){return te(t)+"-"+Qi(t)+"-"+Xi(t)},"yy-MM-dd":function(t,i){return Gi(t)+"-"+Qi(t)+"-"+Xi(t)},"yy/MM/dd":function(t,i){return Gi(t)+"/"+Qi(t)+"/"+Xi(t)},"yyyy/MM/dd":function(t,i){return te(t)+"/"+Qi(t)+"/"+Xi(t)},"yy.MM.dd":function(t,i){return Gi(t)+"."+Qi(t)+"."+Xi(t)},"yyyy.MM.dd":function(t,i){return te(t)+"."+Qi(t)+"."+Xi(t)},"dd-MM-yyyy":function(t,i){return Xi(t)+"-"+Qi(t)+"-"+te(t)},"dd-MM-yy":function(t,i){return Xi(t)+"-"+Qi(t)+"-"+Gi(t)},"dd/MM/yy":function(t,i){return Xi(t)+"/"+Qi(t)+"/"+Gi(t)},"dd/MM/yyyy":function(t,i){return Xi(t)+"/"+Qi(t)+"/"+te(t)},"dd.MM.yy":function(t,i){return Xi(t)+"."+Qi(t)+"."+Gi(t)},"dd.MM.yyyy":function(t,i){return Xi(t)+"."+Qi(t)+"."+te(t)},"MM-dd-yy":function(t,i){return Qi(t)+"-"+Xi(t)+"-"+Gi(t)},"MM-dd-yyyy":function(t,i){return Qi(t)+"-"+Xi(t)+"-"+te(t)},"MM/dd/yy":function(t,i){return Qi(t)+"/"+Xi(t)+"/"+Gi(t)},"MM/dd/yyyy":function(t,i){return Qi(t)+"/"+Xi(t)+"/"+te(t)},"MM.dd.yy":function(t,i){return Qi(t)+"."+Xi(t)+"."+Gi(t)},"MM.dd.yyyy":function(t,i){return Qi(t)+"."+Xi(t)+"."+te(t)}},ee=function(){function t(t,i){void 0===t&&(t="yyyy-MM-dd"),void 0===i&&(i="default"),this.hs=ie[t],this.rs=i}return t.prototype.format=function(t){return this.hs(t,this.rs)},t}(),ne=function(){function t(t){this.us=t||"%h:%m:%s"}return t.prototype.format=function(t){return this.us.replace("%h",nt(t.getUTCHours(),2)).replace("%m",nt(t.getUTCMinutes(),2)).replace("%s",nt(t.getUTCSeconds(),2))},t}(),re={dateFormat:"yyyy-MM-dd",timeFormat:"%h:%m:%s",dateTimeSeparator:" ",locale:"default"},se=function(){function t(t){void 0===t&&(t={});var i=f(f({},re),t);this.es=new ee(i.dateFormat,i.locale),this.os=new ne(i.timeFormat),this.fs=i.dateTimeSeparator}return t.prototype.format=function(t){return""+this.es.format(t)+this.fs+this.os.format(t)},t}(),oe=function(){function t(t,i){v(t<=i,"The last bar in the bars range should be greater than or equal to the first bar"),this.as=t,this.cs=i}return t.prototype.firstBar=function(){return this.as},t.prototype.lastBar=function(){return this.cs},t.prototype.count=function(){return this.cs-this.as+1},t.prototype.contains=function(t){return this.as<=t&&t<=this.cs},t.prototype.equals=function(t){return this.as===t.firstBar()&&this.cs===t.lastBar()},t}(),he=function(){function t(t,i){void 0===i&&(i=50),this.It=0,this.Ot=1,this.Rt=1,this.Ut=new Map,this.Wt=new Map,this.ls=t,this.qt=i}return t.prototype.format=function(t){var i=this.Ut.get(t.valueOf());if(void 0!==i)return i.string;if(this.It===this.qt){var e=this.Wt.get(this.Rt);this.Wt.delete(this.Rt),this.Ut.delete(m(e)),this.Rt++,this.It--}var n=this.ls(t);return this.Ut.set(t.valueOf(),{string:n,tick:this.Ot}),this.Wt.set(this.Ot,t.valueOf()),this.It++,this.Ot++,n},t}();function ae(t,i){return t.index-i.index}var ue,le,ce=function(){function t(){this.vs=1/0,this.ds=-1/0,this.Ms=new Map,this.ws=[],this.bs=new ht,this.Ut=null,this.ms=NaN}return t.prototype.reset=function(){this.Ms.clear(),this.ws=[],this.vs=1/0,this.ds=-1/0,this.Ut=null,this.bs.fire()},t.prototype.merge=function(t){for(var i=this.ws,e={},n=0,r=t;n<r.length;n++){var s=r[n],o=s.index,h=s.span,a=this.Ms.get(s.index);if(a){if(a.index===s.index&&a.span===s.span){a.time=s.time;continue}this.ps(a)}this.Ms.set(o,s),this.vs>o&&(this.vs=o),this.ds<o&&(this.ds=o),void 0===(u=i[h])&&(u=[],i[h]=u),u.push(s),e[h]=!0}for(h=i.length;h--;){var u;void 0!==(u=i[h])&&(0===u.length&&delete i[h],e[h]&&u.sort(ae))}this.Ut=null,this.bs.fire()},t.prototype.indexToTime=function(t){var i=this.Ms.get(t);return void 0===i?null:i.time},t.prototype.nearestIndex=function(t){for(var i=this.vs,e=this.ds;e-i>2;){if(1e3*m(this.Ms.get(i)).time.timestamp===t)return i;if(1e3*m(this.Ms.get(e)).time.timestamp===t)return e;var n=Math.round((i+e)/2);1e3*m(this.Ms.get(n)).time.timestamp>t?e=n:i=n}return i},t.prototype.build=function(t,i){var e=Math.ceil(i/t);if(this.ms===e&&this.Ut)return this.Ut;this.ms=e;for(var n=[],r=this.ws.length;r--;)if(this.ws[r]){var s=n;n=[];for(var o=s.length,h=0,a=m(this.ws[r]),u=a.length,l=1/0,c=-1/0,p=0;p<u;p++){for(var f=a[p],d=f.index;h<o;){var v=s[h],y=v.index;if(!(y<d)){l=y;break}h++,n.push(v),c=y,l=1/0}l-d>=e&&d-c>=e&&(n.push(f),c=d)}for(;h<o;h++)n.push(s[h])}return this.Ut=n,this.Ut},t.prototype.ps=function(t){var i=t.index;if(this.Ms.get(i)===t){this.Ms.delete(i),i<=this.vs&&this.vs++,i>=this.ds&&this.ds--,this.ds<this.vs&&(this.vs=1/0,this.ds=-1/0);var e=m(this.ws[t.span]),n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t}(),pe=function(){function t(){this.vi=[]}return t.prototype.clear=function(){this.vi=[]},t.prototype.size=function(){return this.vi.length},t.prototype.firstIndex=function(){return this.gs(0)},t.prototype.lastIndex=function(){return this.gs(this.vi.length-1)},t.prototype.merge=function(t,i){if(0!==i.length)if(0!==this.vi.length){var e=t;if(e<0){var n=Math.abs(e);if(i.length<n)return;this.vi=new Array(n).concat(this.vi);for(var r=0;r<i.length;++r)this.vi[t+r]=i[r]}else{for(var s=e;s<this.vi.length&&s-e<i.length;++s)this.vi[s]=i[s-e];var o=e+i.length;if(o>this.vi.length){n=o-this.vi.length;for(var h=s;h<s+n;++h)this.vi.push(i[h-e])}}}else this.vi=i},t.prototype.valueAt=function(t){var i=this.ys(t);return null!==i?this.vi[i]:null},t.prototype.indexOf=function(t,i){if(this.vi.length<1)return null;if(t>this.vi[this.vi.length-1].timestamp)return i?this.vi.length-1:null;for(var e=0;e<this.vi.length;++e){if(t===this.vi[e].timestamp)return e;if(t<this.vi[e].timestamp)return i?e:null}return null},t.prototype.closestIndexLeft=function(t){var i=this.vi;if(!i.length)return null;if(Number.isNaN(t.timestamp))return null;var e=i.length-1;if(t>=i[e])return e;var n=0,r=i[n];if(t<r)return null;if(t===r)return n;for(;e>n+1;){var s=n+e>>1,o=i[s];if(o.timestamp>t.timestamp)e=s;else{if(!(o.timestamp<t.timestamp))return o.timestamp===t.timestamp?s:null;n=s}}return n},t.prototype.gs=function(t){return 0<=t&&t<this.size()?t:null},t.prototype.ys=function(t){return 0<=t&&t<this.size()?t:null},t}();!function(t){t[t.DefaultAnimationDuration=400]="DefaultAnimationDuration",t[t.MinBarSpacing=.5]="MinBarSpacing",t[t.MinVisibleBarsCount=2]="MinVisibleBarsCount"}(ue||(ue={})),function(t){t[t.Minute=20]="Minute",t[t.Hour=30]="Hour",t[t.Day=40]="Day",t[t.Week=50]="Week",t[t.Month=60]="Month",t[t.Year=70]="Year"}(le||(le={}));var fe=function(){function t(t,i,e){this.Kt=0,this.ks=null,this.Ns=new pe,this.pn=null,this.mn=null,this.Ss=new ce,this.xs=new Map,this.Ds=null,this.Cs=!0,this.Ts=new ht,this.Es=new ht,this.Ls=null,this.As=null,this.Bs=null,this.zs=[],this.$=i,this.kn=e,this.Vs=i.rightOffset,this.Fs=i.barSpacing,this.F=t,this.Ps()}return t.prototype.options=function(){return this.$},t.prototype.applyLocalizationOptions=function(t){b(this.kn,t),this.Is(),this.Ps()},t.prototype.applyOptions=function(t,i){b(this.$,t),this.$.fixLeftEdge?this.Os():this.Ls=null,void 0!==t.barSpacing&&this.setBarSpacing(t.barSpacing),void 0!==t.rightOffset&&this.setRightOffset(t.rightOffset),this.Is(),this.Ps(),this.Es.fire()},t.prototype.isEmpty=function(){return 0===this.Kt||0===this.Ns.size()},t.prototype.visibleBars=function(){return this.Cs&&(this.Cs=!1,this.Rs()),this.Ds},t.prototype.tickMarks=function(){return this.Ss},t.prototype.points=function(){return this.Ns},t.prototype.width=function(){return this.Kt},t.prototype.setWidth=function(t){if(isFinite(t)&&!(t<=0)&&this.Kt!==t){if(this.$.lockVisibleTimeRangeOnResize&&this.Kt){var i=this.Fs*t/this.Kt;this.Ws(i)}if(null!==this.Ls&&y(this.visibleBars()).firstBar()<=this.Ls){var e=this.Kt-t;this.Vs-=Math.round(e/this.Fs)+1}this.Kt=t,this.Cs=!0,this.Us(),this.qs()}},t.prototype.indexToCoordinate=function(t){if(this.isEmpty()||!w(t))return 0;var i=this.baseIndex()+this.Vs-t;return this.Kt-(i+.5)*this.Fs},t.prototype.indexesToCoordinates=function(t,i){for(var e=this.baseIndex(),n=void 0===i?0:i.from,r=void 0===i?t.length:i.to,s=n;s<r;s++){var o=t[s].time,h=e+this.Vs-o,a=this.Kt-(h+.5)*this.Fs;t[s].x=a}},t.prototype.indexToUserTime=function(t){return this.Ss.indexToTime(t)},t.prototype.coordinateToIndex=function(t){return Math.ceil(this.js(t))},t.prototype.setRightOffset=function(t){this.Cs=!0,this.Vs=t,this.qs(),this.F.recalculateAllPanes(),this.F.lightUpdate()},t.prototype.barSpacing=function(){return this.Fs},t.prototype.setBarSpacing=function(t){this.Ws(t),this.qs(),this.F.recalculateAllPanes(),this.F.lightUpdate()},t.prototype.rightOffset=function(){return this.Vs},t.prototype.marks=function(){if(this.isEmpty())return null;if(null!==this.Bs)return this.Bs;for(var t=this.Fs,i=5*(this.F.options().layout.fontSize+4),e=Math.round(i/t),n=y(this.visibleBars()),r=Math.max(n.firstBar(),n.firstBar()-e),s=Math.max(n.lastBar(),n.lastBar()-e),o=0,h=0,a=this.Ss.build(t,i);h<a.length;h++){var u=a[h];if(r<=u.index&&u.index<=s){var l=this.Ss.indexToTime(u.index);if(null!==l){if(o<this.zs.length){var c=this.zs[o];c.coord=this.indexToCoordinate(u.index),c.label=this.Hs(l,u.span),c.span=u.span,c.major=!1}else this.zs.push({coord:this.indexToCoordinate(u.index),label:this.Hs(l,u.span),span:u.span,major:!1});o++}}}return this.zs.length=o,this.Bs=this.zs,this.zs},t.prototype.reset=function(){this.Cs=!0,this.Ns=new pe,this.pn=null,this.mn=null,this.Ys(),this.Ss.reset(),this.Ls=null},t.prototype.restoreDefault=function(){this.Cs=!0,this.setBarSpacing(this.$.barSpacing),this.setRightOffset(this.$.rightOffset)},t.prototype.fixLeftEdge=function(){return this.$.fixLeftEdge},t.prototype.setBaseIndex=function(t){this.Cs=!0,this.ks=t,this.qs(),this.Os()},t.prototype.zoom=function(t,i){var e=this.js(t),n=this.barSpacing(),r=n+i*(n/10);this.setBarSpacing(r),this.$.rightBarStaysOnScroll||this.setRightOffset(this.rightOffset()+(e-this.js(t)))},t.prototype.startScale=function(t){this.pn&&this.endScroll(),null===this.mn&&null===this.As&&(this.isEmpty()||(this.mn=t,this.Ks()))},t.prototype.scaleTo=function(t){if(null!==this.As){var i=lt(this.Kt-t,0,this.Kt),e=lt(this.Kt-y(this.mn),0,this.Kt);0!==i&&0!==e&&this.setBarSpacing(this.As.barSpacing*i/e)}},t.prototype.endScale=function(){null!==this.mn&&(this.mn=null,this.Ys())},t.prototype.startScroll=function(t){null===this.pn&&null===this.As&&(this.isEmpty()||(this.pn=t,this.Ks()))},t.prototype.scrollTo=function(t){if(this.Cs=!0,null!==this.pn){var i=(this.pn-t)/this.barSpacing();this.Vs=y(this.As).rightOffset+i,this.Cs=!0,this.qs()}},t.prototype.endScroll=function(){null!==this.pn&&(this.pn=null,this.Ys())},t.prototype.scrollToRealTime=function(){this.scrollToOffsetAnimated(this.$.rightOffset)},t.prototype.scrollToOffsetAnimated=function(t,i){var e=this;if(void 0===i&&(i=400),!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(i)||i<=0)throw new RangeError("animationDuration (optional) must be finite positive number");var n=this.Vs,r=(new Date).getTime(),s=function(){var o=((new Date).getTime()-r)/i,h=o>=1,a=h?t:n+(t-n)*o;e.setRightOffset(a),h||setTimeout(s,20)};s()},t.prototype.update=function(t,i,e){if(this.Cs=!0,i.length>0){var n=this.Ns.size();this.Ns.merge(t,i),this.Vs<0&&this.Ns.size()===n+1&&(this.Vs-=1,this.Cs=!0)}this.Ss.merge(e),this.qs()},t.prototype.visibleBarsChanged=function(){return this.Ts},t.prototype.optionsApplied=function(){return this.Es},t.prototype.baseIndex=function(){return this.ks||0},t.prototype.setVisibleRange=function(t){var i=t.count();this.Ws(this.Kt/i),this.Vs=t.lastBar()-this.baseIndex(),this.qs(),this.Cs=!0,this.F.recalculateAllPanes(),this.F.lightUpdate()},t.prototype.fitContent=function(){var t=this.Ns.firstIndex(),i=this.Ns.lastIndex();null!==t&&null!==i&&this.setVisibleRange(new oe(t,i+this.$.rightOffset))},t.prototype.setTimePointsRange=function(t){var i=this.points(),e=i.firstIndex(),n=i.lastIndex();if(null!==e&&null!==n){var r=y(i.valueAt(e)).timestamp,s=y(i.valueAt(n)).timestamp,o=new oe(y(i.indexOf(Math.max(r,t.from.timestamp),!0)),y(i.indexOf(Math.min(s,t.to.timestamp),!0)));this.setVisibleRange(o)}},t.prototype.formatDateTime=function(t){return void 0!==this.kn.timeFormatter?this.kn.timeFormatter(t.businessDay||t.timestamp):this.$s.format(new Date(1e3*t.timestamp))},t.prototype._s=function(t){return(this.Kt+1-t)/this.Fs},t.prototype.js=function(t){var i=this._s(t),e=this.baseIndex()+this.Vs-i;return Math.round(1e6*e)/1e6},t.prototype.Ws=function(t){var i=this.Fs;this.Fs=t,this.Us(),i!==this.Fs&&(this.Cs=!0,this.Xs())},t.prototype.Rs=function(){if(this.isEmpty())this.Zs(null);else{var t=this.baseIndex(),i=Math.ceil(this.Kt/this.Fs)-1,e=Math.round(this.Vs+t),n=e-i;this.Zs(new oe(n,e))}},t.prototype.Us=function(){if(this.Fs<.5&&(this.Fs=.5,this.Cs=!0),0!==this.Kt){var t=.5*this.Kt;this.Fs>t&&(this.Fs=t,this.Cs=!0)}},t.prototype.qs=function(){var t=this.Js();this.Vs>t&&(this.Vs=t,this.Cs=!0);var i=this.Gs();null!==i&&this.Vs<i&&(this.Vs=i,this.Cs=!0)},t.prototype.Gs=function(){var t=this.Ns.firstIndex(),i=this.ks;if(null===t||null===i)return null;if(null!==this.Ls){var e=this.Kt/this.Fs;return this.Ls-i+e-1}return t-i-1+Math.min(2,this.Ns.size())},t.prototype.Js=function(){return this.Kt/this.Fs-Math.min(2,this.Ns.size())},t.prototype.Ks=function(){this.As={barSpacing:this.barSpacing(),rightOffset:this.rightOffset()}},t.prototype.Ys=function(){this.As=null},t.prototype.Hs=function(t,i){var e=this,n=this.xs.get(i);return void 0===n&&(n=new he((function(t){return e.Qs(t,i)})),this.xs.set(i,n)),void 0===t.businessDay?n.format(new Date(1e3*t.timestamp)):n.format(new Date(Date.UTC(t.businessDay.year,t.businessDay.month-1,t.businessDay.day)))},t.prototype.Qs=function(t,i){var e={},n=this.$.timeVisible;return i<20&&n?(e.hour12=!1,e.hour="2-digit",e.minute="2-digit",this.$.secondsVisible&&(e.second="2-digit")):i<40&&n?(e.hour12=!1,e.hour="2-digit",e.minute="2-digit"):i<50||i<60?e.day="numeric":i<70?e.month="short":e.year="numeric",new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()).toLocaleString(this.kn.locale,e)},t.prototype.Zs=function(t){if(null!==t||null!==this.Ds){var i=this.Ds;this.Ds=t,(null===this.Ds||null!==i&&!this.Ds.equals(i))&&this.Ts.fire(),this.Xs()}},t.prototype.Xs=function(){this.Bs=null},t.prototype.Is=function(){this.Xs(),this.xs.clear()},t.prototype.Ps=function(){var t=this.kn.dateFormat;this.$.timeVisible?this.$s=new se({dateFormat:t,timeFormat:this.$.secondsVisible?"%h:%m:%s":"%h:%m",dateTimeSeparator:"   ",locale:this.kn.locale}):this.$s=new ee(t,this.kn.locale)},t.prototype.Os=function(){if(this.$.fixLeftEdge){var t=this.Ns.firstIndex();if(null!==t&&this.Ls!==t){this.Ls=t;var i=y(this.visibleBars()).firstBar()-t;if(i<0){var e=this.Vs-i-1;this.setRightOffset(e)}}}},t}(),de=function(t){function i(i){var e=t.call(this)||this;return e.th=new Map,e.m=i,e}return p(i,t),i.prototype._drawImpl=function(t){},i.prototype._drawBackgroundImpl=function(t){if(this.m.visible){t.save();for(var i=0,e=0,n=this.m.lines;e<n.length;e++)if(0!==(a=n[e]).text.length){t.font=a.font;var r=this.ih(t,a.text);r>this.m.width?a.zoom=this.m.width/r:a.zoom=1,i+=a.lineHeight*a.zoom}var s=0;switch(this.m.vertAlign){case"top":s=0;break;case"center":s=Math.max((this.m.height-i)/2,0);break;case"bottom":s=Math.max(this.m.height-i,0)}t.fillStyle=this.m.color;for(var o=0,h=this.m.lines;o<h.length;o++){var a=h[o];t.save();var u=0;switch(this.m.horzAlign){case"left":t.textAlign="left",u=a.lineHeight/2;break;case"center":t.textAlign="center",u=this.m.width/2;break;case"right":t.textAlign="right",u=this.m.width-1-a.lineHeight/2}t.translate(u,s),t.textBaseline="top",t.font=a.font,t.scale(a.zoom,a.zoom),t.fillText(a.text,0,a.vertOffset),t.restore(),s+=a.lineHeight*a.zoom}t.restore()}},i.prototype.ih=function(t,i){var e=this.nh(t.font),n=e.get(i);return void 0===n&&(n=t.measureText(i).width,e.set(i,n)),n},i.prototype.nh=function(t){var i=this.th.get(t);return void 0===i&&(i=new Map,this.th.set(t,i)),i},i}(F),ve=function(){function t(t){this.o=!0,this.p={visible:!1,color:"",height:0,width:0,lines:[],vertAlign:"center",horzAlign:"center"},this.g=new de(this.p),this.k=t}return t.prototype.update=function(){this.o=!0},t.prototype.renderer=function(t,i){return this.o&&(this.M(t,i),this.o=!1),this.g},t.prototype.M=function(t,i){var e=this.k.options(),n=this.p;n.visible=e.visible,n.visible&&(n.color=e.color,n.width=i,n.height=t,n.horzAlign=e.horzAlign,n.vertAlign=e.vertAlign,n.lines=[{text:e.text,font:Ii(e.fontSize),lineHeight:1.2*e.fontSize,vertOffset:0,zoom:0}])},t}(),me=function(t){function i(i,e){var n=t.call(this)||this;return n.$=e,n.J=new ve(n),n}return p(i,t),i.prototype.paneViews=function(){return[this.J]},i.prototype.options=function(){return this.$},i.prototype.updateAllViews=function(){this.J.update()},i}(it),ye=function(){function t(t,i){this.sh=[],this.hh=[],this.Kt=0,this.rh=null,this.uh=null,this.eh=new ht,this.oh=new ht,this.fh=t,this.$=i,this.ah=new $i(this),this.$n=new fe(this,i.timeScale,this.$.localization),this.lh=new Yi,this.v=new et(this,i.crosshair),this.vh=new Hi(i.crosshair),this.dh=new me(this,i.watermark),this.createPane(),this.sh[0].setStretchFactor(2e3),this.sh[0].addDataSource(this.dh,!0,!1)}return t.prototype.fullUpdate=function(){this.Mh(new ji(3))},t.prototype.lightUpdate=function(){this.Mh(new ji(2))},t.prototype.updateSource=function(t){var i=this.wh(t);this.Mh(i)},t.prototype.hoveredSource=function(){return this.uh},t.prototype.setHoveredSource=function(t){var i=this.uh;this.uh=t,null!==i&&this.updateSource(i.source),null!==t&&this.updateSource(t.source)},t.prototype.options=function(){return this.$},t.prototype.applyOptions=function(t){b(this.$,t),void 0!==t.priceScale&&(this.mainPriceScale().applyOptions(t.priceScale),this.eh.fire()),void 0!==t.timeScale&&this.$n.applyOptions(t.timeScale),void 0!==t.localization&&(this.$n.applyLocalizationOptions(t.localization),this.mainPriceScale().updateFormatter()),this.fullUpdate()},t.prototype.updateAllPaneViews=function(){this.sh.forEach((function(t){return t.updateAllViews()})),this.updateCrosshair()},t.prototype.timeScale=function(){return this.$n},t.prototype.panes=function(){return this.sh},t.prototype.gridSource=function(){return this.lh},t.prototype.watermarkSource=function(){return this.dh},t.prototype.crosshairSource=function(){return this.v},t.prototype.crosshairMoved=function(){return this.oh},t.prototype.width=function(){return this.Kt},t.prototype.setPaneHeight=function(t,i){t.setHeight(i),this.recalculateAllPanes(),this.lightUpdate()},t.prototype.setWidth=function(t){this.Kt=t,this.$n.setWidth(this.Kt),this.sh.forEach((function(i){return i.setWidth(t)})),this.recalculateAllPanes()},t.prototype.createPane=function(t){var i=new qi(this.$n,this);void 0!==t?this.sh.splice(t,0,i):this.sh.push(i);var e=void 0===t?this.sh.length-1:t,n=new ji(3);return n.invalidatePane(e,{level:0,autoScale:!0}),this.invalidate(n),i},t.prototype.startScalePrice=function(t,i,e){t.startScalePrice(i,e)},t.prototype.scalePriceTo=function(t,i,e){t.scalePriceTo(i,e),this.updateCrosshair(),this.Mh(this.bh(t,2))},t.prototype.endScalePrice=function(t,i){t.endScalePrice(i),this.Mh(this.bh(t,2))},t.prototype.startScrollPrice=function(t,i,e){i.isAutoScale()||t.startScrollPrice(i,e)},t.prototype.scrollPriceTo=function(t,i,e){i.isAutoScale()||(t.scrollPriceTo(i,e),this.updateCrosshair(),this.Mh(this.bh(t,2)))},t.prototype.endScrollPrice=function(t,i){i.isAutoScale()||(t.endScrollPrice(i),this.Mh(this.bh(t,2)))},t.prototype.setPriceAutoScale=function(t,i,e){t.setPriceAutoScale(i,e),this.Mh(this.bh(t,2))},t.prototype.resetPriceScale=function(t,i){t.resetPriceScale(i),this.Mh(this.bh(t,2))},t.prototype.startScaleTime=function(t){this.$n.startScale(t)},t.prototype.zoomTime=function(t,i){var e=this.timeScale();if(!e.isEmpty()&&0!==i){var n=e.width();t=Math.max(1,Math.min(t,n)),e.zoom(t,i),this.updateCrosshair(),this.recalculateAllPanes(),this.lightUpdate()}},t.prototype.scrollChart=function(t){this.startScrollTime(0),this.scrollTimeTo(t),this.endScrollTime()},t.prototype.scaleTimeTo=function(t){this.$n.scaleTo(t),this.recalculateAllPanes(),this.updateCrosshair(),this.lightUpdate()},t.prototype.endScaleTime=function(){this.$n.endScale(),this.lightUpdate()},t.prototype.startScrollTime=function(t){this.rh=t,this.$n.startScroll(t)},t.prototype.scrollTimeTo=function(t){var i=!1;return null!==this.rh&&Math.abs(t-this.rh)>20&&(this.rh=null,i=!0),this.$n.scrollTo(t),this.recalculateAllPanes(),this.updateCrosshair(),this.lightUpdate(),i},t.prototype.endScrollTime=function(){this.$n.endScroll(),this.lightUpdate(),this.rh=null},t.prototype.resetTimeScale=function(){this.$n.restoreDefault(),this.recalculateAllPanes(),this.updateCrosshair(),this.lightUpdate()},t.prototype.invalidate=function(t){this.fh&&this.fh(t),this.lh.invalidate(),this.lightUpdate()},t.prototype.dataSources=function(){return this.sh.reduce((function(t,i){return t.concat(i.dataSources())}),[])},t.prototype.serieses=function(){return this.hh},t.prototype.setAndSaveCurrentPosition=function(t,i,e){this.v.saveOriginCoord(t,i);var n=NaN,r=this.$n.coordinateToIndex(t),s=this.$n.visibleBars();if(null!==s&&(r=Math.min(Math.max(s.firstBar(),r),s.lastBar())),null!==e.mainDataSource()){var o=e.defaultPriceScale(),h=o.firstValue();null!==h&&(n=o.coordinateToPrice(i,h)),n=this.vh.align(n,r,e)}this.v.setPosition(r,n,e),this.mh(),this.oh.fire(this.v.appliedIndex(),{x:t,y:i})},t.prototype.clearCurrentPosition=function(){this.crosshairSource().clearPosition(),this.mh(),this.oh.fire(null,null)},t.prototype.updateCrosshair=function(){var t=this.v.pane();if(null!==t){var i=this.v.originCoordX(),e=this.v.originCoordY();this.setAndSaveCurrentPosition(i,e,t)}},t.prototype.updateTimeScale=function(t,i,e,n){n&&this.$n.reset(),this.$n.update(t,i,e)},t.prototype.updateTimeScaleBaseIndex=function(t){var i=this.hh.reduce((function(t,i){var e=i.bars();if(e.isEmpty())return t;var n=y(e.lastIndex());return void 0===t?n:Math.max(n,t)}),void 0);if(void 0!==i){var e=this.$n,n=e.baseIndex(),r=e.visibleBars();if(null!==r){var s=r.contains(n);if(void 0!==t&&t>0&&!s){var o=i-n;e.setRightOffset(e.rightOffset()-o)}}e.setBaseIndex(i)}this.updateCrosshair(),this.recalculateAllPanes(),this.lightUpdate()},t.prototype.recalculatePane=function(t){null!==t&&t.recalculate()},t.prototype.paneForSource=function(t){var i=this.sh.find((function(i){return i.orderedSources().includes(t)}));return void 0===i?null:i},t.prototype.recalculateAllPanes=function(){this.sh.forEach((function(t){return t.recalculate()})),this.updateAllPaneViews()},t.prototype.destroy=function(){this.sh.forEach((function(t){return t.destroy()})),this.sh.length=0,this.$.localization.priceFormatter=void 0,this.$.localization.timeFormatter=void 0},t.prototype.setPriceAutoScaleForAllMainSources=function(){this.sh.map((function(t){return t.mainDataSource()})).forEach((function(t){null!==t&&y(t.priceScale()).setMode({autoScale:!0})}))},t.prototype.rendererOptionsProvider=function(){return this.ah},t.prototype.priceAxisRendererOptions=function(){return this.ah.options()},t.prototype.mainPriceScaleOptionsChanged=function(){return this.eh},t.prototype.mainPriceScale=function(){return this.sh[0].defaultPriceScale()},t.prototype.createSeries=function(t,i){var e=this.sh[0],n=this.ph(i,t,e);return this.hh.push(n),1===this.hh.length?this.fullUpdate():this.lightUpdate(),n},t.prototype.removeSeries=function(t){var i=this.paneForSource(t),e=this.hh.indexOf(t);v(-1!==e,"Series not found"),this.hh.splice(e,1),y(i).removeDataSource(t),t.destroy&&t.destroy()},t.prototype.fitContent=function(){var t=new ji(2);t.setFitContent(),this.Mh(t)},t.prototype.setTargetTimeRange=function(t){var i=new ji(2);i.setTargetTimeRange(t),this.Mh(i)},t.prototype.bh=function(t,i){var e=new ji(i);if(null!==t){var n=this.sh.indexOf(t);e.invalidatePane(n,{level:i})}return e},t.prototype.wh=function(t,i){return void 0===i&&(i=2),this.bh(this.paneForSource(t),i)},t.prototype.Mh=function(t){this.fh&&this.fh(t),this.lh.invalidate()},t.prototype.mh=function(){this.Mh(new ji(1))},t.prototype.ph=function(t,i,e){var n=new _i(this,t,i);return e.addDataSource(n,Boolean(t.overlay),!1),t.overlay&&n.applyOptions(t),n},t}(),ge=function(){function t(t,i){this.w=t,this.h=i}return t.prototype.equals=function(t){return this.w===t.w&&this.h===t.h},t}();function be(t){return t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.devicePixelRatio||1}function Se(t){var i=y(t.getContext("2d"));return i.setTransform(1,0,0,1,0,0),i}function we(t){var i=t.createElement("canvas");return function(t){t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.msUserSelect="none",t.style.MozUserSelect="none",t.style.webkitTapHighlightColor="transparent"}(i),i}function Me(t,i){var e=we(t),n=be(e);return e.style.width=i.w+"px",e.style.height=i.h+"px",e.width=i.w*n,e.height=i.h*n,e}function xe(t,i){var e=we(y(t.ownerDocument));t.appendChild(e);var n=new a(e);return n.resizeCanvas({width:i.w,height:i.h}),n}var Ce,Te=!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints||"ontouchstart"in window||Boolean(window.DocumentTouch&&document instanceof window.DocumentTouch),ke="onorientationchange"in window&&Te,Pe=/Android/i.test(navigator.userAgent),_e=/iPhone|iPad|iPod|AppleWebKit.+Mobile/i.test(navigator.userAgent),Ee=Pe||_e;!function(t){t[t.ResetClick=500]="ResetClick",t[t.LongTap=240]="LongTap"}(Ce||(Ce={}));var Le=function(){function t(t,i,e){this.gh=0,this.yh=null,this.kh=null,this.Nh=!1,this.Sh=null,this.xh=!1,this.Dh=!1,this.Ch=null,this.Th=null,this.Eh=null,this.Lh=null,this.Ah=0,this.Bh=!1,this.zh=!1,this.Vh=!1,this.Fh=t,this.Ph=i,this.$=e,this.Ih()}return t.prototype.destroy=function(){null!==this.Ch&&(this.Ch(),this.Ch=null),null!==this.Th&&(this.Th(),this.Th=null),null!==this.Eh&&(this.Eh(),this.Eh=null),this.Oh(),this.Rh()},t.prototype.Wh=function(t){var i=this;this.Th&&this.Th();var e=this.Uh.bind(this);this.Th=function(){i.Fh.removeEventListener("mousemove",e)},this.Fh.addEventListener("mousemove",e),Fe(t)&&this.Uh(t);var n=this.qh(t);this.jh(n,this.Ph.mouseEnterEvent)},t.prototype.Rh=function(){null!==this.yh&&clearTimeout(this.yh),this.gh=0,this.yh=null},t.prototype.Uh=function(t){if(!this.Vh||Fe(t)){var i=this.qh(t);this.jh(i,this.Ph.mouseMoveEvent)}},t.prototype.Hh=function(t){if((!("button"in t)||0===t.button)&&null===this.Lh){var i=Fe(t);if(!this.zh||!i){this.Bh=!0;var e=this.qh(t),n=g(this.Sh),r=Math.abs(n.x-e.pageX),s=Math.abs(n.y-e.pageY),o=r+s>5;if(o||!i){if(o&&!this.xh&&i){var h=.5*r,a=s>=h&&!this.$.treatVertTouchDragAsPageScroll,u=h>s&&!this.$.treatHorzTouchDragAsPageScroll;a||u||(this.zh=!0)}o&&(this.xh=!0,this.Dh=!0,i&&this.Oh()),this.zh||(this.jh(e,this.Ph.pressedMouseMoveEvent),i&&De(t))}}}},t.prototype.Yh=function(t){if(!("button"in t)||0===t.button){var i=this.qh(t);this.Oh(),this.Sh=null,this.Vh=!1,this.Eh&&(this.Eh(),this.Eh=null),Fe(t)&&this.Kh(t),this.jh(i,this.Ph.mouseUpEvent),++this.gh,this.yh&&this.gh>1?(this.jh(i,this.Ph.mouseDoubleClickEvent),this.Rh()):this.Dh||this.jh(i,this.Ph.mouseClickEvent),Fe(t)&&(De(t),this.Kh(t),0===t.touches.length&&(this.Nh=!1))}},t.prototype.Oh=function(){null!==this.kh&&(clearTimeout(this.kh),this.kh=null)},t.prototype.$h=function(t){if(!("button"in t)||0===t.button){var i=this.qh(t);this.Dh=!1,this.xh=!1,this.zh=!1,Fe(t)&&this.Wh(t),this.Sh={x:i.pageX,y:i.pageY},this.Eh&&(this.Eh(),this.Eh=null);var e=this.Hh.bind(this),n=this.Yh.bind(this),r=this.Fh.ownerDocument.documentElement;this.Eh=function(){r.removeEventListener("touchmove",e),r.removeEventListener("touchend",n),r.removeEventListener("mousemove",e),r.removeEventListener("mouseup",n)},r.addEventListener("touchmove",e,{passive:!1}),r.addEventListener("touchend",n,{passive:!1}),this.Oh(),Fe(t)&&1===t.touches.length?this.kh=setTimeout(this._h.bind(this,t),240):(r.addEventListener("mousemove",e),r.addEventListener("mouseup",n)),this.Vh=!0,this.jh(i,this.Ph.mouseDownEvent),this.yh||(this.gh=0,this.yh=setTimeout(this.Rh.bind(this),500))}},t.prototype.Ih=function(){var t=this;this.Fh.addEventListener("mouseenter",this.Wh.bind(this)),this.Fh.addEventListener("touchcancel",this.Oh.bind(this));var i=this.Fh.ownerDocument,e=function(i){t.Ph.mouseDownOutsideEvent&&(i.target&&t.Fh.contains(i.target)||t.Ph.mouseDownOutsideEvent())};this.Ch=function(){i.removeEventListener("mousedown",e),i.removeEventListener("touchstart",e)},i.addEventListener("mousedown",e),i.addEventListener("touchstart",e,{passive:!0}),this.Fh.addEventListener("mouseleave",this.Kh.bind(this)),this.Fh.addEventListener("touchstart",this.$h.bind(this),{passive:!0}),ke||this.Fh.addEventListener("mousedown",this.$h.bind(this)),this.Xh(),this.Fh.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype.Xh=function(){var t=this;void 0===this.Ph.pinchStartEvent&&void 0===this.Ph.pinchEvent&&void 0===this.Ph.pinchEndEvent||(this.Fh.addEventListener("touchstart",(function(i){return t.Zh(i.touches)}),{passive:!0}),this.Fh.addEventListener("touchmove",(function(i){if(2===i.touches.length&&null!==t.Lh&&void 0!==t.Ph.pinchEvent){var e=Ve(i.touches[0],i.touches[1])/t.Ah;t.Ph.pinchEvent(t.Lh,e),De(i)}}),{passive:!1}),this.Fh.addEventListener("touchend",(function(i){t.Zh(i.touches)})))},t.prototype.Zh=function(t){1===t.length&&(this.Bh=!1),2!==t.length||this.Bh||this.Nh?this.Jh():this.Gh(t)},t.prototype.Gh=function(t){var i=Re(this.Fh);this.Lh={x:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,y:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this.Ah=Ve(t[0],t[1]),void 0!==this.Ph.pinchStartEvent&&this.Ph.pinchStartEvent(),this.Oh()},t.prototype.Jh=function(){null!==this.Lh&&(this.Lh=null,void 0!==this.Ph.pinchEndEvent&&this.Ph.pinchEndEvent())},t.prototype.Kh=function(t){this.Th&&this.Th();var i=this.qh(t);this.jh(i,this.Ph.mouseLeaveEvent)},t.prototype._h=function(t){var i=this.qh(t);this.jh(i,this.Ph.longTapEvent),this.Dh=!0,this.Nh=!0},t.prototype.jh=function(t,i){i&&i.call(this.Ph,t)},t.prototype.qh=function(t){var i;i="touches"in t&&t.touches.length?t.touches[0]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0]:t;var e=Re(this.Fh);return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-e.left,localY:i.clientY-e.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,type:t.type.startsWith("mouse")?"mouse":"touch",target:i.target,view:t.view}},t}();function Re(t){return t.getBoundingClientRect()||{left:0,top:0}}function Ve(t,i){var e=t.clientX-i.clientX,n=t.clientY-i.clientY;return Math.sqrt(e*e+n*n)}function Fe(t){return Boolean(t.touches)}function De(t){t.cancelable&&t.preventDefault()}var ze,Ae=function(){function t(t,i,e,n){if(this.Qh=0,this.tr=0,this.ir=0,this.nr=0,this.sr=0,this.hr=0,this.rr=0,this.ur=t,this.er=t.paneWidgets()[i],this.or=t.paneWidgets()[e],this.ar=document.createElement("tr"),this.ar.style.height="1px",this.cr=document.createElement("td"),this.cr.style.padding="0",this.cr.setAttribute("colspan","3"),this.lr(),this.ar.appendChild(this.cr),n)this.vr=null,this.dr=null;else{this.vr=document.createElement("div"),this.vr.style.position="absolute",this.vr.style.zIndex="50",this.vr.style.height="5px",this.vr.style.width="100%",this.vr.style.backgroundColor="rgba(255, 255, 255, 0.02)",this.vr.style.cursor="ns-resize",this.cr.appendChild(this.vr);var r={mouseDownEvent:this.Mr.bind(this),pressedMouseMoveEvent:this.wr.bind(this),mouseUpEvent:this.br.bind(this)};this.dr=new Le(this.vr,r,{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0})}}return t.prototype.destroy=function(){null!==this.dr&&this.dr.destroy()},t.prototype.getElement=function(){return this.ar},t.prototype.getSize=function(){return new ge(this.er.getSize().w,1)},t.prototype.getImage=function(){var t=this.getSize(),i=Me(document,t),e=Se(i);return e.fillStyle=this.ur.options().timeScale.borderColor,e.fillRect(0,0,t.w,t.h),i},t.prototype.update=function(){this.lr()},t.prototype.lr=function(){this.cr.style.background=this.ur.options().timeScale.borderColor},t.prototype.Mr=function(t){this.Qh=t.pageY,this.tr=0,this.ir=this.er.getSize().h+this.or.getSize().h,this.nr=this.er.stretchFactor()+this.or.stretchFactor(),this.sr=30,this.hr=this.ir-this.sr,this.rr=this.nr/this.ir},t.prototype.wr=function(t){this.tr=t.pageY-this.Qh;var i=this.er.getSize().h,e=lt(i+this.tr,this.sr,this.hr)*this.rr,n=this.nr-e;this.er.setStretchFactor(e),this.or.setStretchFactor(n),this.ur.adjustSize(),this.er.getSize().h!==i&&(this.Qh=t.pageY)},t.prototype.br=function(t){this.Qh=0,this.tr=0,this.ir=0,this.nr=0,this.sr=0,this.hr=0,this.rr=0},t}(),Oe=function(){function t(t,i,e,n){this.$t=new Kt(200),this.Zt=0,this.mr="",this.pr="",this.gr=[],this.yr=new Map,this.Zt=t,this.mr=i,this.pr=Ii(t,e,n)}return t.prototype.destroy=function(){delete this.$t,this.gr=[],this.yr.clear()},t.prototype.paintTo=function(t,i,e,n,r){var s=this.kr(t,i);if("left"!==r){var o=be(t.canvas);e-=Math.floor(s.textWidth*o)}n-=Math.floor(s.height/2),t.drawImage(s.canvas,e,n,s.width,s.height)},t.prototype.kr=function(t,i){var e,n=this;if(this.yr.has(i))e=m(this.yr.get(i));else{if(this.gr.length>=200){var r=m(this.gr.shift());this.yr.delete(r)}var s=be(t.canvas),o=Math.ceil(this.Zt/4.5),h=Math.round(this.Zt/10),a=Math.ceil(this.$t.measureText(t,i)),u=ft(Math.round(a+2*o)),l=ft(this.Zt+2*o),c=Me(document,new ge(u,l));e={text:i,textWidth:Math.round(Math.max(1,a)),width:Math.ceil(u*s),height:Math.ceil(l*s),canvas:c},0!==a&&(this.gr.push(e.text),this.yr.set(e.text,e)),H(t=Se(e.canvas),s,(function(){t.font=n.pr,t.fillStyle=n.mr,t.fillText(i,0,l-o-h)}))}return e},t}();!function(t){t[t.Default=0]="Default",t[t.NsResize=1]="NsResize"}(ze||(ze={}));var Be,Ie,Ne=function(){function t(t,i,e,n){var r=this;this.B=null,this.Nr=null,this.Sr=null,this.xr=!1,this.Dr=!0,this.Cr=new Kt(50),this.Tr=new Oe(11,"#000"),this.mr=null,this.pr=null,this.Er=0,this.Lr=function(){r.Ar(r.ah.options()),r.I.chart().model().lightUpdate()},this.Br=function(){r.I.chart().model().lightUpdate()},this.I=t,this.$=i,this.ah=e,this.zr="left"===n,this.cr=document.createElement("div"),this.cr.style.height="100%",this.cr.style.overflow="hidden",this.cr.style.width="25px",this.cr.style.left="0",this.cr.style.position="relative",this.Vr=xe(this.cr,new ge(16,16)),this.Vr.subscribeCanvasConfigured(this.Lr);var s=this.Vr.canvas;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Fr=xe(this.cr,new ge(16,16)),this.Fr.subscribeCanvasConfigured(this.Br);var o=this.Fr.canvas;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";var h={mouseDownEvent:this.Mr.bind(this),pressedMouseMoveEvent:this.wr.bind(this),mouseDownOutsideEvent:this.Pr.bind(this),mouseUpEvent:this.br.bind(this),mouseDoubleClickEvent:this.Ir.bind(this),mouseEnterEvent:this.Or.bind(this),mouseLeaveEvent:this.Rr.bind(this)};this.dr=new Le(this.Fr.canvas,h,{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0})}return t.prototype.destroy=function(){this.dr.destroy(),this.Fr.unsubscribeCanvasConfigured(this.Br),this.Fr.destroy(),this.Vr.unsubscribeCanvasConfigured(this.Lr),this.Vr.destroy(),null!==this.B&&(this.B.onMarksChanged().unsubscribeAll(this),this.B.optionsChanged().unsubscribeAll(this)),this.B=null,null!==this.Sr&&(clearTimeout(this.Sr),this.Sr=null),this.Tr.destroy()},t.prototype.getElement=function(){return this.cr},t.prototype.backgroundColor=function(){return this.$.backgroundColor},t.prototype.lineColor=function(){return this.I.chart().options().priceScale.borderColor},t.prototype.textColor=function(){return this.$.textColor},t.prototype.fontSize=function(){return this.$.fontSize},t.prototype.baseFont=function(){return Ii(this.fontSize(),this.$.fontFamily)},t.prototype.rendererOptions=function(){var t=this.ah.options(),i=this.mr!==t.color,e=this.pr!==t.font;return(i||e)&&(this.Ar(t),this.mr=t.color),e&&(this.Cr.reset(),this.pr=t.font),t},t.prototype.optimalWidth=function(){if(!this.isVisible()||null===this.B)return 0;var t=34,i=this.rendererOptions(),e=Se(this.Vr.canvas),n=this.B.marks();e.font=this.baseFont(),n.length>0&&(t=Math.max(this.Cr.measureText(e,n[0].label),this.Cr.measureText(e,n[n.length-1].label)));for(var r=this.Wr(),s=r.length;s--;){var o=this.Cr.measureText(e,r[s].text());o>t&&(t=o)}var h=Math.ceil(i.borderSize+i.tickLength+i.paddingInner+i.paddingOuter+t);return h+h%2},t.prototype.setSize=function(t){if(t.w<0||t.h<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));null!==this.Nr&&this.Nr.equals(t)||(this.Nr=t,this.Vr.resizeCanvas({width:t.w,height:t.h}),this.Fr.resizeCanvas({width:t.w,height:t.h}),this.cr.style.width=t.w+"px",this.cr.style.height=t.h+"px",this.cr.style.minWidth=t.w+"px")},t.prototype.getWidth=function(){return y(this.Nr).w},t.prototype.setPriceScale=function(t){this.B!==t&&(null!==this.B&&(this.B.onMarksChanged().unsubscribeAll(this),this.B.optionsChanged().unsubscribeAll(this)),this.B=t,t.onMarksChanged().subscribe(this.cn.bind(this),this))},t.prototype.priceScale=function(){return this.B},t.prototype.isVisible=function(){return this.Dr},t.prototype.setVisible=function(t){t!==this.Dr&&(this.cr.style.display=t?"table-cell":"none",this.Dr=t)},t.prototype.setAutoScale=function(t){var i=this.I.state();this.I.chart().model().setPriceAutoScale(i,y(this.priceScale()),t)},t.prototype.reset=function(){var t=this.I.state();this.I.chart().model().resetPriceScale(t,y(this.priceScale()))},t.prototype.paint=function(t){if(this.Dr&&null!==this.Nr){if(1!==t){var i=Se(this.Vr.canvas);this.Ur(),this.qr(i,this.Vr.pixelRatio),this.Lt(i,this.Vr.pixelRatio),this.jr(i,this.Vr.pixelRatio),this.Hr(i,this.Vr.pixelRatio)}var e=Se(this.Fr.canvas),n=this.Nr.w,r=this.Nr.h;H(e,this.Fr.pixelRatio,(function(){e.clearRect(0,0,n,r)})),this.Yr(e,this.Fr.pixelRatio)}},t.prototype.getImage=function(){return this.Vr.canvas},t.prototype.isLeft=function(){return this.zr},t.prototype.Mr=function(t){if(null!==this.B&&!this.B.isEmpty()&&this.I.chart().options().handleScale.axisPressedMouseMove){var i=this.I.chart().model(),e=this.I.state();this.xr=!0,i.startScalePrice(e,this.B,t.localY)}},t.prototype.wr=function(t){if(null!==this.B&&this.I.chart().options().handleScale.axisPressedMouseMove){var i=this.I.chart().model(),e=this.I.state(),n=this.B;i.scalePriceTo(e,n,t.localY)}},t.prototype.Pr=function(){if(null!==this.B&&this.I.chart().options().handleScale.axisPressedMouseMove){var t=this.I.chart().model(),i=this.I.state(),e=this.B;this.xr&&(this.xr=!1,t.endScalePrice(i,e))}},t.prototype.br=function(t){if(null!==this.B&&this.I.chart().options().handleScale.axisPressedMouseMove){var i=this.I.chart().model(),e=this.I.state();this.xr=!1,i.endScalePrice(e,this.B)}},t.prototype.Ir=function(t){this.I.chart().options().handleScale.axisDoubleClickReset&&this.reset()},t.prototype.Or=function(t){null!==this.B&&(!this.I.chart().model().options().handleScale.axisPressedMouseMove||this.B.isPercentage()||this.B.isIndexedTo100()||this.Kr(1))},t.prototype.Rr=function(t){this.Kr(0)},t.prototype.Wr=function(){var t=this,i=[],e=null===this.B?void 0:this.B;return function(n){for(var r=0;r<n.length;++r)for(var s=n[r].priceAxisViews(t.I.state(),e),o=0;o<s.length;o++)i.push(s[o])}(this.I.state().orderedSources()),i},t.prototype.qr=function(t,i){var e=this;if(null!==this.Nr){var n=this.Nr.w,r=this.Nr.h;H(t,i,(function(){q(t,0,0,n,r,e.backgroundColor())}))}},t.prototype.Lt=function(t,i){if(null!==this.Nr&&null!==this.B&&this.B.options().borderVisible){t.save(),t.fillStyle=this.lineColor();var e,n=Math.max(1,Math.floor(this.rendererOptions().borderSize*i));e=this.zr?Math.floor(this.Nr.w*i)-n:0,t.fillRect(e,0,n,Math.ceil(this.Nr.h*i)),t.restore()}},t.prototype.jr=function(t,i){if(null!==this.Nr&&null!==this.B){var e=this.B.marks();t.save(),t.strokeStyle=this.lineColor(),t.font=this.baseFont(),t.fillStyle=this.lineColor();var n=this.rendererOptions(),r=this.B.options().borderVisible,s=this.zr?Math.floor((this.Nr.w-n.tickLength)*i-n.borderSize*i):Math.floor(n.borderSize*i),o=this.zr?Math.round(s-n.paddingInner*i):Math.round(s+n.tickLength*i+n.paddingInner*i),h=this.zr?"right":"left",a=Math.max(1,Math.floor(i)),u=Math.floor(.5*i);if(r){var l=Math.round(n.tickLength*i);t.beginPath();for(var c=0,p=e;c<p.length;c++){var f=p[c];t.rect(s,Math.round(f.coord*i)-u,l,a)}t.fill()}t.fillStyle=this.textColor();for(var d=0,v=e;d<v.length;d++)f=v[d],this.Tr.paintTo(t,f.label,o,Math.round(f.coord*i),h);t.restore()}},t.prototype.Ur=function(){if(null!==this.Nr&&null!==this.B){var t=this.Nr.h/2,i=[],e=this.B.orderedSources().slice(),n=this.I.state(),r=this.rendererOptions();this.B===n.defaultPriceScale()&&this.I.state().orderedSources().forEach((function(t){n.isOverlay(t)&&e.push(t)}));var s=this.B.mainSource(),o=this.B;e.forEach((function(e){var r=e.priceAxisViews(n,o);r.forEach((function(t){t.setFixedCoordinate(null),t.isVisible()&&i.push(t)})),s===e&&r.length>0&&(t=r[0].coordinate())}));var h=i.filter((function(i){return i.coordinate()<=t})),a=i.filter((function(i){return i.coordinate()>t}));if(h.sort((function(t,i){return i.coordinate()-t.coordinate()})),h.length&&a.length&&a.push(h[0]),a.sort((function(t,i){return t.coordinate()-i.coordinate()})),i.forEach((function(t){return t.setFixedCoordinate(t.coordinate())})),this.B.options().alignLabels){for(var u=1;u<h.length;u++){var l=h[u],c=(f=h[u-1]).height(r,!1);l.coordinate()>(d=f.getFixedCoordinate())-c&&l.setFixedCoordinate(d-c)}for(var p=1;p<a.length;p++){var f,d;l=a[p],c=(f=a[p-1]).height(r,!0),l.coordinate()<(d=f.getFixedCoordinate())+c&&l.setFixedCoordinate(d+c)}}}},t.prototype.Hr=function(t,i){var e=this;if(null!==this.Nr){t.save();var n=this.Nr,r=this.Wr(),s=this.rendererOptions(),o=this.zr?"right":"left";r.forEach((function(r){if(r.isAxisLabelVisible()){var h=r.renderer();t.save(),h.draw(t,s,e.Cr,n.w,o,i),t.restore()}})),t.restore()}},t.prototype.Yr=function(t,i){var e=this;if(null!==this.Nr&&null!==this.B){t.save();var n=this.Nr,r=this.I.chart().model(),s=[],o=this.I.state(),h=r.crosshairSource().priceAxisViews(o,this.B);h.length&&s.push(h);var a=this.rendererOptions(),u=this.zr?"right":"left";s.forEach((function(r){r.forEach((function(r){t.save(),r.renderer().draw(t,a,e.Cr,n.w,u,i),t.restore()}))})),t.restore()}},t.prototype.Kr=function(t){this.cr.style.cursor=1===t?"ns-resize":"default"},t.prototype.cn=function(){var t=this,i=this.optimalWidth();if(this.Er<i){var e=this.I.chart();null===this.Sr&&(this.Sr=setTimeout((function(){e&&e.model().fullUpdate(),t.Sr=null}),100))}this.Er=i},t.prototype.Ar=function(t){this.Tr.destroy(),this.Tr=new Oe(t.fontSize,t.color,t.fontFamily)},t}(),$e=Ee,We=function(){function t(t,i){var e=this;this.Nr=new ge(0,0),this.$r=null,this._r=null,this.Xr=!1,this.Zr="none",this.Jr=new ht,this.Gr=0,this.Qr=!1,this.tu=null,this.iu=!1,this.nu=null,this.Lr=function(){return e.su&&e.F().lightUpdate()},this.Br=function(){return e.su&&e.F().lightUpdate()},this.hu=t,this.su=i,this.su.onDestroyed().subscribe(this.ru.bind(this),this,!0),this.uu=document.createElement("td"),this.uu.style.padding="0",this.uu.style.position="relative";var n=document.createElement("div");n.style.width="100%",n.style.height="100%",n.style.position="relative",n.style.overflow="hidden",this.eu=document.createElement("td"),this.eu.style.padding="0",this.ou=document.createElement("td"),this.ou.style.padding="0",this.uu.appendChild(n),this.Vr=xe(n,new ge(16,16)),this.Vr.subscribeCanvasConfigured(this.Lr);var r=this.Vr.canvas;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Fr=xe(n,new ge(16,16)),this.Fr.subscribeCanvasConfigured(this.Br);var s=this.Fr.canvas;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.ar=document.createElement("tr"),this.ar.appendChild(this.eu),this.ar.appendChild(this.uu),this.ar.appendChild(this.ou),this.fu(),t.model().mainPriceScaleOptionsChanged().subscribe(this.au.bind(this),this),this.updatePriceAxisWidget();var o=this.chart().options().handleScroll;this.dr=new Le(this.Fr.canvas,this,{treatVertTouchDragAsPageScroll:!o.vertTouchDrag,treatHorzTouchDragAsPageScroll:!o.horzTouchDrag})}return t.prototype.destroy=function(){null!==this.$r&&this.$r.destroy(),this.Fr.unsubscribeCanvasConfigured(this.Br),this.Fr.destroy(),this.Vr.unsubscribeCanvasConfigured(this.Lr),this.Vr.destroy(),null!==this.su&&this.su.onDestroyed().unsubscribeAll(this),this.dr.destroy()},t.prototype.state=function(){return y(this.su)},t.prototype.stateOrNull=function(){return this.su},t.prototype.setState=function(i){null!==this.su&&this.su.onDestroyed().unsubscribeAll(this),this.su=i,null!==this.su&&this.su.onDestroyed().subscribe(t.prototype.ru.bind(this),this,!0),this.updatePriceAxisWidget()},t.prototype.chart=function(){return this.hu},t.prototype.getElement=function(){return this.ar},t.prototype.updatePriceAxisWidget=function(){if(null!==this.su&&null!==this.$r&&0!==this.F().serieses().length){var t=this.su.defaultPriceScale();this.$r.setPriceScale(y(t))}},t.prototype.stretchFactor=function(){return null!==this.su?this.su.stretchFactor():0},t.prototype.setStretchFactor=function(t){this.su&&this.su.setStretchFactor(t)},t.prototype.mouseEnterEvent=function(t){if(this.su){var i=t.localX,e=t.localY;ke||this.cu(i,e)}},t.prototype.mouseDownEvent=function(t){if(this.Qr=!1,this.iu=null!==this.tu,this.su){if(document.activeElement!==document.body&&document.activeElement!==document.documentElement)y(document.activeElement).blur();else{var i=document.getSelection();null!==i&&i.removeAllRanges()}var e=this.F();if(!this.su.defaultPriceScale().isEmpty()&&!e.timeScale().isEmpty()){if(null!==this.tu){var n=e.crosshairSource();this.nu={x:n.appliedX(),y:n.appliedY()},this.tu={x:t.localX,y:t.localY}}ke||this.cu(t.localX,t.localY)}}},t.prototype.mouseMoveEvent=function(t){if(this.su){var i=t.localX,e=t.localY;if(this.lu()&&this.vu(),!ke){this.cu(i,e);var n=this.hitTest(i,e);this.F().setHoveredSource(n&&{source:n.source,object:n.object}),null!==n&&void 0!==n.view.moveHandler&&n.view.moveHandler(i,e)}}},t.prototype.mouseClickEvent=function(t){if(null!==this.su){var i=t.localX,e=t.localY,n=this.hitTest(i,e);if(null!==n&&void 0!==n.view.clickHandler&&n.view.clickHandler(i,e),this.Jr.hasListeners()){var r=this.F().crosshairSource().appliedIndex();this.Jr.fire(r,{x:i,y:e})}this.du()}},t.prototype.pressedMouseMoveEvent=function(t){if(null!==this.su){var i=this.F(),e=t.localX,n=t.localY;if(null!==this.tu){this.iu=!1;var r=y(this.nu),s=r.x+(e-this.tu.x),o=r.y+(n-this.tu.y);this.cu(s,o)}else this.lu()||this.cu(e,n);if(!i.timeScale().isEmpty()){var h=this.hu.options().handleScroll;if(h.pressedMouseMove&&"touch"!==t.type||(h.horzTouchDrag||h.vertTouchDrag)&&"mouse"!==t.type){var a=this.su.defaultPriceScale();null!==this._r||this.Mu()||(this._r={x:t.clientX,y:t.clientY}),null===this._r||this._r.x===t.clientX&&this._r.y===t.clientY||this.Xr||(a.isEmpty()||i.startScrollPrice(this.su,a,t.localY),i.startScrollTime(t.localX),this.Xr=!0),this.Xr&&(a.isEmpty()||i.scrollPriceTo(this.su,a,t.localY),i.scrollTimeTo(t.localX))}}}},t.prototype.mouseUpEvent=function(t){if(null!==this.su){this.Qr=!1;var i=this.F();if(this.Xr){var e=this.su.defaultPriceScale();i.endScrollPrice(this.su,e),i.endScrollTime(),this._r=null,this.Xr=!1}}},t.prototype.longTapEvent=function(t){if(this.Qr=!0,null===this.tu&&$e){var i={x:t.localX,y:t.localY};this.wu(i,i)}},t.prototype.mouseLeaveEvent=function(t){null!==this.su&&(this.su.model().setHoveredSource(null),Ee||this.vu())},t.prototype.clicked=function(){return this.Jr},t.prototype.pinchStartEvent=function(){this.Gr=1},t.prototype.pinchEvent=function(t,i){if(this.hu.options().handleScale.pinch){var e=5*(i-this.Gr);this.Gr=i,this.F().zoomTime(t.x,e)}},t.prototype.hitTest=function(t,i){var e=this.su;if(null===e)return null;for(var n=0,r=e.orderedSources();n<r.length;n++){var s=r[n],o=this.bu(s.paneViews(e),t,i);if(null!==o)return{source:s,view:o.view,object:o.object}}return null},t.prototype.setPriceAxisSize=function(t){y(this.$r).setSize(new ge(t,this.Nr.h))},t.prototype.getSize=function(){return this.Nr},t.prototype.setSize=function(t){if(t.w<0||t.h<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.Nr.equals(t)||(this.Nr=t,this.Vr.resizeCanvas({width:t.w,height:t.h}),this.Fr.resizeCanvas({width:t.w,height:t.h}),this.uu.style.width=t.w+"px",this.uu.style.height=t.h+"px")},t.prototype.recalculatePriceScale=function(){var t=y(this.su);t.recalculatePriceScale(t.defaultPriceScale());for(var i=0,e=t.dataSources();i<e.length;i++){var n=e[i];if(t.isOverlay(n)){var r=n.priceScale();null!==r&&t.recalculatePriceScale(r),n.updateAllViews()}}},t.prototype.getImage=function(){return this.Vr.canvas},t.prototype.paint=function(t){if(0!==t&&null!==this.su){if(t>1&&this.recalculatePriceScale(),null!==this.$r&&this.$r.paint(t),1!==t){var i=Se(this.Vr.canvas);i.save(),this.qr(i,this.mu(),this.Vr.pixelRatio),this.su&&(this.pu(i,this.Vr.pixelRatio),this.gu(i,this.Vr.pixelRatio),this.yu(i,this.Vr.pixelRatio)),i.restore()}var e=Se(this.Fr.canvas);e.clearRect(0,0,Math.ceil(this.Nr.w*this.Fr.pixelRatio),Math.ceil(this.Nr.h*this.Fr.pixelRatio)),this.ku(e,this.Fr.pixelRatio)}},t.prototype.priceAxisWidget=function(){return this.$r},t.prototype.mu=function(){return this.hu.options().layout.backgroundColor},t.prototype.ru=function(){null!==this.su&&this.su.onDestroyed().unsubscribeAll(this),this.su=null},t.prototype.qr=function(t,i,e){var n=this;H(t,e,(function(){q(t,0,0,n.Nr.w,n.Nr.h,i)}))},t.prototype.pu=function(t,i){for(var e=y(this.su),n=this.F().gridSource().paneViews(e),r=e.height(),s=e.width(),o=0,h=n;o<h.length;o++){var a=h[o];t.save();var u=a.renderer(r,s);null!==u&&u.draw(t,i,!1),t.restore()}},t.prototype.gu=function(t,i){var e=this.F().watermarkSource();if(null!==e){var n=y(this.su);if(n.containsSeries())for(var r=e.paneViews(),s=n.height(),o=n.width(),h=0,a=r;h<a.length;h++){var u=a[h];t.save();var l=u.renderer(s,o);null!==l&&l.draw(t,i,!1),t.restore()}}},t.prototype.ku=function(t,i){this.Nu(this.F().crosshairSource(),t,i)},t.prototype.yu=function(t,i){for(var e=y(this.su).orderedSources(),n=this.F().crosshairSource(),r=0,s=e;r<s.length;r++){var o=s[r];this.Su(o,t,i)}for(var h=0,a=e;h<a.length;h++)(o=a[h])!==n&&this.Nu(o,t,i)},t.prototype.Nu=function(t,i,e){for(var n=y(this.su),r=t.paneViews(n),s=n.height(),o=n.width(),h=n.model().hoveredSource(),a=null!==h&&h.source===t,u=null!==h&&a&&void 0!==h.object?h.object.hitTestData:void 0,l=0,c=r;l<c.length;l++){var p=c[l].renderer(s,o);null!==p&&(i.save(),p.draw(i,e,a,u),i.restore())}},t.prototype.Su=function(t,i,e){for(var n=y(this.su),r=t.paneViews(n),s=n.height(),o=n.width(),h=n.model().hoveredSource(),a=null!==h&&h.source===t,u=null!==h&&a&&void 0!==h.object?h.object.hitTestData:void 0,l=0,c=r;l<c.length;l++){var p=c[l].renderer(s,o);null!==p&&void 0!==p.drawBackground&&(i.save(),p.drawBackground(i,e,a,u),i.restore())}},t.prototype.bu=function(t,i,e){for(var n=0,r=t;n<r.length;n++){var s=r[n],o=s.renderer(this.Nr.h,this.Nr.w);if(null!==o&&o.hitTest){var h=o.hitTest(i,e);if(null!==h)return{view:s,object:h}}}return null},t.prototype.au=function(){this.fu(),this.hu.adjustSize()},t.prototype.fu=function(){if(null!==this.su){var t=this.hu,i=this.su.defaultPriceScale().options().position;if(this.Zr!==i){if(null!==this.$r&&(this.$r.isLeft()?this.eu.removeChild(this.$r.getElement()):this.ou.removeChild(this.$r.getElement()),this.$r.destroy(),this.$r=null),"none"!==i){var e=t.model().rendererOptionsProvider();this.$r=new Ne(this,t.options().layout,e,i),"left"===i&&this.eu.appendChild(this.$r.getElement()),"right"===i&&this.ou.appendChild(this.$r.getElement())}this.Zr=i}}},t.prototype.lu=function(){return $e&&null===this.tu},t.prototype.Mu=function(){return $e&&this.Qr||null!==this.tu},t.prototype.xu=function(t){return Math.max(0,Math.min(t,this.Nr.w-1))},t.prototype.Du=function(t){return Math.max(0,Math.min(t,this.Nr.h-1))},t.prototype.cu=function(t,i){this.F().setAndSaveCurrentPosition(this.xu(t),this.Du(i),y(this.su))},t.prototype.vu=function(){this.F().clearCurrentPosition()},t.prototype.du=function(){this.iu&&(this.tu=null,this.vu())},t.prototype.wu=function(t,i){this.tu=t,this.iu=!1,this.cu(i.x,i.y);var e=this.F().crosshairSource();this.nu={x:e.appliedX(),y:e.appliedY()}},t.prototype.F=function(){return this.hu.model()},t}(),Ue=function(){function t(t,i,e,n){var r=this;this.o=!0,this.Nr=new ge(0,0),this.Lr=function(){return r.paint(3)},this.zr="left"===t,this.ah=e.rendererOptionsProvider,this.$=i,this.Cu=n,this.cr=document.createElement("div"),this.cr.style.width="25px",this.cr.style.height="100%",this.cr.style.overflow="hidden",this.Vr=xe(this.cr,new ge(16,16)),this.Vr.subscribeCanvasConfigured(this.Lr)}return t.prototype.destroy=function(){this.Vr.unsubscribeCanvasConfigured(this.Lr),this.Vr.destroy()},t.prototype.update=function(){this.o=!0},t.prototype.getElement=function(){return this.cr},t.prototype.getSize=function(){return this.Nr},t.prototype.setSize=function(t){if(t.w<0||t.h<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.Nr.equals(t)||(this.Nr=t,this.Vr.resizeCanvas({width:t.w,height:t.h}),this.cr.style.width=t.w+"px",this.cr.style.minWidth=t.w+"px",this.cr.style.height=t.h+"px",this.o=!0)},t.prototype.paint=function(t){if((!(t<3)||this.o)&&0!==this.Nr.w&&0!==this.Nr.h){this.o=!1;var i=Se(this.Vr.canvas);this.qr(i,this.Vr.pixelRatio),this.Lt(i,this.Vr.pixelRatio)}},t.prototype.getImage=function(){return this.Vr.canvas},t.prototype.isLeft=function(){return this.zr},t.prototype.Lt=function(t,i){if(this.Cu()){var e=this.Nr.w;t.save(),t.fillStyle=this.$.timeScale.borderColor;var n=Math.floor(this.ah.options().borderSize*i),r=this.zr?Math.round(e*i)-n:0;t.fillRect(r,0,n,n),t.restore()}},t.prototype.qr=function(t,i){var e=this;H(t,i,(function(){q(t,0,0,e.Nr.w,e.Nr.h,e.$.layout.backgroundColor)}))},t}();function Ye(t,i){return t.span>i.span?t:i}!function(t){t[t.BorderSize=1]="BorderSize",t[t.TickLength=3]="TickLength"}(Be||(Be={})),function(t){t[t.Default=0]="Default",t[t.EwResize=1]="EwResize"}(Ie||(Ie={}));var je=function(){function t(t){var i=this;this.Tu=null,this.Eu=70,this.Ht=null,this.Lu=!1,this.Nr=new ge(0,0),this.Zr="none",this.Lr=function(){return i.hu.model().lightUpdate()},this.Br=function(){return i.hu.model().lightUpdate()},this.hu=t,this.$=t.options().layout,this.Au=document.createElement("tr"),this.Bu=document.createElement("td"),this.Bu.style.padding="0",this.zu=document.createElement("td"),this.zu.style.padding="0",this.cr=document.createElement("td"),this.cr.style.height="25px",this.cr.style.padding="0",this.Vu=document.createElement("div"),this.Vu.style.width="100%",this.Vu.style.height="100%",this.Vu.style.position="relative",this.Vu.style.overflow="hidden",this.cr.appendChild(this.Vu),this.Vr=xe(this.Vu,new ge(16,16)),this.Vr.subscribeCanvasConfigured(this.Lr);var e=this.Vr.canvas;e.style.position="absolute",e.style.zIndex="1",e.style.left="0",e.style.top="0",this.Fr=xe(this.Vu,new ge(16,16)),this.Fr.subscribeCanvasConfigured(this.Br);var n=this.Fr.canvas;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0",this.Au.appendChild(this.Bu),this.Au.appendChild(this.cr),this.Au.appendChild(this.zu),this.Fu(),this.hu.model().mainPriceScaleOptionsChanged().subscribe(this.Fu.bind(this),this),this.dr=new Le(this.Fr.canvas,this,{treatVertTouchDragAsPageScroll:!0,treatHorzTouchDragAsPageScroll:!1})}return t.prototype.destroy=function(){this.dr.destroy(),null!==this.Tu&&this.Tu.destroy(),this.Fr.unsubscribeCanvasConfigured(this.Br),this.Fr.destroy(),this.Vr.unsubscribeCanvasConfigured(this.Lr),this.Vr.destroy()},t.prototype.getElement=function(){return this.Au},t.prototype.stub=function(){return this.Tu},t.prototype.mouseDownEvent=function(t){if(!this.Lu){this.Lu=!0;var i=this.hu.model();!i.timeScale().isEmpty()&&this.hu.options().handleScale.axisPressedMouseMove&&i.startScaleTime(t.localX)}},t.prototype.mouseDownOutsideEvent=function(){var t=this.hu.model();!t.timeScale().isEmpty()&&this.Lu&&(this.Lu=!1,this.hu.options().handleScale.axisPressedMouseMove&&t.endScaleTime())},t.prototype.pressedMouseMoveEvent=function(t){var i=this.hu.model();!i.timeScale().isEmpty()&&this.hu.options().handleScale.axisPressedMouseMove&&i.scaleTimeTo(t.localX)},t.prototype.mouseUpEvent=function(t){this.Lu=!1;var i=this.hu.model();i.timeScale().isEmpty()&&!this.hu.options().handleScale.axisPressedMouseMove||i.endScaleTime()},t.prototype.mouseDoubleClickEvent=function(){this.hu.options().handleScale.axisDoubleClickReset&&this.hu.model().resetTimeScale()},t.prototype.mouseEnterEvent=function(t){this.hu.model().options().handleScale.axisPressedMouseMove&&this.Kr(1)},t.prototype.mouseLeaveEvent=function(t){this.Kr(0)},t.prototype.getSize=function(){return this.Nr},t.prototype.setSizes=function(t,i){this.Nr&&this.Nr.equals(t)||(this.Nr=t,this.Vr.resizeCanvas({width:t.w,height:t.h}),this.Fr.resizeCanvas({width:t.w,height:t.h}),this.cr.style.width=t.w+"px",this.cr.style.height=t.h+"px"),null!==this.Tu&&this.Tu.setSize(new ge(i,t.h))},t.prototype.width=function(){return this.Nr.w},t.prototype.height=function(){return this.Nr.h},t.prototype.optimalHeight=function(){var t=this.Pu();return Math.ceil(t.borderSize+t.tickLength+t.fontSize+t.paddingTop+t.paddingBottom)},t.prototype.update=function(){var t=this,i=this.hu.model().timeScale().marks();i&&(this.Eu=70,i.forEach((function(i){t.Eu=Math.min(i.span,t.Eu)})))},t.prototype.getImage=function(){return this.Vr.canvas},t.prototype.paint=function(t){if(0!==t){if(1!==t){var i=Se(this.Vr.canvas);this.qr(i,this.Vr.pixelRatio),this.Lt(i,this.Vr.pixelRatio),this.jr(i,this.Vr.pixelRatio),this.Hr(i,this.Vr.pixelRatio),null!==this.Tu&&this.Tu.paint(t)}var e=Se(this.Fr.canvas);this.Yr(e,this.Fr.pixelRatio)}},t.prototype.qr=function(t,i){var e=this;H(t,i,(function(){q(t,0,0,e.Nr.w,e.Nr.h,e.mu())}))},t.prototype.Lt=function(t,i){if(this.hu.options().timeScale.borderVisible){t.save(),t.fillStyle=this.Iu();var e=Math.max(1,Math.floor(this.Pu().borderSize*i));t.fillRect(0,0,Math.ceil(this.Nr.w*i),e),t.restore()}},t.prototype.jr=function(t,i){var e=this,n=this.hu.model().timeScale().marks();if(n&&0!==n.length){var r=n.reduce(Ye,n[0]).span;r>30&&r<40&&(r=30),t.save(),t.strokeStyle=this.Iu();var s=this.Pu(),o=s.borderSize+s.tickLength+s.paddingTop+s.fontSize-s.baselineOffset;t.textAlign="center",t.fillStyle=this.Iu();var h=Math.floor(this.Pu().borderSize*i),a=Math.max(1,Math.floor(i)),u=Math.floor(.5*i);if(this.hu.model().timeScale().options().borderVisible){t.beginPath();for(var l=Math.round(s.tickLength*i),c=n.length;c--;){var p=Math.round(n[c].coord*i);t.rect(p-u,h,a,l)}t.fill()}t.fillStyle=this.Pn(),H(t,i,(function(){t.font=e.Ou();for(var i=0,s=n;i<s.length;i++)(u=s[i]).span<r&&t.fillText(u.label,u.coord,o);t.font=e.Ru();for(var h=0,a=n;h<a.length;h++){var u;(u=a[h]).span>=r&&t.fillText(u.label,u.coord,o)}}))}},t.prototype.Hr=function(t,i){t.save();var e=new Set,n=this.hu.model(),r=n.dataSources();e.add(n.crosshairSource());for(var s=this.Pu(),o=0,h=r;o<h.length;o++){var a=h[o];if(!e.has(a))for(var u=0,l=a.timeAxisViews();u<l.length;u++)l[u].renderer().draw(t,s,i)}t.restore()},t.prototype.Yr=function(t,i){t.save(),t.clearRect(0,0,Math.ceil(this.Nr.w*i),Math.ceil(this.Nr.h*i));var e=[],n=this.hu.model().crosshairSource().timeAxisViews();e.push(n);var r=this.Pu();e.forEach((function(e){e.forEach((function(e){t.save(),e.renderer().draw(t,r,i),t.restore()}))})),t.restore()},t.prototype.mu=function(){return this.$.backgroundColor},t.prototype.Iu=function(){return this.hu.options().timeScale.borderColor},t.prototype.Pn=function(){return this.$.textColor},t.prototype.Zt=function(){return this.$.fontSize},t.prototype.Ou=function(){return Ii(this.Zt(),this.$.fontFamily)},t.prototype.Ru=function(){return Ii(this.Zt(),this.$.fontFamily,"bold")},t.prototype.Pu=function(){null===this.Ht&&(this.Ht={borderSize:1,baselineOffset:NaN,paddingTop:NaN,paddingBottom:NaN,paddingHorizontal:NaN,tickLength:3,fontSize:NaN,font:"",widthCache:new Kt});var t=this.Ht,i=this.Ou();if(t.font!==i){var e=this.Zt();t.fontSize=e,t.font=i,t.paddingTop=Math.ceil(e/2.5),t.paddingBottom=t.paddingTop,t.paddingHorizontal=Math.ceil(e/2),t.baselineOffset=Math.round(this.Zt()/5),t.widthCache.reset()}return this.Ht},t.prototype.Kr=function(t){this.cr.style.cursor=1===t?"ew-resize":"default"},t.prototype.Fu=function(){var t=this.hu.model().mainPriceScale().options().position;if(t!==this.Zr){if(null!==this.Tu&&(this.Tu.isLeft()?this.Bu.removeChild(this.Tu.getElement()):this.zu.removeChild(this.Tu.getElement()),this.Tu.destroy(),this.Tu=null),"none"!==t){var i={rendererOptionsProvider:this.hu.model().rendererOptionsProvider()},e=this.hu.model();this.Tu=new Ue(t,this.hu.options(),i,(function(){return e.mainPriceScale().options().borderVisible&&e.timeScale().options().borderVisible})),("left"===t?this.Bu:this.zu).appendChild(this.Tu.getElement())}this.Zr=t}},t}(),He=function(){function t(t,i){var e=this;this.Wu=[],this.Uu=[],this.qu=0,this.ju=new ht,this.nn=0,this.Kt=0,this.Hu=0,this.Yu=null,this.Ku=!1,this.Jr=new ht,this.oh=new ht,this.$=i,this.Au=document.createElement("div"),this.Au.classList.add("tv-lightweight-charts"),this.Au.style.overflow="hidden",this.Au.style.width="100%",this.Au.style.height="100%",this.$u=document.createElement("table"),this.$u.setAttribute("cellspacing","0"),this.Au.appendChild(this.$u),this._u=this.Xu.bind(this),this.Au.addEventListener("wheel",this._u,{passive:!1}),this.F=new ye(this.fh.bind(this),this.$),this.model().crosshairMoved().subscribe(this.Zu.bind(this),this),this.Ju=new je(this),this.$u.appendChild(this.Ju.getElement());var n=this.$.width,r=this.$.height;if(0===n&&0===r){var s=t.getBoundingClientRect();(n=Math.floor(s.width))%2&&(n-=1),(r=Math.floor(s.height))%2&&(r-=1)}n=Math.max(70,n),r=Math.max(50,r),this.resize(n,r),this.Gu(),t.appendChild(this.Au),this.Qu(),this.F.timeScale().optionsApplied().subscribe((function(){e.Qu(),e.adjustSize()}),this)}return t.prototype.model=function(){return this.F},t.prototype.options=function(){return this.$},t.prototype.paneWidgets=function(){return this.Wu},t.prototype.destroy=function(){this.Au.removeEventListener("wheel",this._u),0!==this.qu&&window.cancelAnimationFrame(this.qu),this.F.crosshairMoved().unsubscribeAll(this),this.F.timeScale().optionsApplied().unsubscribeAll(this),this.F.destroy();for(var t=0,i=this.Wu;t<i.length;t++){var e=i[t];this.$u.removeChild(e.getElement()),e.clicked().unsubscribeAll(this),e.destroy()}this.Wu=[];for(var n=0,r=this.Uu;n<r.length;n++){var s=r[n];this.te(s)}this.Uu=[],y(this.Ju).destroy(),null!==this.Au.parentElement&&this.Au.parentElement.removeChild(this.Au),this.oh.destroy(),this.Jr.destroy(),delete this.Au},t.prototype.resize=function(t,i,e){if(void 0===e&&(e=!1),this.nn!==i||this.Kt!==t){this.nn=i,this.Kt=t;var n=i+"px",r=t+"px";y(this.Au).style.height=n,y(this.Au).style.width=r,this.$u.style.height=n,this.$u.style.width=r,e?this.ie(new ji(3)):this.F.fullUpdate()}},t.prototype.paint=function(t){void 0===t&&(t=new ji(3));for(var i=0;i<this.Wu.length;i++)this.Wu[i].paint(t.invalidateForPane(i).level);this.Ju.paint(t.fullInvalidation())},t.prototype.adjustSize=function(){this.ne(),this.F.fullUpdate()},t.prototype.applyOptions=function(t){this.F.applyOptions(t),this.Qu();var i=t.width||this.Kt,e=t.height||this.nn;this.resize(i,e)},t.prototype.clicked=function(){return this.Jr},t.prototype.crosshairMoved=function(){return this.oh},t.prototype.takeScreenshot=function(){var t=this;null!==this.Yu&&(this.ie(this.Yu),this.Yu=null);var i=this.Wu[0],e=Me(document,new ge(this.Kt,this.nn)),n=Se(e),r=be(e);return H(n,r,(function(){var e=0,r=0,s=function(){for(var i=0;i<t.Wu.length;i++){var s=t.Wu[i],o=s.getSize().h,h=y(s.priceAxisWidget()),a=h.getImage();n.drawImage(a,e,r,h.getWidth(),o),r+=o,i<t.Wu.length-1&&(r+=1)}};"left"===t.$.priceScale.position&&(s(),e=y(i.priceAxisWidget()).getWidth()),r=0;for(var o=0;o<t.Wu.length;o++){var h=t.Wu[o],a=h.getSize(),u=h.getImage();if(n.drawImage(u,e,r,a.w,a.h),r+=a.h,o<t.Wu.length-1){var l=t.Uu[o],c=l.getSize(),p=l.getImage();n.drawImage(p,e,r,c.w,c.h),r+=c.h}}e+=i.getSize().w,"right"===t.$.priceScale.position&&(r=0,s());var f=function(){var i=y(t.Ju.stub()),s=i.getSize(),o=i.getImage();n.drawImage(o,e,r,s.w,s.h)};if(t.$.timeScale.visible){e=0,"left"===t.$.priceScale.position&&(f(),e=y(i.priceAxisWidget()).getWidth());var d=t.Ju.getSize();u=t.Ju.getImage(),n.drawImage(u,e,r,d.w,d.h),"right"===t.$.priceScale.position&&(e=i.getSize().w,f(),n.restore())}})),e},t.prototype.ne=function(){for(var t=0,i=0,e=0,n=this.Wu;e<n.length;e++){var r=n[e];"none"!==this.$.priceScale.position&&(i=Math.max(i,y(r.priceAxisWidget()).optimalWidth())),t+=r.stretchFactor()}var s=this.Kt,o=this.nn,h=Math.max(s-i,0),a=1*this.Uu.length,u=this.$.timeScale.visible?this.Ju.optimalHeight():0;u%2&&(u+=1);for(var l=a+u,c=o<l?0:o-l,p=c/t,f=0,d=0;d<this.Wu.length;++d){(r=this.Wu[d]).setState(this.F.panes()[d]);var v,m;m=d===this.Wu.length-1?c-f:Math.round(r.stretchFactor()*p),f+=v=Math.max(m,2),r.setSize(new ge(h,v)),"none"!==this.$.priceScale.position&&r.setPriceAxisSize(i),r.state()&&this.F.setPaneHeight(r.state(),v)}this.Ju.setSizes(new ge(h,u),i),this.F.setWidth(h),this.Hu!==i&&(this.Hu=i,this.ju.fire(i))},t.prototype.Xu=function(t){var i=t.deltaX/100,e=-t.deltaY/100;if(0!==i&&this.$.handleScroll.mouseWheel||0!==e&&this.$.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:i*=120,e*=120;break;case t.DOM_DELTA_LINE:i*=32,e*=32}if(0!==e&&this.$.handleScale.mouseWheel){var n=Math.sign(e)*Math.min(1,Math.abs(e)),r=t.clientX-this.Au.getBoundingClientRect().left;this.model().zoomTime(r,n)}0!==i&&this.$.handleScroll.mouseWheel&&this.model().scrollChart(-80*i)}},t.prototype.ie=function(t){var i=t.fullInvalidation();if(3===i&&this.se(),3===i||2===i){for(var e=this.F.panes(),n=0;n<e.length;n++)t.invalidateForPane(n).autoScale&&e[n].momentaryAutoScale();t.getFitContent()&&this.F.timeScale().fitContent();var r=t.getTargetTimeRange();null!==r&&this.F.timeScale().setTimePointsRange(r),this.Ju.update()}this.paint(t)},t.prototype.fh=function(t){var i=this;null!==this.Yu?this.Yu.merge(t):this.Yu=t,this.Ku||(this.Ku=!0,this.qu=window.requestAnimationFrame((function(){i.Ku=!1,i.qu=0,null!==i.Yu&&(i.ie(i.Yu),i.Yu=null)})))},t.prototype.se=function(){this.Gu()},t.prototype.te=function(t){this.$u.removeChild(t.getElement()),t.destroy()},t.prototype.Gu=function(){for(var t=this.F.panes(),i=t.length,e=this.Wu.length,n=i;n<e;n++){var r=m(this.Wu.pop());this.$u.removeChild(r.getElement()),r.clicked().unsubscribeAll(this),r.destroy(),void 0!==(s=this.Uu.pop())&&this.te(s)}for(n=e;n<i;n++){if((r=new We(this,t[n])).clicked().subscribe(this.he.bind(this),this),this.Wu.push(r),n>1){var s=new Ae(this,n-1,n,!0);this.Uu.push(s),this.$u.insertBefore(s.getElement(),this.Ju.getElement())}this.$u.insertBefore(r.getElement(),this.Ju.getElement())}for(n=0;n<i;n++){var o=t[n];(r=this.Wu[n]).state()!==o?r.setState(o):r.updatePriceAxisWidget()}this.Qu(),this.ne()},t.prototype.ue=function(t,i){var e,n=new Map;if(null!==t&&this.F.serieses().forEach((function(i){var e=i.dataAt(t);null!==e&&n.set(i,e)})),null!==t){var r=this.F.timeScale().indexToUserTime(t);null!==r&&(e=r)}var s=this.model().hoveredSource(),o=null!==s&&s.source instanceof _i?s.source:void 0,h=null!==s&&void 0!==s.object?s.object.externalId:void 0;return{time:e,point:i||void 0,hoveredSeries:o,seriesPrices:n,hoveredObject:h}},t.prototype.he=function(t,i){var e=this;this.Jr.fire((function(){return e.ue(t,i)}))},t.prototype.Zu=function(t,i){var e=this;this.oh.fire((function(){return e.ue(t,i)}))},t.prototype.Qu=function(){var t=this.$.timeScale.visible?"":"none";this.Ju.getElement().style.display=t},t}();function qe(t){if(!Oi(t))throw new Error("time must be of type BusinessDay");var i=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{timestamp:Math.round(i.getTime()/1e3),businessDay:t}}function Ke(t){if(!Bi(t))throw new Error("time must be of type isUTCTimestamp");return{timestamp:t}}function Xe(t){return 0===t.length?null:Oi(t[0].time)?qe:Ke}function Je(t){return Bi(t)?Ke(t):Oi(t)?qe(t):qe(hn(t))}function Ze(t,i){var e=t.value,n=null;return"color"in t&&void 0!==t.color&&(n=i.addColor(t.color)),[e,e,e,e,n]}function Qe(t,i){return[t.open,t.high,t.low,t.close,null]}var Ge={Candlestick:Qe,Bar:Qe,Area:Ze,Histogram:Ze,Line:Ze};function tn(t){return Ge[t]}function en(t){return 60*t*60*1e3}function nn(t){return 60*t*1e3}var rn=[{divisor:1,span:20},{divisor:(1,1e3),span:19},{divisor:nn(1),span:20},{divisor:nn(5),span:21},{divisor:nn(30),span:22},{divisor:en(1),span:30},{divisor:en(3),span:31},{divisor:en(6),span:32},{divisor:en(12),span:33}];function sn(t,i){if(null!==i){var e=new Date(1e3*i.timestamp),n=new Date(1e3*t.timestamp);if(n.getUTCFullYear()!==e.getUTCFullYear())return 70;if(n.getUTCMonth()!==e.getUTCMonth())return 60;if(n.getUTCDate()!==e.getUTCDate())return 50;for(var r=rn.length-1;r>=0;--r)if(Math.floor(e.getTime()/rn[r].divisor)!==Math.floor(n.getTime()/rn[r].divisor))return rn[r].span}return 20}function on(t,i){return t.timestamp<i.timestamp}function hn(t){var i=new Date(t);if(isNaN(i.getTime()))throw new Error("Invalid date string="+t+", expected format=yyyy-mm-dd");return{day:i.getUTCDate(),month:i.getUTCMonth()+1,year:i.getUTCFullYear()}}function an(t){M(t.time)&&(t.time=hn(t.time))}var un,ln=function(){function t(){this.ee=new Map,this.oe=new Map,this.fe=[]}return t.prototype.destroy=function(){this.ee.clear(),this.oe.clear(),this.fe=[]},t.prototype.setSeriesData=function(t,i){var e=this;t.clearData(),function(t){t.forEach(an)}(i),this.ee.forEach((function(i){return i.mapping.delete(t)}));var n=Xe(i);null!==n&&i.forEach((function(i){var r=n(i.time),s=e.ee.get(r.timestamp)||{index:0,mapping:new Map,timePoint:r};s.mapping.set(t,i),e.ee.set(r.timestamp,s)}));var r=new Map;return this.ee.forEach((function(t,i){t.mapping.size>0&&r.set(i,t)})),this.ae(r)},t.prototype.removeSeries=function(t){return this.setSeriesData(t,[])},t.prototype.updateSeriesData=function(t,i){an(i);var e=t.data().bars();if(e.size()>0)if(void 0!==y(e.last()).time.businessDay){if(!Oi(i.time))throw new Error("time must be of type BusinessDay")}else if(!Bi(i.time))throw new Error("time must be of type isUTCTimestamp");var n=y(Xe([i]))(i.time),r=this.ee.get(n.timestamp)||{index:0,mapping:new Map,timePoint:n},s=0===r.mapping.size;r.mapping.set(t,i);var o=!1;if(s){var h=this.ee.size;this.fe.length>0&&this.fe[this.fe.length-1].timestamp>n.timestamp?(h=Et(this.fe,n,on),this.fe.splice(h,0,n),this.ce(h),o=!0):this.fe.push(n),r.index=h,this.oe.set(r.index,n)}this.ee.set(n.timestamp,r);var a=new Map,u=function(i){var e=m(l.oe.get(i));m(l.ee.get(e.timestamp)).mapping.forEach((function(n,r){if(o||r===t){var s=tn(r.seriesType()),h=a.get(r)||{update:[]},u={index:i,time:e,value:s(n,r.palette())};h.update.push(u),a.set(r,h)}}))},l=this;for(h=r.index;h<this.ee.size;++h)u(h);var c=s?this.le(r.index):[],p=s?this.fe.slice(r.index):[];return{timeScaleUpdate:{seriesUpdates:a,changes:p,index:r.index,marks:c}}},t.prototype.ae=function(t){var i=this;this.ee=t,this.fe=Array.from(this.ee.values()).map((function(t){return t.timePoint})),this.fe.sort((function(t,i){return t.timestamp-i.timestamp}));var e=new Map;this.fe.forEach((function(t,n){var r=m(i.ee.get(t.timestamp));r.index=n,r.mapping.forEach((function(i,r){var s=tn(r.seriesType()),o=e.get(r)||{update:[]},h={index:n,time:t,value:s(i,r.palette())};o.update.push(h),e.set(r,o)}))}));var n=null,r=this.fe.map((function(t,i){var e=sn(t,n);return n=t,{span:e,time:t,index:i}})),s={seriesUpdates:e,changes:this.fe.slice(),index:0,marks:r};return this.ve(),{timeScaleUpdate:s}},t.prototype.ce=function(t){for(var i=this.oe.size-1;i>=t;--i){var e=m(this.oe.get(i)),n=i+1;m(this.ee.get(e.timestamp)).index=n,this.oe.delete(i),this.oe.set(n,e)}},t.prototype.ve=function(){var t=this;this.oe.clear(),this.ee.forEach((function(i,e){t.oe.set(i.index,i.timePoint)}))},t.prototype.le=function(t){for(var i=[],e=this.oe.get(t-1)||null,n=t;n<this.oe.size;++n){var r=m(this.oe.get(n)),s=sn(r,e);e=r,i.push({span:s,time:r,index:n})}return i},t}(),cn={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,axisLabelVisible:!0},pn=function(){function t(t){this.ii=t}return t.prototype.applyOptions=function(t){this.ii.applyOptions(t)},t.prototype.options=function(){return this.ii.options()},t.prototype.priceLine=function(){return this.ii},t}(),fn=function(){function t(t,i){this._series=t,this._dataUpdatesConsumer=i}return t.prototype.destroy=function(){delete this._series,delete this._dataUpdatesConsumer},t.prototype.priceFormatter=function(){return this._series.formatter()},t.prototype.series=function(){return this._series},t.prototype.priceToCoordinate=function(t){var i=this._series.firstValue();return null===i?null:this._series.priceScale().priceToCoordinate(t,i.value)},t.prototype.coordinateToPrice=function(t){var i=this._series.firstValue();return null===i?null:this._series.priceScale().coordinateToPrice(t,i.value)},t.prototype.setData=function(t){this._dataUpdatesConsumer.applyNewData(this._series,t)},t.prototype.update=function(t){this._dataUpdatesConsumer.updateData(this._series,t)},t.prototype.setMarkers=function(t){var i=t.map((function(t){return f(f({},t),{time:Je(t.time)})}));this._series.setMarkers(i)},t.prototype.applyOptions=function(t){this._series.applyOptions(t)},t.prototype.options=function(){return T(this._series.options())},t.prototype.createPriceLine=function(t){var i=b(T(cn),t),e=this._series.createPriceLine(i);return new pn(e)},t.prototype.removePriceLine=function(t){this._series.removePriceLine(t.priceLine())},t}(),dn=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return p(i,t),i.prototype.applyOptions=function(i){Ai(i),t.prototype.applyOptions.call(this,i)},i}(fn),vn={width:0,height:0,layout:{backgroundColor:"#FFFFFF",textColor:"#191919",fontSize:11,fontFamily:"'Trebuchet MS', Roboto, Ubuntu, sans-serif"},crosshair:{vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},priceScale:{autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,position:"right",borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,scaleMargins:{bottom:.1,top:.2}},timeScale:{rightOffset:0,barSpacing:6,fixLeftEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0},watermark:{color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,text:"",horzAlign:"center",vertAlign:"center"},localization:{locale:navigator.language,dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:!0,axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0}},mn={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},yn={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},gn={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4},bn={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4},Sn={color:"#26a69a",base:0},wn={title:"",lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}},Mn=function(){function t(t){this.l=t}return t.prototype.destroy=function(){delete this.l},t.prototype.applyOptions=function(t){this.l.applyOptions({priceScale:t})},t.prototype.options=function(){return this.B().options()},t.prototype.B=function(){return this.l.mainPriceScale()},t}();!function(t){t[t.AnimationDurationMs=1e3]="AnimationDurationMs"}(un||(un={}));var xn=function(){function t(t){this.F=t}return t.prototype.destroy=function(){delete this.F},t.prototype.scrollPosition=function(){return this.$n().rightOffset()},t.prototype.scrollToPosition=function(t,i){i?this.$n().scrollToOffsetAnimated(t,1e3):this.$n().setRightOffset(t)},t.prototype.scrollToRealTime=function(){this.$n().scrollToRealTime()},t.prototype.getVisibleRange=function(){var t=this.$n().visibleBars();if(null===t)return null;var i=this.F.timeScale().points(),e=y(i.firstIndex()),n=y(i.lastIndex());return{from:Cn(y(i.valueAt(Math.max(e,t.firstBar())))),to:Cn(y(i.valueAt(Math.min(n,t.lastBar()))))}},t.prototype.setVisibleRange=function(t){var i={from:Je(t.from),to:Je(t.to)};this.F.setTargetTimeRange(i)},t.prototype.resetTimeScale=function(){this.F.resetTimeScale()},t.prototype.fitContent=function(){this.F.fitContent()},t.prototype.applyOptions=function(t){this.$n().applyOptions(t)},t.prototype.options=function(){return T(this.$n().options())},t.prototype.$n=function(){return this.F.timeScale()},t}();function Cn(t){return t.businessDay||t.timestamp}function Tn(t){if(void 0!==t&&"custom"!==t.type){var i=t;void 0!==i.minMove&&void 0===i.precision&&(i.precision=function(t){if(t>=1)return 0;for(var i=0;i<8;i++){var e=Math.round(t);if(Math.abs(e-t)<1e-8)return i;t*=10}return i}(i.minMove))}}function kn(t){var i=t.handleScale;C(i)&&(t.handleScale={axisDoubleClickReset:i,axisPressedMouseMove:i,mouseWheel:i,pinch:i});var e=t.handleScroll;return C(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e}),t}var Pn=function(){function t(t,i){var e=this;this.de=new ln,this.Me=new ht,this.we=new Map,this.be=new Map,this.me=new ht,this.pe=new ht;var n=void 0===i?T(vn):b(T(vn),kn(i));this.ur=new He(t,n),this.ur.model().timeScale().visibleBarsChanged().subscribe(this.ge.bind(this)),this.ur.clicked().subscribe((function(t){e.me.hasListeners()&&e.me.fire(e.ye(t()))}),this),this.ur.crosshairMoved().subscribe((function(t){e.pe.hasListeners()&&e.pe.fire(e.ye(t()))}),this);var r=this.ur.model();this.ke=new Mn(r),this.Ne=new xn(r)}return t.prototype.remove=function(){this.ur.model().timeScale().visibleBarsChanged().unsubscribeAll(this),this.ur.clicked().unsubscribeAll(this),this.ur.crosshairMoved().unsubscribeAll(this),this.ke.destroy(),this.Ne.destroy(),this.ur.destroy(),delete this.ur,this.we.forEach((function(t,i){i.destroy()})),this.we.clear(),this.be.clear(),this.Me.destroy(),this.me.destroy(),this.pe.destroy(),this.de.destroy(),delete this.de},t.prototype.resize=function(t,i,e){this.ur.resize(t,i,e)},t.prototype.addAreaSeries=function(t){void 0===t&&(t={}),Tn(t.priceFormat);var i=b(T(wn),bn,t),e=this.ur.model().createSeries("Area",i),n=new fn(e,this);return this.we.set(n,e),this.be.set(e,n),n},t.prototype.addBarSeries=function(t){void 0===t&&(t={}),Tn(t.priceFormat);var i=b(T(wn),yn,t),e=this.ur.model().createSeries("Bar",i),n=new fn(e,this);return this.we.set(n,e),this.be.set(e,n),n},t.prototype.addCandlestickSeries=function(t){void 0===t&&(t={}),Ai(t),Tn(t.priceFormat);var i=b(T(wn),mn,t),e=this.ur.model().createSeries("Candlestick",i),n=new dn(e,this);return this.we.set(n,e),this.be.set(e,n),n},t.prototype.addHistogramSeries=function(t){void 0===t&&(t={}),Tn(t.priceFormat);var i=b(T(wn),Sn,t),e=this.ur.model().createSeries("Histogram",i),n=new fn(e,this);return this.we.set(n,e),this.be.set(e,n),n},t.prototype.addLineSeries=function(t){void 0===t&&(t={}),Tn(t.priceFormat);var i=b(T(wn),gn,t),e=this.ur.model().createSeries("Line",i),n=new fn(e,this);return this.we.set(n,e),this.be.set(e,n),n},t.prototype.removeSeries=function(t){var i=t,e=m(this.we.get(i)),n=this.de.removeSeries(e),r=this.ur.model();r.removeSeries(e);var s=n.timeScaleUpdate;r.updateTimeScale(s.index,s.changes,s.marks,!0),s.seriesUpdates.forEach((function(t,i){i.updateData(t.update)})),r.updateTimeScaleBaseIndex(0),this.we.delete(i),this.be.delete(e)},t.prototype.applyNewData=function(t,i){var e=this.de.setSeriesData(t,i),n=this.ur.model(),r=e.timeScaleUpdate;n.updateTimeScale(r.index,r.changes,r.marks,!0),r.seriesUpdates.forEach((function(t,i){i.updateData(t.update,!0)})),n.updateTimeScaleBaseIndex(0)},t.prototype.updateData=function(t,i){var e=this.de.updateSeriesData(t,i),n=this.ur.model(),r=e.timeScaleUpdate;n.updateTimeScale(r.index,r.changes,r.marks,!1),r.seriesUpdates.forEach((function(t,i){i.updateData(t.update)})),n.updateTimeScaleBaseIndex(0)},t.prototype.subscribeClick=function(t){this.me.subscribe(t)},t.prototype.unsubscribeClick=function(t){this.me.unsubscribe(t)},t.prototype.subscribeCrosshairMove=function(t){this.pe.subscribe(t)},t.prototype.unsubscribeCrosshairMove=function(t){this.pe.unsubscribe(t)},t.prototype.subscribeVisibleTimeRangeChange=function(t){this.Me.subscribe(t)},t.prototype.unsubscribeVisibleTimeRangeChange=function(t){this.Me.unsubscribe(t)},t.prototype.priceScale=function(){return this.ke},t.prototype.timeScale=function(){return this.Ne},t.prototype.applyOptions=function(t){this.ur.applyOptions(kn(t))},t.prototype.options=function(){return this.ur.options()},t.prototype.takeScreenshot=function(){return this.ur.takeScreenshot()},t.prototype.ge=function(){this.Me.hasListeners()&&this.Me.fire(this.timeScale().getVisibleRange())},t.prototype.Se=function(t){return m(this.be.get(t))},t.prototype.ye=function(t){var i=this,e=new Map;t.seriesPrices.forEach((function(t,n){e.set(i.Se(n),t)}));var n=void 0===t.hoveredSeries?void 0:this.Se(t.hoveredSeries);return{time:t.time&&(t.time.businessDay||t.time.timestamp),point:t.point,hoveredSeries:n,hoveredMarkerId:t.hoveredObject,seriesPrices:e}},t}();function _n(t,i){var e=y(M(t)?document.getElementById(t):t);return new Pn(e,i)}function En(){return"2.0.0"}var Ln=e(1),Rn=e.n(Ln);function Vn(t){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fn(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,n)}return e}function Dn(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?Fn(Object(e),!0).forEach((function(i){$n(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Fn(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}function zn(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function An(t,i){return(An=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function On(t){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=Nn(t);if(i){var r=Nn(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Bn(this,e)}}function Bn(t,i){return!i||"object"!==Vn(i)&&"function"!=typeof i?In(t):i}function In(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nn(t){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $n(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var Wn={candlestick:"addCandlestickSeries",line:"addLineSeries",area:"addAreaSeries",bar:"addBarSeries",histogram:"addHistogramSeries"},Un=["#008FFB","#00E396","#FEB019","#FF4560","#775DD0","#F86624","#A5978B"],Yn={layout:{backgroundColor:"#131722",lineColor:"#2B2B43",textColor:"#D9D9D9"},grid:{vertLines:{color:"#363c4e"},horzLines:{color:"#363c4e"}}},jn={layout:{backgroundColor:"#FFFFFF",lineColor:"#2B2B43",textColor:"#191919"},grid:{vertLines:{color:"#e1ecf2"},horzLines:{color:"#e1ecf2"}}},Hn=function(t){!function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&An(t,i)}(o,t);var i,e,n,s=On(o);function o(t){var i;return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,o),$n(In(i=s.call(this,t)),"resizeHandler",(function(){var t=i.props.autoWidth&&i.chartDiv.current&&i.chartDiv.current.parentNode.clientWidth,e=i.props.autoHeight&&i.chartDiv.current?i.chartDiv.current.parentNode.clientHeight:i.props.height||500;i.chart.resize(t,e)})),$n(In(i),"removeSeries",(function(){i.series.forEach((function(t){return i.chart.removeSeries(t)})),i.series=[]})),$n(In(i),"addSeries",(function(t,e){var n=Wn[e],r=t.option&&t.options.color||Un[i.series.length%Un.length],s=i.chart[n](Dn({color:r},t.options)),o=i.handleLinearInterpolation(t.data,t.linearInterpolation);return s.setData(o),t.markers&&s.setMarkers(t.markers),t.priceLines&&t.priceLines.forEach((function(t){return s.createPriceLine(t)})),t.legend&&i.addLegend(s,r,t.legend),s})),$n(In(i),"handleSeries",(function(){var t=i.series,e=i.props;e.candlestickSeries&&e.candlestickSeries.forEach((function(e){t.push(i.addSeries(e,"candlestick"))})),e.lineSeries&&e.lineSeries.forEach((function(e){t.push(i.addSeries(e,"line"))})),e.areaSeries&&e.areaSeries.forEach((function(e){t.push(i.addSeries(e,"area"))})),e.barSeries&&e.barSeries.forEach((function(e){t.push(i.addSeries(e,"bar"))})),e.histogramSeries&&e.histogramSeries.forEach((function(e){t.push(i.addSeries(e,"histogram"))}))})),$n(In(i),"unsubscribeEvents",(function(t){var e=i.chart;e.unsubscribeClick(t.onClick),e.unsubscribeCrosshairMove(t.onCrosshairMove),e.unsubscribeVisibleTimeRangeChange(t.onTimeRangeMove)})),$n(In(i),"handleEvents",(function(){var t=i.chart,e=i.props;e.onClick&&t.subscribeClick(e.onClick),e.onCrosshairMove&&t.subscribeCrosshairMove(e.onCrosshairMove),e.onTimeRangeMove&&t.subscribeVisibleTimeRangeChange(e.onTimeRangeMove),t.subscribeCrosshairMove(i.handleLegends)})),$n(In(i),"handleTimeRange",(function(){var t=i.props,e=t.from,n=t.to;e&&n&&i.chart.timeScale().setVisibleRange({from:e,to:n})})),$n(In(i),"handleLinearInterpolation",(function(t,i){if(!i||t.length<2||!t[0].value)return t;var e=t[0].time,n=t[t.length-1].time,r=new Array(Math.floor((n-e)/i));r[0]=t[0];for(var s=1,o=1;o<t.length;o++){r[s++]=t[o];for(var h=t[o-1].time,a=t[o-1].value,u=t[o],l=u.time,c=u.value,p=h;p<l-i;p+=i){var f=a+(c-a)/(l-h)*(p-h);r[s++]={time:p,value:f}}}return r.filter((function(t){return t}))})),$n(In(i),"handleUpdateChart",(function(){window.removeEventListener("resize",i.resizeHandler);var t=In(i),e=t.chart,n=t.chartDiv,r=i.props,s=i.props.darkTheme?Yn:jn;s=Kn(s,Dn({width:r.autoWidth?n.current.parentNode.clientWidth:r.width,height:r.autoHeight?n.current.parentNode.clientHeight:r.height||500},r.options)),e.applyOptions(s),i.legendDiv.current&&(i.legendDiv.current.innerHTML=""),i.legends=[],i.props.legend&&i.handleMainLegend(),i.handleSeries(),i.handleEvents(),i.handleTimeRange(),(r.autoWidth||r.autoHeight)&&window.addEventListener("resize",i.resizeHandler)})),$n(In(i),"addLegend",(function(t,e,n){i.legends.push({series:t,color:e,title:n})})),$n(In(i),"handleLegends",(function(t){var e=i.legendDiv.current;t.time&&e&&i.legends.length&&(e.innerHTML="",i.legends.forEach((function(i){var n=i.series,r=i.color,s=i.title,o=t.seriesPrices.get(n);if(void 0!==o){"object"==Vn(o)&&(r=o.open<o.close?"rgba(0, 150, 136, 0.8)":"rgba(255,82,82, 0.8)",o="O: ".concat(o.open,", H: ").concat(o.high,", L: ").concat(o.low,", C: ").concat(o.close));var h=document.createElement("div");h.innerText=s+" ";var a=document.createElement("span");a.style.color=r,a.innerText=" "+o,h.appendChild(a),e.appendChild(h)}})))})),$n(In(i),"handleMainLegend",(function(){if(i.legendDiv.current){var t=document.createElement("div");t.innerText=i.props.legend,i.legendDiv.current.appendChild(t)}})),i.chartDiv=r.a.createRef(),i.legendDiv=r.a.createRef(),i.chart=null,i.series=[],i.legends=[],i}return i=o,(e=[{key:"componentDidMount",value:function(){this.chart=_n(this.chartDiv.current),this.handleUpdateChart(),this.resizeHandler()}},{key:"componentDidUpdate",value:function(t){this.props.autoWidth||this.props.autoHeight||window.removeEventListener("resize",this.resizeHandler),Rn()([t.onCrosshairMove,t.onTimeRangeMove,t.onClick],[this.props.onCrosshairMove,this.props.onTimeRangeMove,this.props.onClick])||this.unsubscribeEvents(t),Rn()([t.options,t.darkTheme,t.candlestickSeries,t.lineSeries,t.areaSeries,t.barSeries,t.histogramSeries],[this.props.options,this.props.darkTheme,this.props.candlestickSeries,this.props.lineSeries,this.props.areaSeries,this.props.barSeries,this.props.histogramSeries])?t.from===this.props.from&&t.to===this.props.to||this.handleTimeRange():(this.removeSeries(),this.handleUpdateChart())}},{key:"render",value:function(){var t=this.props.darkTheme?Yn.layout.textColor:jn.layout.textColor;return r.a.createElement("div",{ref:this.chartDiv,style:{position:"relative"}},r.a.createElement("div",{ref:this.legendDiv,style:{position:"absolute",zIndex:2,color:t,padding:10}}))}}])&&zn(i.prototype,e),n&&zn(i,n),o}(r.a.Component),qn=(i.default=Hn,function(t){return t&&"object"===Vn(t)&&!Array.isArray(t)}),Kn=function t(i,e){var n=Object.assign({},i);return qn(i)&&qn(e)&&Object.keys(e).forEach((function(r){qn(e[r])&&r in i?n[r]=t(i[r],e[r]):Object.assign(n,$n({},r,e[r]))})),n}}]);